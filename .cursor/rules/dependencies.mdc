---
description: External dependencies and third-party integrations
alwaysApply: true
---

# External Dependencies

## Core Services

| Service | Purpose | SDK |
|---------|---------|-----|
| **Supabase** | Auth, DB, Storage | `@supabase/supabase-js` |
| **Finby** | Payments | REST API |
| **Replicate** | AI generation | `replicate` |
| **RunPod** | GPU Infrastructure (MCP) | `@runpod/mcp-server` |
| **PostHog** | Analytics | `posthog-js` |
| **Vercel** | Hosting | - |
| **Package Docs** | Documentation Lookup (MCP) | `@jankowtf/mcp-package-docs` |

## When Implementing

### Authentication (EP-002)
- Use Supabase Auth, not custom
- `supabase.auth.signUp()`, `signInWithPassword()`
- Session via `supabase.auth.getSession()`

### Payments (EP-003)
- Use Finby API for checkout
- Redirect to Finby hosted payment page
- Webhooks for subscription events
- Never store card details

### AI Generation (EP-005)
- Use Replicate API
- `replicate.run(model, { input })`
- Store images in Supabase Storage

### Analytics (All)
- Use `@ryla/analytics` lib
- `analytics.capture(event, properties)`
- See `docs/analytics/TRACKING-PLAN.md`

### Package Documentation (All)
- **ALWAYS** use Package Docs MCP server when:
  - Adding new packages to `package.json`
  - Updating package versions
  - Writing code that uses external libraries
  - Debugging API usage issues
  - Checking for breaking changes
- Use `lookup_npm_doc` for NPM packages (supports private registries via `.npmrc`)
- Use `search_package_docs` to find usage examples
- Verify latest versions before implementation
- See `docs/technical/MCP-PACKAGE-DOCS.md` for full reference

## Env Vars Required

```bash
# Supabase
NEXT_PUBLIC_SUPABASE_URL=
NEXT_PUBLIC_SUPABASE_ANON_KEY=
SUPABASE_SERVICE_ROLE_KEY=

# Finby
FINBY_API_KEY=
FINBY_MERCHANT_ID=
FINBY_WEBHOOK_SECRET=

# AI
REPLICATE_API_TOKEN=

# RunPod (GPU Infrastructure - MCP)
RUNPOD_API_KEY=

# Analytics
NEXT_PUBLIC_POSTHOG_KEY=
NEXT_PUBLIC_POSTHOG_HOST=
```

## Full Reference
See `docs/specs/EXTERNAL-DEPENDENCIES.md`
