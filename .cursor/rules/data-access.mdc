---
description: Data access layer patterns and repository implementation
globs: ["src/data/**"]
alwaysApply: false
---

# Data Access Layer

## Repository Pattern
- One repository per entity
- Name methods by intent: `findByUserId`, not `query`
- Return domain models

## Database Operations
- Transactions for multi-step ops
- Parameterized queries (prevent SQL injection)
- Pagination for lists

## Migrations
- All schema changes via migrations
- Reversible when possible
- Document breaking changes

## Optimization
- Avoid N+1 queries
- Use indexes
- Cache rarely-changing data
