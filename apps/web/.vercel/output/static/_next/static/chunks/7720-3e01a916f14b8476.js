"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7720],{97720:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});let a=i(35914);a.__exportStar(i(74071),t),a.__exportStar(i(36308),t),a.__exportStar(i(46236),t),a.__exportStar(i(21138),t),a.__exportStar(i(91905),t),a.__exportStar(i(90623),t),a.__exportStar(i(64367),t)},688:function(e,t){var i,a;Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorCategory=void 0,(a=i||(t.ErrorCategory=i={})).TRANSIENT="transient",a.PERMANENT="permanent",a.RECOVERABLE="recoverable",a.FATAL="fatal"},36308:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},17432:function(e,t,i){var a=i(72164);Object.defineProperty(t,"__esModule",{value:!0}),t.MockAIProvider=t.OpenRouterProvider=t.OpenAIProvider=t.GeminiProvider=t.AIPromptEnhancer=void 0,t.createGeminiEnhancer=g,t.createOpenAIEnhancer=m,t.createOpenRouterEnhancer=h,t.createMockEnhancer=f,t.createAutoEnhancer=function(e){var t,i,r,o;let n=(null==e?void 0:e.OPENROUTER_API_KEY)||(void 0!==a?null===(t=a.env)||void 0===t?void 0:t.OPENROUTER_API_KEY:void 0),s=(null==e?void 0:e.GEMINI_API_KEY)||(void 0!==a?null===(i=a.env)||void 0===i?void 0:i.GEMINI_API_KEY:void 0),l=(null==e?void 0:e.OPENAI_API_KEY)||(void 0!==a?null===(r=a.env)||void 0===r?void 0:r.OPENAI_API_KEY:void 0),d=(null==e?void 0:e.OPENROUTER_DEFAULT_MODEL)||(void 0!==a?null===(o=a.env)||void 0===o?void 0:o.OPENROUTER_DEFAULT_MODEL:void 0);return n?h({apiKey:n,defaultModel:d,httpReferer:window.location.origin,appTitle:"RYLA AI Influencer Platform"}):s?g({apiKey:s}):l?m({apiKey:l}):(console.warn("No AI API key found, using mock enhancer"),f())};let r=i(35914),o=`You are an expert AI image prompt engineer specializing in photorealistic AI influencer images.

Your task is to enhance prompts to produce high-quality, realistic images that look like authentic photographs.

Key principles for Photorealism:
1. SUBJECT & ANATOMY: Start with the subject (age, ethnicity, features). Preserve slight natural asymmetries. Ensure gravity-based compression on soft tissue and realistic muscle definition.
2. CAMERA & OPTICS: Use high-end specs: "Shot on Fujifilm GFX 100S, 80mm prime lens, f/2.8". Include "shallow depth of field", "sharp focus on eyes", and "natural background bokeh".
3. LIGHTING: Use "high-key butterfly lighting", "large softboxes", and "subsurface scattering". Avoid artificial rim light, bloom, or glow.
4. MICRO-TEXTURES: Mention individual hair strands, pores, fine wrinkles, follicles, and tear-film reflections. Include "wet mucosa" and "subdermal depth".
5. AVOID AI CLICH\xc9S: Never use "perfect", "flawless", "porcelain", or "beauty filter".
6. CANDID FEEL: Focus on authentic, candid moments and natural skin imperfections.
7. IDENTITY PRESERVATION: Enforce strict facial identity preservation, bone structure consistency, and avoid beautification bias or softened morphology.

Format your response as JSON:
{
  "enhancedPrompt": "the improved prompt incorporating specific optics and micro-details",
  "negativeAdditions": ["anime", "cartoon", "cgi", "plastic skin", "airbrushed", "waxy", "smooth polygons", "excessive smoothing"],
  "changes": ["explanation of changes"],
  "confidence": 0.85
}`,n=`You are an expert AI character creation specialist. Your task is to transform a minimal character description into a detailed, unique character prompt for AI image generation.

Your goal is to create a DISTINCT, MEMORABLE character that stands out - not a generic AI-generated person.

Key principles:
1. CHARACTER UNIQUENESS: Add specific, distinguishing features that make this character memorable and unique
2. EXPAND MINIMAL INPUT: Transform brief descriptions into rich, detailed character portraits
3. PHYSICAL DETAILS: Add specific facial structure, skin tone, hair texture, body proportions, unique features
4. PERSONALITY IN APPEARANCE: Include details that reflect personality (confident posture, friendly expression, style choices)
5. REALISTIC IMPERFECTIONS: Include subtle natural features (freckles, beauty marks, natural skin texture) - avoid "perfect" or "flawless"
6. QUALITY KEYWORDS: Always include "8K hyper-realistic, ultra-detailed, professional photography" for best results
7. PRESERVE USER VISION: Keep the user's core description intact while expanding it

CRITICAL: Focus on creating a UNIQUE CHARACTER, not a generic person. Add distinguishing features, specific details, and personality markers that make this character stand out.

Format your response as JSON:
{
  "enhancedPrompt": "the detailed, unique character description with quality keywords",
  "negativeAdditions": ["terms to add to negative prompt"],
  "changes": ["explanation of character enhancements"],
  "confidence": 0.85
}`,s={quality:"Focus on technical quality: sharp focus, good lighting, high resolution.",ultraRealistic:"Maximum realism: smartphone aesthetic, natural skin texture, candid moment feel, avoid any AI artifacts.",instagramReady:"Instagram influencer aesthetic: trendy, well-lit, lifestyle photography, authentic but polished.",editorialFashion:"High fashion editorial: dramatic lighting, magazine quality, artistic composition, professional retouching.",casualSelfie:"Everyday selfie: casual, natural, smartphone quality, genuine expression, relaxed setting.",professionalPortrait:"Professional headshot: studio lighting, business attire, confident expression, clean background."};class l{constructor(e,t={}){this.provider=e,this.options=t}isAvailable(){return this.provider.isAvailable()}enhance(e){return r.__awaiter(this,void 0,void 0,function*(){var t,i,a;if(!this.isAvailable())return{enhancedPrompt:e.prompt,negativeAdditions:[],changes:["AI enhancement unavailable - using original prompt"],confidence:0,originalPrompt:e.prompt};let r=e.style||this.options.defaultStyle||"quality",s=null!==(t=e.strength)&&void 0!==t?t:.7,l=null!==(i=e.isWizard)&&void 0!==i&&i,d=l?n:o,u=this.buildUserPrompt(e,r,s,l);try{let t=yield this.provider.complete(`${d}

${u}`,{maxTokens:e.maxLength?Math.ceil(1.5*e.maxLength):500,temperature:null!==(a=this.options.temperature)&&void 0!==a?a:.7}),i=this.parseResponse(t.text,e.prompt);return Object.assign(Object.assign({},i),{originalPrompt:e.prompt,usage:t.usage})}catch(t){return console.error("AI enhancement failed:",t),{enhancedPrompt:e.prompt,negativeAdditions:[],changes:[`Enhancement failed: ${t instanceof Error?t.message:"Unknown error"}`],confidence:0,originalPrompt:e.prompt}}})}buildUserPrompt(e,t,i){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=[];if(a?(r.push(`ORIGINAL USER INPUT (minimal description):
"${e.prompt}"`),r.push(`
Before enhancing, reason through this character step by step:`),r.push("UNDERSTAND: What is the user's core vision for this character? What should this character enable or represent?"),r.push("ANALYZE: What physical features (facial structure, skin tone, hair texture, body proportions), personality traits, and unique distinguishing elements matter most?"),r.push("REASON: How do these elements interact to create a memorable, realistic character? What makes this character distinct from generic AI-generated images?"),r.push("SYNTHESIZE: What specific details will make this character feel like a real, unique person with personality?"),r.push("CONCLUDE: What is the most effective enhancement approach that preserves the user's vision while adding depth?"),r.push(`
Now enhance the prompt with this reasoning in mind:`),r.push("1. Expand this minimal description into a rich, detailed character portrait"),r.push("2. Add specific physical features (facial structure, skin tone, hair texture, body proportions)"),r.push("3. Include personality traits that show in appearance (confident posture, friendly expression, etc.)"),r.push("4. Add unique distinguishing features to make this character memorable and distinct"),r.push("5. Ensure the character feels like a real, unique person - not generic or AI-generated"),r.push("6. Focus on creating a character that stands out and has personality"),r.push(`
IMPORTANT:`),r.push("- Keep the user's core vision intact"),r.push("- Add details that make the character unique and memorable"),r.push('- Use natural, realistic descriptions (avoid "perfect" or "flawless")'),r.push("- Include subtle imperfections that make characters feel real"),r.push('- Always include quality keywords: "8K hyper-realistic, ultra-detailed, professional photography"')):(r.push(`ORIGINAL PROMPT:
"${e.prompt}"`),r.push(`
TARGET STYLE: ${t}`),r.push(s[t])),e.characterContext){let t=e.characterContext;r.push(`
CHARACTER CONTEXT:`),r.push(`- Name: ${t.name}`),t.age&&r.push(`- Age: ${t.age}`),t.ethnicity&&r.push(`- Ethnicity: ${t.ethnicity}`),t.hair&&r.push(`- Hair: ${t.hair}`),t.eyes&&r.push(`- Eyes: ${t.eyes}`),t.skin&&r.push(`- Skin: ${t.skin}`),t.bodyType&&r.push(`- Body Type: ${t.bodyType}`),r.push(`
Maintain consistency with this character description.`)}return e.targetModel&&(r.push(`
TARGET MODEL: ${e.targetModel}`),"flux-dev"===e.targetModel?r.push("Optimize for photorealism and detail. Use natural language descriptions."):"z-image-turbo"===e.targetModel&&r.push("Keep prompt concise but descriptive. Focus on key visual elements.")),e.focus&&e.focus.length>0&&r.push(`
FOCUS AREAS: ${e.focus.join(", ")}`),r.push(`
ENHANCEMENT STRENGTH: ${Math.round(100*i)}%`),i<.3?r.push("Make minimal changes - just fix obvious issues."):i<.6?r.push("Make moderate improvements while preserving the original intent."):r.push("Significantly enhance with rich detail and photography techniques."),r.push("\nProvide your response as valid JSON."),r.join("\n")}parseResponse(e,t){try{let i=e.match(/\{[\s\S]*\}/);if(i){let e=JSON.parse(i[0]);return{enhancedPrompt:e.enhancedPrompt||t,negativeAdditions:e.negativeAdditions||[],changes:e.changes||[],confidence:"number"==typeof e.confidence?e.confidence:.5}}}catch(e){}return{enhancedPrompt:e.trim()||t,negativeAdditions:[],changes:["Response format was unexpected"],confidence:.3}}quickEnhance(e){return r.__awaiter(this,arguments,void 0,function*(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ultraRealistic";return(yield this.enhance({prompt:e,style:t})).enhancedPrompt})}}t.AIPromptEnhancer=l;class d{constructor(e){this.name="gemini",this.apiKey=e.apiKey,this.model=e.model||"gemini-1.5-flash",this.baseUrl=e.baseUrl||"https://generativelanguage.googleapis.com/v1beta"}isAvailable(){return!!this.apiKey}complete(e,t){return r.__awaiter(this,void 0,void 0,function*(){var i,a,r,o,n;let s=yield fetch(`${this.baseUrl}/models/${this.model}:generateContent?key=${this.apiKey}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:e}]}],generationConfig:{maxOutputTokens:(null==t?void 0:t.maxTokens)||500,temperature:(null==t?void 0:t.temperature)||.7}})});if(!s.ok){let e=yield s.text();throw Error(`Gemini API error: ${s.status} - ${e}`)}let l=yield s.json();return{text:(null===(n=null===(o=null===(r=null===(a=null===(i=l.candidates)||void 0===i?void 0:i[0])||void 0===a?void 0:a.content)||void 0===r?void 0:r.parts)||void 0===o?void 0:o[0])||void 0===n?void 0:n.text)||"",usage:l.usageMetadata?{inputTokens:l.usageMetadata.promptTokenCount||0,outputTokens:l.usageMetadata.candidatesTokenCount||0}:void 0}})}}t.GeminiProvider=d;class u{constructor(e){this.name="openai",this.apiKey=e.apiKey,this.model=e.model||"gpt-4o-mini",this.baseUrl=e.baseUrl||"https://api.openai.com/v1"}isAvailable(){return!!this.apiKey}complete(e,t){return r.__awaiter(this,void 0,void 0,function*(){var i,a,r;let o=yield fetch(`${this.baseUrl}/chat/completions`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.apiKey}`},body:JSON.stringify({model:this.model,messages:[{role:"user",content:e}],max_tokens:(null==t?void 0:t.maxTokens)||500,temperature:(null==t?void 0:t.temperature)||.7})});if(!o.ok){let e=yield o.text();throw Error(`OpenAI API error: ${o.status} - ${e}`)}let n=yield o.json();return{text:(null===(r=null===(a=null===(i=n.choices)||void 0===i?void 0:i[0])||void 0===a?void 0:a.message)||void 0===r?void 0:r.content)||"",usage:n.usage?{inputTokens:n.usage.prompt_tokens||0,outputTokens:n.usage.completion_tokens||0}:void 0}})}}t.OpenAIProvider=u;class c{constructor(e){this.name="openrouter",this.apiKey=e.apiKey,this.defaultModel=e.defaultModel||"openai/gpt-4o-mini",this.baseUrl=e.baseUrl||"https://openrouter.ai/api/v1",this.httpReferer=e.httpReferer,this.appTitle=e.appTitle}isAvailable(){return!!this.apiKey}complete(e,t){return r.__awaiter(this,void 0,void 0,function*(){var i,a,r;let o={"Content-Type":"application/json",Authorization:`Bearer ${this.apiKey}`};this.httpReferer&&(o["HTTP-Referer"]=this.httpReferer),this.appTitle&&(o["X-Title"]=this.appTitle);let n=yield fetch(`${this.baseUrl}/chat/completions`,{method:"POST",headers:o,body:JSON.stringify({model:(null==t?void 0:t.model)||this.defaultModel,messages:[{role:"user",content:e}],max_tokens:(null==t?void 0:t.maxTokens)||500,temperature:(null==t?void 0:t.temperature)||.7})});if(!n.ok){let e=yield n.text();throw Error(`OpenRouter API error: ${n.status} - ${e}`)}let s=yield n.json();return{text:(null===(r=null===(a=null===(i=s.choices)||void 0===i?void 0:i[0])||void 0===a?void 0:a.message)||void 0===r?void 0:r.content)||"",usage:s.usage?{inputTokens:s.usage.prompt_tokens||0,outputTokens:s.usage.completion_tokens||0}:void 0}})}}t.OpenRouterProvider=c;class p{constructor(){this.name="mock"}isAvailable(){return!0}complete(e){return r.__awaiter(this,void 0,void 0,function*(){let t=e.match(/ORIGINAL PROMPT:\n"([^"]+)"/),i=t?t[1]:"A beautiful woman";return{text:JSON.stringify({enhancedPrompt:`${i}, photographed with a smartphone camera, natural skin texture with visible pores, candid moment, soft natural lighting, shallow depth of field, authentic Instagram aesthetic, high resolution`,negativeAdditions:["airbrushed","plastic skin","uncanny valley"],changes:["Added smartphone photography aesthetic","Included natural skin texture details","Added candid moment feel"],confidence:.85})}})}}function g(e){return new l(new d({apiKey:e.apiKey,model:e.model}),{defaultStyle:e.defaultStyle})}function m(e){return new l(new u({apiKey:e.apiKey,model:e.model}),{defaultStyle:e.defaultStyle})}function h(e){return new l(new c({apiKey:e.apiKey,defaultModel:e.defaultModel,httpReferer:e.httpReferer,appTitle:e.appTitle}),{defaultStyle:e.defaultStyle})}function f(){return new l(new p)}t.MockAIProvider=p},6975:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.PromptBuilder=void 0,t.buildOutfitPrompt=g,t.buildPrompt=function(e,t,i){let a=new p().withCharacter(t).withTemplate(e);return(null==i?void 0:i.scene)&&a.withScene(i.scene),(null==i?void 0:i.outfit)&&a.withOutfit(i.outfit),(null==i?void 0:i.lighting)&&a.withLighting(i.lighting),(null==i?void 0:i.expression)&&a.withExpression(i.expression),a.build()},t.generateRandomPrompt=function(e){let t=o.promptTemplates[Math.floor(Math.random()*o.promptTemplates.length)],i=[...Object.values(n.sceneOptions.indoor),...Object.values(n.sceneOptions.outdoor)],a=[...Object.values(n.outfitOptions.casual),...Object.values(n.outfitOptions.fashion)],r=[...Object.values(n.lightingOptions.natural),...Object.values(n.lightingOptions.studio)],s=[...Object.values(n.expressionOptions.positive),...Object.values(n.expressionOptions.neutral)];return new p().withCharacter(e).withTemplate(t.id).withScene(i[Math.floor(Math.random()*i.length)]).withOutfit(a[Math.floor(Math.random()*a.length)]).withLighting(r[Math.floor(Math.random()*r.length)]).withExpression(s[Math.floor(Math.random()*s.length)]).withStylePreset("quality").build()};let a=i(35914),r=i(20787),o=i(18308),n=i(48994),s=i(47619),l=i(41234),d=i(22378),u=i(32012),c=i(35071);class p{constructor(){this.additionalDetails=[],this.modifiers=[],this.additionalNegatives=[],this.realismMode=!1,this.targetModel="default",this.contextEnhancementEnabled=!1,this.contextOptions={includeAtmosphere:!0,includeLighting:!0,includeActivity:!1,maxAdditions:3}}withCharacter(e){return this.character=e,this}withTemplate(e){let t=(0,o.getTemplateById)(e);return t?this.template=t:this.template={id:"custom",category:"portrait",subcategory:"custom",name:"Custom Template",description:"User-provided template",template:e,requiredDNA:["age","hair","eyes","skin"],tags:[],rating:"sfw"},this}withScene(e){return this.scenePath=e,this.scene=this.resolveOption(e,n.sceneOptions),this}withContextEnhancement(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],t=arguments.length>1?arguments[1]:void 0;return this.contextEnhancementEnabled=e,t&&(this.contextOptions=Object.assign(Object.assign({},this.contextOptions),t)),this}withOutfit(e){return"string"==typeof e?this.outfit=this.resolveOption(e,n.outfitOptions):this.outfit=e,this}withLighting(e){return this.lighting=this.resolveOption(e,n.lightingOptions),this}withExpression(e){return this.expression=this.resolveOption(e,n.expressionOptions),this}withPose(e){return this.pose=this.resolveOption(e,n.poseOptions),this}addDetails(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return this.additionalDetails.push(...t),this}addModifiers(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return this.modifiers.push(...t),this}withStylePreset(e){return this.modifiers.push(...n.styleModifiers[e]),this}withEnhancedStylePreset(e){let t=n.stylePresets[e];return t&&(this.activeStylePreset=e,this.modifiers.push(...t.modifiers)),this}withRealismMode(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return this.realismMode=e,e&&this.modifiers.push(...n.styleModifiers.ultraRealistic,...n.styleModifiers.naturalSkin,...n.styleModifiers.optics),this}withGoldStandard(){return this.modifiers.push("strict facial identity preservation","avoiding beautification bias","no softened morphology","preserving natural facial tension","credible musculature","realistic fabric physics and interaction"),this.withRealismMode(!0),this}forModel(e){return this.targetModel=e,this}withNegativePrompt(e){return this.customNegative=e,this}build(){var e,t,i,a;let o;if(!this.character)throw Error("Character DNA is required. Use withCharacter() first.");let l=[];if(this.contextEnhancementEnabled&&this.scenePath){let e=(0,s.applyContextEnhancements)(this.scenePath,this.contextOptions);l=e.promptAdditions,this.additionalNegatives.push(...e.negativeAdditions),!this.lighting&&e.suggestedLighting&&(this.lighting=e.suggestedLighting)}let d=(null===(e=this.template)||void 0===e?void 0:e.template)||"{{character}}, {{expression}}, {{pose}}, {{lighting}}, {{outfit}}, {{scene}}",u=(0,r.dnaToPromptSegment)(this.character),c="string"==typeof this.outfit?this.outfit:g(this.outfit),p=d.replace(/\{\{character\}\}/g,u).replace(/\{\{name\}\}/g,this.character.name).replace(/\{\{outfit\}\}/g,c||"casual outfit").replace(/\{\{scene\}\}/g,this.scene||"neutral background").replace(/\{\{lighting\}\}/g,this.lighting||"natural lighting").replace(/\{\{expression\}\}/g,this.expression||"natural expression").replace(/\{\{pose\}\}/g,this.pose||"");return l.length>0&&(p+=", "+l.join(", ")),this.additionalDetails.length>0&&(p+=", "+this.additionalDetails.join(", ")),this.modifiers.length>0&&(p+=", "+this.modifiers.join(", ")),p=p.replace(/,\s*,/g,",").replace(/,\s*$/g,"").replace(/^\s*,/g,"").replace(/\s+/g," ").trim(),o=this.customNegative?this.customNegative:this.activeStylePreset&&n.stylePresets[this.activeStylePreset]?(0,n.buildNegativePrompt)(n.stylePresets[this.activeStylePreset].negativeCategories):this.realismMode||"default"!==this.targetModel?(0,n.buildEnhancedNegativePrompt)({model:this.targetModel,includeAiArtifacts:this.realismMode,includeSkin:this.realismMode,includeBody:!0}):(null===(t=this.template)||void 0===t?void 0:t.negativePrompt)?this.template.negativePrompt:(0,n.buildNegativePrompt)(),this.additionalNegatives.length>0&&(o+=", "+this.additionalNegatives.join(", ")),{prompt:p,negativePrompt:o,recommended:{workflow:(null===(i=this.template)||void 0===i?void 0:i.recommendedWorkflow)||"z-image-danrisi",aspectRatio:(null===(a=this.template)||void 0===a?void 0:a.aspectRatio)||"1:1"}}}buildOptimized(){let e=this.build();return(0,u.optimizeForModel)(this.targetModel,{prompt:e.prompt,negativePrompt:e.negativePrompt,aspectRatio:e.recommended.aspectRatio,realismMode:this.realismMode})}checkModelCompatibility(){if("default"===this.targetModel)return{compatible:!0,warnings:[],suggestions:[]};let e=this.build();return(0,u.checkModelCompatibility)(this.targetModel,e.prompt)}getModelParameters(){var e;let t=(0,u.getModelConfig)(this.targetModel);return{steps:t.defaultSteps,guidance:t.defaultGuidance,aspectRatio:(null===(e=this.template)||void 0===e?void 0:e.aspectRatio)||t.recommendedAspectRatios[0]}}buildWithAI(e,t){return a.__awaiter(this,void 0,void 0,function*(){let i=this.build(),a=yield e.enhance({prompt:i.prompt,style:this.activeStylePreset,characterContext:this.character,targetModel:"default"===this.targetModel?void 0:this.targetModel,strength:null==t?void 0:t.strength,focus:null==t?void 0:t.focus}),r=i.negativePrompt;return a.negativeAdditions.length>0&&(r+=", "+a.negativeAdditions.join(", ")),{prompt:a.enhancedPrompt,negativePrompt:r,recommended:i.recommended,enhancement:a}})}validateCoherence(){let e={};return this.scenePath&&(e.scene=this.scenePath),this.expression&&(e.expression=this.findExpressionPath()),this.pose&&(e.pose=this.findPosePath()),this.outfit&&(e.outfit=this.findOutfitPath()),(0,l.validateCoherence)(e)}getQualityScore(){let e=this.build(),t=this.validateCoherence(),i={prompt:e.prompt,negativePrompt:e.negativePrompt,hasRealism:this.realismMode,hasContextEnhancement:this.contextEnhancementEnabled,hasStylePreset:!!this.activeStylePreset,hasModelTarget:"default"!==this.targetModel,coherenceWarnings:t.warningCount,hasExpression:!!this.expression,hasPose:!!this.pose,hasLighting:!!this.lighting,hasScene:!!this.scene};return(0,d.scorePrompt)(i)}preflightCheck(){let e=[],t=[];this.character||e.push("Character DNA is required");let i=this.validateCoherence();for(let a of i.warnings)"high"===a.severity?e.push(a.message):t.push(a.message);return t.push(...i.suggestions),{isReady:0===e.length,blockers:e,warnings:Array.from(new Set(t))}}findExpressionPath(){if(this.expression){for(let[e,t]of Object.entries(n.expressionOptions))if("object"==typeof t){for(let[i,a]of Object.entries(t))if(a===this.expression)return`${e}.${i}`}}}findPosePath(){if(this.pose){for(let[e,t]of Object.entries(n.poseOptions))if("object"==typeof t){for(let[i,a]of Object.entries(t))if(a===this.pose)return`${e}.${i}`}}}findOutfitPath(){if(this.outfit&&"string"==typeof this.outfit){for(let[e,t]of Object.entries(n.outfitOptions))if("object"==typeof t){for(let[i,a]of Object.entries(t))if(a===this.outfit)return`${e}.${i}`}}}resolveOption(e,t){let i=e.split("."),a=t;for(let t of i){if("object"!=typeof a||null===a||!(t in a))return e;a=a[t]}return"string"==typeof a?a:e}}function g(e){if(!e)return"";let t=[];if(e.top){let i=(0,c.getPieceById)(e.top);i&&t.push(i.label.toLowerCase())}if(e.bottom){let i=(0,c.getPieceById)(e.bottom);i&&t.push(i.label.toLowerCase())}if(e.shoes){let i=(0,c.getPieceById)(e.shoes);i&&t.push(i.label.toLowerCase())}if(e.headwear&&"none"!==e.headwear&&"none-headwear"!==e.headwear){let i=(0,c.getPieceById)(e.headwear);i&&t.push(`wearing ${i.label.toLowerCase()}`)}if(e.outerwear&&"none"!==e.outerwear&&"none-outerwear"!==e.outerwear){let i=(0,c.getPieceById)(e.outerwear);i&&t.push(`wearing ${i.label.toLowerCase()}`)}if(e.accessories&&e.accessories.length>0){let i=e.accessories.map(e=>{let t=(0,c.getPieceById)(e);return t?t.label.toLowerCase():e}).join(", ");i&&t.push(`with ${i}`)}return t.length>0?`wearing ${t.join(", ")}`:""}t.PromptBuilder=p},48994:function(e,t){function i(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["anatomy","quality","face"],i=[];for(let a of e)i.push(...t.negativePromptElements[a]);return i.join(", ")}Object.defineProperty(t,"__esModule",{value:!0}),t.stylePresets=t.negativePromptElements=t.styleModifiers=t.poseOptions=t.expressionOptions=t.lightingOptions=t.outfitOptions=t.sceneOptions=void 0,t.buildNegativePrompt=i,t.buildEnhancedNegativePrompt=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{model:t="default",includeAiArtifacts:a=!0,includeSkin:r=!0,includeBody:o=!0}=e,n=["anatomy","quality","face","faceAdvanced"];return r&&n.push("skin"),a&&n.push("aiArtifacts"),o&&n.push("bodyProportions"),("flux-dev"===t||"z-image-turbo"===t)&&n.push("flux"),i(n)},t.sceneOptions={indoor:{bedroom:"modern bedroom with soft lighting",livingRoom:"cozy living room with natural light",kitchen:"bright modern kitchen",bathroom:"clean minimalist bathroom",office:"stylish home office",studio:"professional photography studio with white backdrop",gym:"modern fitness gym with equipment",cafe:"trendy coffee shop with warm ambiance",restaurant:"upscale restaurant with mood lighting"},outdoor:{beach:"tropical sandy beach with turquoise water",city:"busy urban city street",park:"lush green park with trees",garden:"beautiful flower garden",rooftop:"city rooftop with skyline view",pool:"luxury pool area with lounge chairs",forest:"serene forest with natural light filtering through trees",desert:"dramatic desert landscape at sunset",mountains:"scenic mountain backdrop"}},t.outfitOptions={casual:{jeans:"casual jeans and t-shirt",sundress:"flowy summer sundress",sweater:"cozy oversized sweater",loungewear:"comfortable loungewear set",streetwear:"trendy streetwear outfit"},formal:{cocktailDress:"elegant cocktail dress",eveningGown:"stunning evening gown",businessSuit:"professional business suit",blazer:"chic blazer and trousers"},athletic:{yogaOutfit:"yoga pants and sports bra",gymWear:"athletic leggings and tank top",runningGear:"running shorts and fitted top",swimwear:"stylish one-piece swimsuit"},fashion:{designer:"high-end designer outfit",bohemian:"bohemian flowy dress with accessories",minimalist:"minimalist monochrome outfit",vintage:"retro vintage inspired outfit"}},t.lightingOptions={natural:{goldenHour:"warm golden hour sunlight",blueHour:"soft blue hour twilight",softDaylight:"soft diffused natural daylight",windowLight:"natural light from large window",overcast:"soft overcast sky lighting"},studio:{softbox:"professional softbox lighting",ringLight:"ring light illumination",dramatic:"dramatic single-source lighting with shadows",highKey:"bright high-key studio lighting",lowKey:"moody low-key lighting"},creative:{neon:"colorful neon lighting",candle:"warm candlelight ambiance",fairy:"magical fairy lights",sunset:"vibrant sunset colors",moonlight:"soft moonlight glow"}},t.expressionOptions={positive:{smile:"warm genuine smile",laugh:"natural joyful laugh",happy:"happy relaxed expression",excited:"excited enthusiastic expression",confident:"confident self-assured expression"},neutral:{serene:"serene peaceful expression",thoughtful:"thoughtful contemplative look",natural:"natural relaxed expression",subtle:"subtle enigmatic smile"},dramatic:{intense:"intense focused gaze",mysterious:"mysterious alluring expression",fierce:"fierce powerful expression",sultry:"sultry captivating look"}},t.poseOptions={standing:{casual:"relaxed casual standing pose",confident:"confident power stance",walking:"natural walking mid-stride, full body visible",leaning:"casually leaning against wall",armsCrossed:"standing with arms crossed, confident",handsPocket:"standing with hands in pockets, relaxed cool",waving:"standing and waving, friendly greeting",pointing:"standing and pointing, engaging gesture",thinking:"standing in thoughtful pose, hand on chin",elegant:"standing elegantly, model pose, graceful posture",backView:"standing with back to camera, looking over shoulder",sideProfile:"standing in side profile, elegant silhouette"},sitting:{relaxed:"relaxed sitting position",crossLegged:"sitting cross-legged on floor, casual",perched:"perched on edge elegantly, legs crossed",lounging:"lounging comfortably on couch or bed",edge:"sitting on edge of surface, legs dangling",backward:"sitting backward on chair, arms resting on back",reading:"sitting and reading, relaxed focus",working:"sitting at desk working, productive pose",elegant:"sitting elegantly, legs to side, sophisticated",floor:"sitting on floor, casual relaxed pose"},lying:{relaxed:"lying down relaxed, peaceful pose",propped:"lying propped up on elbow, casual",stomach:"lying on stomach, looking up at camera",elegant:"lying elegantly, artistic pose",stretching:"lying and stretching, elongated pose"},action:{dancing:"dynamic dancing movement, expressive",stretching:"graceful stretching pose, flexible",exercising:"active workout pose, athletic",playing:"playful action pose, joyful",yoga:"yoga pose, balanced and centered",running:"running or jogging, dynamic motion",jumping:"mid-jump, energetic and playful",sports:"athletic sports pose, dynamic"},expressive:{laughing:"laughing genuinely, candid joy",surprised:"surprised expression, playful reaction",thinking:"deep in thought, contemplative"}},t.styleModifiers={quality:["ultra-detailed","high resolution","8k quality","professional photography","masterpiece","best quality"],photography:["DSLR photo","bokeh background","shallow depth of field","cinematic composition","rule of thirds","perfect framing"],optics:["Shot on Fujifilm GFX 100S","80mm prime lens","f/2.8","realistic lens falloff","accurate optical perspective","subsurface scattering"],realism:["photorealistic","hyperrealistic","lifelike","natural textures","realistic skin details","anatomically correct"],aesthetic:["Instagram aesthetic","editorial style","fashion magazine quality","Pinterest aesthetic","influencer style"],ultraRealistic:["amateur photo camera style","candid moment captured","authentic natural lighting","high-key butterfly lighting","raw unedited aesthetic","microtextures visible","preserved natural asymmetries"],naturalSkin:["natural skin texture with visible pores","subtle skin imperfections","realistic skin lighting","authentic complexion","tear-film reflections","wet mucosa","follicular detail"],smartphone:["smartphone selfie aesthetic","casual phone photo quality","authentic moment","natural imperfections"],editorial:["editorial fashion photography","magazine cover quality","professional retouching","high-end production value"]},t.negativePromptElements={anatomy:["deformed","bad anatomy","disfigured","mutated","extra limbs","missing limbs","bad hands","bad fingers","extra fingers","missing fingers","fused fingers"],quality:["blurry","low quality","pixelated","jpeg artifacts","watermark","signature","text","logo","worst quality"],face:["ugly","bad face","asymmetric eyes","cross-eyed","bad teeth","weird expression"],skin:["plastic skin","waxy skin","unnatural skin","airbrushed","mannequin"],aiArtifacts:["airbrushed perfection","plastic texture","waxy appearance","perfect symmetry","uncanny valley","oversaturated colors","artificial lighting","stock photo look","unnaturally smooth skin","porcelain doll","beautification bias","softened morphology","smooth polygons","rim light","glow"],flux:["cartoon","illustration","CGI","render","3D","anime","painted","digital art","drawing","sketch"],faceAdvanced:["misaligned pupils","unnatural smile","wrong proportions","smooth mannequin face","dead eyes","uncanny expression","distorted features"],bodyProportions:["wrong proportions","elongated limbs","tiny head","giant hands","misshapen body","floating limbs"]},t.stylePresets={quality:{modifiers:[...t.styleModifiers.quality],description:"Standard quality enhancement",negativeCategories:["anatomy","quality","face"]},ultraRealistic:{modifiers:[...t.styleModifiers.ultraRealistic,...t.styleModifiers.naturalSkin,"authentic moment","natural imperfections","candid photo"],description:"Maximum realism, smartphone aesthetic, natural look",negativeCategories:["anatomy","quality","face","faceAdvanced","skin","aiArtifacts","flux"]},instagramReady:{modifiers:["Instagram aesthetic","lifestyle photography","natural lighting","authentic moment","social media quality","trendy composition"],description:"Polished but authentic Instagram look",negativeCategories:["anatomy","quality","face","skin","aiArtifacts"]},editorialFashion:{modifiers:[...t.styleModifiers.editorial,"dramatic lighting","high fashion","Vogue quality","artistic composition"],description:"Magazine-quality editorial fashion",negativeCategories:["anatomy","quality","face","faceAdvanced"]},casualSelfie:{modifiers:[...t.styleModifiers.smartphone,"selfie aesthetic","casual moment","relaxed expression","natural setting"],description:"Everyday casual selfie vibe",negativeCategories:["anatomy","quality","face","skin","aiArtifacts","flux"]},professionalPortrait:{modifiers:["professional headshot","studio lighting","confident pose","corporate style","clean background","polished appearance"],description:"Professional headshot quality",negativeCategories:["anatomy","quality","face","faceAdvanced","skin"]}}},20787:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.characterDNATemplates=void 0,t.dnaToPromptSegment=function(e){let t=[];return e.ethnicity?t.push(`${e.age} ${e.ethnicity} woman`):t.push(`${e.age} woman`),t.push(e.hair),t.push(e.eyes),t.push(e.skin),e.facialFeatures&&t.push(e.facialFeatures),e.bodyType&&t.push(e.bodyType),t.join(", ")},t.dnaToRealisticPromptSegment=function(e){let t=[];return e.ethnicity?t.push(`${e.age} ${e.ethnicity} woman`):t.push(`${e.age} woman`),t.push(e.hair),t.push(e.eyes),t.push(e.skin.includes("skin")?e.skin.replace("skin","skin with natural texture"):`${e.skin}, natural skin texture`),e.facialFeatures&&t.push(e.facialFeatures),e.bodyType&&t.push(e.bodyType),t.join(", ")},t.createCharacterDNA=function(e,t){return Object.assign({name:e,age:t.age||"24-year-old",hair:t.hair||"long flowing hair",eyes:t.eyes||"expressive eyes",skin:t.skin||"natural skin"},t)},t.mergeCharacterDNA=function(e,t){return Object.assign(Object.assign({},e),t)},t.characterDNATemplates={classicInfluencer:{name:"influencer",age:"24-year-old",ethnicity:"Caucasian",hair:"long flowing blonde hair",eyes:"bright blue eyes",skin:"fair skin with subtle makeup",bodyType:"slim and toned",facialFeatures:"soft features, full lips, defined cheekbones",style:"Instagram influencer aesthetic"},latinaModel:{name:"emma",age:"22-year-old",ethnicity:"Latina",hair:"dark brown wavy hair",eyes:"almond-shaped brown eyes",skin:"warm tanned skin",bodyType:"curvy figure",facialFeatures:"full lips, round jawline",style:"NYC lifestyle blogger"},asianBeauty:{name:"sakura",age:"23-year-old",ethnicity:"East Asian",hair:"straight black hair with subtle highlights",eyes:"dark brown almond eyes",skin:"porcelain smooth skin",bodyType:"petite and elegant",facialFeatures:"delicate features, small nose, soft lips",style:"K-beauty aesthetic"},fitnessModel:{name:"alexis",age:"26-year-old",ethnicity:"Mixed ethnicity",hair:"long dark ponytail",eyes:"green eyes",skin:"athletic tanned skin",bodyType:"athletic and muscular",facialFeatures:"strong jawline, determined expression",style:"fitness influencer"},bohemianArtist:{name:"luna",age:"25-year-old",ethnicity:"Mediterranean",hair:"curly auburn hair",eyes:"hazel eyes",skin:"olive skin with freckles",bodyType:"natural and relaxed",facialFeatures:"expressive eyes, artistic features",style:"bohemian artist aesthetic"},highFashionModel:{name:"victoria",age:"27-year-old",ethnicity:"Eastern European",hair:"sleek platinum blonde hair",eyes:"piercing grey eyes",skin:"flawless pale skin",bodyType:"tall and slender",facialFeatures:"sharp cheekbones, defined jawline, pouty lips",style:"high fashion editorial"}}},41234:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.validateCoherence=function(e){let t=[],l=function(e,t){var r;if(!e||!t)return null;let o=i[e],s=a[t];if(!o||!s)return null;let l=n[o];if(l&&!l.includes(s)){let a=[];for(let[e,t]of Object.entries(i))if((null===(r=n[t])||void 0===r?void 0:r.includes(s))&&(a.push(`Try ${e.split(".")[1]} expression`),a.length>=2))break;return{type:"expression_pose_conflict",message:`"${e.split(".")[1]}" expression may look awkward with "${t.split(".")[1]}" pose`,severity:"medium",elements:[e,t],suggestions:a}}return null}(e.expression,e.pose);l&&t.push(l);let d=function(e,t){if(!e||!t)return null;let i=r[e],a=o[t];if(!i||!a)return null;let n=s[i];if(n&&!n.includes(a)){let i=[];for(let[e,t]of Object.entries(o))if(n.includes(t)&&(i.push(`Try ${e.split(".")[1]} outfit`),i.length>=2))break;return{type:"scene_outfit_conflict",message:`"${t.split(".")[1]}" outfit may look out of place in "${e.split(".")[1]}" scene`,severity:"low",elements:[e,t],suggestions:i}}return null}(e.scene,e.outfit);d&&t.push(d);let u=function(e,t){if(!e||!t)return null;let i=e.includes("gym"),a=t.includes("athletic")||t.includes("gym")||t.includes("yoga");return i&&!a?{type:"scene_outfit_conflict",message:"Gym scene typically requires athletic wear",severity:"high",elements:[e,t],suggestions:["Use athletic.gymWear or athletic.yogaOutfit"]}:null}(e.scene,e.outfit);u&&t.push(u);let c=function(e,t){if(!e||!t)return null;let i=e.includes("beach")||e.includes("pool"),a=t.includes("formal")||t.includes("business");return i&&a?{type:"scene_outfit_conflict",message:"Formal attire looks unusual at the beach/pool",severity:"high",elements:[e,t],suggestions:["Use casual.sundress or athletic.swimwear"]}:null}(e.scene,e.outfit);c&&t.push(c);let p=t.flatMap(e=>e.suggestions||[]).filter((e,t,i)=>i.indexOf(e)===t);return{valid:!t.some(e=>"high"===e.severity),warningCount:t.length,warnings:t,suggestions:p}},t.getCompatibleExpressions=function(e){let t=a[e];if(!t)return[];let r=[];for(let[e,a]of Object.entries(n))if(a.includes(t))for(let[t,a]of Object.entries(i))a===e&&r.push(t);return r},t.getCompatiblePoses=function(e){let t=i[e];if(!t)return[];let r=n[t]||[],o=[];for(let[e,t]of Object.entries(a))r.includes(t)&&o.push(e);return o},t.getCompatibleOutfits=function(e){let t=r[e];if(!t)return[];let i=s[t]||[],a=[];for(let[e,t]of Object.entries(o))i.includes(t)&&a.push(e);return a};let i={"positive.smile":"playful","positive.laugh":"energetic","positive.happy":"energetic","positive.excited":"energetic","positive.confident":"professional","neutral.serene":"calm","neutral.thoughtful":"calm","neutral.natural":"calm","neutral.subtle":"calm","dramatic.intense":"dramatic","dramatic.mysterious":"dramatic","dramatic.fierce":"dramatic","dramatic.sultry":"dramatic"},a={"standing.casual":"relaxed","standing.confident":"professional","standing.walking":"dynamic","standing.leaning":"relaxed","sitting.relaxed":"relaxed","sitting.crossLegged":"relaxed","sitting.perched":"professional","sitting.lounging":"intimate","action.dancing":"active","action.stretching":"active","action.exercising":"active","action.playing":"active"},r={"indoor.bedroom":"intimate","indoor.livingRoom":"casual","indoor.kitchen":"casual","indoor.bathroom":"intimate","indoor.office":"professional","indoor.studio":"professional","indoor.cafe":"casual","indoor.restaurant":"formal","indoor.gym":"athletic","outdoor.beach":"casual","outdoor.park":"casual","outdoor.garden":"casual","outdoor.pool":"casual","outdoor.city":"casual","outdoor.rooftop":"formal","outdoor.forest":"outdoor","outdoor.desert":"outdoor","outdoor.mountains":"outdoor"},o={"casual.jeans":"casual","casual.sundress":"casual","casual.sweater":"casual","casual.loungewear":"intimate","casual.streetwear":"casual","formal.cocktailDress":"formal","formal.eveningGown":"formal","formal.businessSuit":"formal","formal.blazer":"formal","athletic.yogaOutfit":"athletic","athletic.gymWear":"athletic","athletic.runningGear":"athletic","athletic.swimwear":"casual","fashion.designer":"fashion","fashion.bohemian":"fashion","fashion.minimalist":"fashion","fashion.vintage":"fashion"},n={energetic:["active","dynamic","relaxed"],calm:["relaxed","intimate","professional"],dramatic:["professional","dynamic","intimate"],playful:["active","relaxed","dynamic"],professional:["professional","relaxed"]},s={casual:["casual","fashion","athletic"],formal:["formal","fashion"],athletic:["athletic","casual"],outdoor:["casual","athletic"],professional:["formal","fashion","casual"],intimate:["intimate","casual"]}},47619:function(e,t){function i(e){if(t.allSceneContexts[e])return t.allSceneContexts[e];let i=e.split(".").pop();if(i){let e=t.indoorSceneContexts[i];if(e)return e;let a=t.outdoorSceneContexts[i];if(a)return a}}Object.defineProperty(t,"__esModule",{value:!0}),t.allSceneContexts=t.outdoorSceneContexts=t.indoorSceneContexts=void 0,t.getSceneContext=i,t.applyContextEnhancements=function(e){var t;let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{includeAtmosphere:r=!0,includeLighting:o=!0,includeActivity:n=!1,maxAdditions:s=3}=a,l=i(e);if(!l)return{promptAdditions:[],negativeAdditions:[]};let d=[],u=[...l.avoid];if(r&&d.push(...l.additions.slice(0,s)),n&&(null===(t=l.activitySuggestions)||void 0===t?void 0:t.length)){let e=l.activitySuggestions[Math.floor(Math.random()*l.activitySuggestions.length)];d.push(e)}return{promptAdditions:d,negativeAdditions:u,suggestedLighting:o?l.suggestedLighting:void 0}},t.listSceneContexts=function(){let e=[];for(let[i,a]of Object.entries(t.indoorSceneContexts))e.push({id:`indoor.${i}`,name:a.name,category:"indoor",suggestedTime:a.suggestedTime});for(let[i,a]of Object.entries(t.outdoorSceneContexts))e.push({id:`outdoor.${i}`,name:a.name,category:"outdoor",suggestedTime:a.suggestedTime});return e},t.indoorSceneContexts={bedroom:{sceneId:"indoor.bedroom",name:"Bedroom",additions:["soft ambient lighting","cozy intimate atmosphere","comfortable relaxed setting"],avoid:["harsh lighting","clinical look","empty sterile room"],suggestedLighting:"soft diffused window light",suggestedTime:"morning",activitySuggestions:["morning routine","relaxing","reading"]},livingRoom:{sceneId:"indoor.livingRoom",name:"Living Room",additions:["warm home atmosphere","comfortable domestic setting","natural daylight from windows"],avoid:["empty room","harsh shadows","cold atmosphere"],suggestedLighting:"natural window light",suggestedTime:"afternoon",activitySuggestions:["lounging","relaxing with coffee","casual moment"]},kitchen:{sceneId:"indoor.kitchen",name:"Kitchen",additions:["bright modern interior","clean countertops visible","warm domestic atmosphere"],avoid:["messy kitchen","dark shadows","cluttered space"],suggestedLighting:"bright overhead and window light",suggestedTime:"morning",activitySuggestions:["cooking","having breakfast","drinking coffee"]},bathroom:{sceneId:"indoor.bathroom",name:"Bathroom",additions:["clean minimalist interior","soft diffused lighting","fresh clean atmosphere"],avoid:["dirty bathroom","harsh fluorescent lighting","cluttered"],suggestedLighting:"soft diffused lighting",suggestedTime:"morning",activitySuggestions:["skincare routine","getting ready","mirror selfie"]},office:{sceneId:"indoor.office",name:"Home Office",additions:["professional workspace","modern desk setup","productive atmosphere"],avoid:["messy desk","dark cramped space","unprofessional background"],suggestedLighting:"natural daylight with desk lamp",suggestedTime:"afternoon",activitySuggestions:["working","video call","focused concentration"]},studio:{sceneId:"indoor.studio",name:"Photography Studio",additions:["professional photography setup","clean backdrop","controlled studio lighting"],avoid:["amateur setup","distracting background","harsh shadows"],suggestedLighting:"professional softbox lighting",activitySuggestions:["posing","modeling","professional shoot"]},gym:{sceneId:"indoor.gym",name:"Gym",additions:["modern fitness equipment visible","energetic workout atmosphere","motivational environment"],avoid:["empty gym","dirty equipment","crowded distracting background"],suggestedLighting:"bright overhead lighting",activitySuggestions:["working out","stretching","post-workout"]},cafe:{sceneId:"indoor.cafe",name:"Coffee Shop",additions:["cozy caf\xe9 ambiance","warm interior lighting","trendy coffee shop aesthetic","ambient coffee shop atmosphere"],avoid:["empty caf\xe9","harsh lighting","sterile environment"],suggestedLighting:"warm ambient with natural window light",suggestedTime:"morning",activitySuggestions:["drinking coffee","reading","casual conversation"]},restaurant:{sceneId:"indoor.restaurant",name:"Restaurant",additions:["elegant dining atmosphere","sophisticated ambiance","mood lighting"],avoid:["empty restaurant","fast food setting","harsh fluorescent"],suggestedLighting:"moody atmospheric lighting",suggestedTime:"evening",activitySuggestions:["dining","date night","elegant moment"]}},t.outdoorSceneContexts={beach:{sceneId:"outdoor.beach",name:"Beach",additions:["ocean waves in background","sandy beach texture","natural sea breeze effect on hair","tropical paradise atmosphere"],avoid:["crowded beach","harsh midday shadows","overcast gloomy"],suggestedLighting:"golden hour sunlight",suggestedTime:"golden_hour",activitySuggestions:["walking on beach","relaxing by ocean","beach day"]},city:{sceneId:"outdoor.city",name:"City Street",additions:["urban street atmosphere","city architecture in background","street style aesthetic","metropolitan energy"],avoid:["empty street","dangerous looking area","construction"],suggestedLighting:"natural daylight",suggestedTime:"afternoon",activitySuggestions:["walking","street photography","urban exploration"]},park:{sceneId:"outdoor.park",name:"Park",additions:["lush green nature","trees and foliage visible","peaceful outdoor atmosphere","natural sunlight filtering through trees"],avoid:["dead grass","crowded picnic area","construction"],suggestedLighting:"dappled sunlight through leaves",suggestedTime:"afternoon",activitySuggestions:["walking","picnic","relaxing outdoors","with dog"]},garden:{sceneId:"outdoor.garden",name:"Garden",additions:["beautiful flowers blooming","colorful garden backdrop","fresh natural atmosphere","botanical beauty"],avoid:["dead plants","overgrown weeds","unkempt garden"],suggestedLighting:"soft natural daylight",suggestedTime:"morning",activitySuggestions:["among flowers","garden stroll","spring vibes"]},rooftop:{sceneId:"outdoor.rooftop",name:"Rooftop",additions:["city skyline visible","urban rooftop atmosphere","panoramic view","sophisticated urban setting"],avoid:["industrial roof","dangerous edge","construction"],suggestedLighting:"golden hour or blue hour",suggestedTime:"golden_hour",activitySuggestions:["enjoying view","rooftop party","sunset watching"]},pool:{sceneId:"outdoor.pool",name:"Pool",additions:["crystal clear pool water","luxury pool setting","summer vacation vibes","sun-drenched atmosphere"],avoid:["dirty pool","crowded","indoor pool"],suggestedLighting:"bright sunny day",suggestedTime:"afternoon",activitySuggestions:["poolside lounging","summer relaxation","vacation"]},forest:{sceneId:"outdoor.forest",name:"Forest",additions:["natural forest environment","trees and foliage","serene woodland atmosphere","dappled sunlight through canopy"],avoid:["dead forest","scary dark woods","dense fog"],suggestedLighting:"filtered forest light",suggestedTime:"morning",activitySuggestions:["hiking","nature walk","forest exploration"]},desert:{sceneId:"outdoor.desert",name:"Desert",additions:["dramatic desert landscape","warm sandy tones","vast open space","striking natural beauty"],avoid:["harsh midday sun","barren empty","sandstorm"],suggestedLighting:"golden hour sunset colors",suggestedTime:"golden_hour",activitySuggestions:["desert adventure","sunset photography","boho vibes"]},mountains:{sceneId:"outdoor.mountains",name:"Mountains",additions:["scenic mountain backdrop","majestic peaks visible","fresh mountain air atmosphere","adventure travel vibes"],avoid:["foggy no visibility","dangerous cliff","avalanche"],suggestedLighting:"clear day with soft sunlight",suggestedTime:"morning",activitySuggestions:["hiking","mountain view","adventure travel"]}},t.allSceneContexts=Object.assign(Object.assign({},Object.fromEntries(Object.entries(t.indoorSceneContexts).map(e=>{let[t,i]=e;return[`indoor.${t}`,i]}))),Object.fromEntries(Object.entries(t.outdoorSceneContexts).map(e=>{let[t,i]=e;return[`outdoor.${t}`,i]})))},90623:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});let a=i(35914);a.__exportStar(i(94750),t),a.__exportStar(i(18308),t),a.__exportStar(i(20787),t),a.__exportStar(i(48994),t),a.__exportStar(i(6975),t),a.__exportStar(i(71018),t),a.__exportStar(i(47619),t),a.__exportStar(i(41234),t),a.__exportStar(i(22378),t),a.__exportStar(i(32012),t),a.__exportStar(i(17432),t)},32012:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.modelConfigs=void 0,t.getModelConfig=r,t.optimizeForModel=function(e,t){let i=r(e),n=[],s=!1,l=t.prompt,d=t.negativePrompt||"";if(i.formatting.capitalizeFirst&&l.length>0){let e=l.charAt(0);e!==e.toUpperCase()&&(l=e.toUpperCase()+l.slice(1),s=!0)}for(let e of i.avoidKeywords){let t=RegExp(`\\b${e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}\\b`,"gi");t.test(l)&&(l=l.replace(t,"").replace(/,\s*,/g,",").trim(),n.push(`Removed "${e}" (not optimal for ${i.name})`),s=!0)}if(t.realismMode){let e=[],t=l.toLowerCase();for(let a of i.boostKeywords.slice(0,3))t.includes(a.toLowerCase())||e.push(a);e.length>0&&(l=l+i.formatting.separator+e.join(i.formatting.separator),n.push(`Added ${i.name} boost keywords`),s=!0)}if(l.length>i.maxPromptLength){let e=l.slice(0,i.maxPromptLength),t=e.lastIndexOf(",");l=t>.8*i.maxPromptLength?e.slice(0,t).trim():e.trim(),n.push(`Truncated prompt to ${i.maxPromptLength} chars for ${i.name}`),s=!0}if(i.supportsNegativePrompt){let e=[];for(let t of i.recommendedNegativeCategories)e.push(...a.negativePromptElements[t]);let t=new Set(d.split(",").map(e=>e.trim().toLowerCase())),r=[];for(let i of e)t.has(i.toLowerCase())||r.push(i);r.length>0&&(d=d?d+", "+r.join(", "):r.join(", "),n.push(`Enhanced negative prompt for ${i.name}`),s=!0)}l=o(l),d=o(d);let u=t.aspectRatio||i.recommendedAspectRatios[0];return{prompt:l,negativePrompt:d,parameters:{steps:i.defaultSteps,guidance:i.defaultGuidance,aspectRatio:u},notes:n,wasModified:s}},t.getRecommendedParameters=function(e,t){let i=r(e),a=(null==t?void 0:t.quality)||"balanced",o=i.defaultSteps;"fast"===a?o=Math.max(Math.floor(.6*o),4):"quality"===a&&(o=Math.ceil(1.3*o));let n=(null==t?void 0:t.aspectRatio)&&i.recommendedAspectRatios.includes(t.aspectRatio)?t.aspectRatio:i.recommendedAspectRatios[0];return{steps:o,guidance:i.defaultGuidance,aspectRatio:n}},t.checkModelCompatibility=function(e,t){let i=r(e),a=[],o=[],n=t.toLowerCase();for(let e of i.avoidKeywords)n.includes(e.toLowerCase())&&(a.push(`"${e}" may not work well with ${i.name}`),o.push(`Remove or replace "${e}"`));t.length>i.maxPromptLength&&(a.push(`Prompt exceeds recommended length for ${i.name} (${t.length}/${i.maxPromptLength})`),o.push("Shorten prompt or remove less important details"));let s=0;for(let e of i.boostKeywords)n.includes(e.toLowerCase())&&s++;return 0===s&&o.push(`Add ${i.name} optimized keywords like "${i.boostKeywords[0]}"`),{compatible:0===a.length,warnings:a,suggestions:o}},t.getSupportedModels=function(){return Object.keys(t.modelConfigs)},t.getModelSummaries=function(){return[{id:"flux-dev",name:"Flux Dev",description:"Best quality, highly photorealistic",speed:"medium"},{id:"z-image-turbo",name:"Z-Image Turbo",description:"Fast generation, great for realism",speed:"fast"},{id:"sdxl",name:"SDXL",description:"Versatile, good all-rounder",speed:"medium"}]};let a=i(48994);function r(e){return t.modelConfigs[e]||t.modelConfigs.default}function o(e){return e.replace(/,\s*,/g,",").replace(/^\s*,/,"").replace(/,\s*$/,"").replace(/\s+/g," ").trim()}t.modelConfigs={"flux-dev":{id:"flux-dev",name:"Flux Dev",description:"High-quality photorealistic model with strong prompt adherence",maxPromptLength:512,supportsNegativePrompt:!0,defaultSteps:28,defaultGuidance:3.5,recommendedAspectRatios:["1:1","4:5","9:16","16:9"],boostKeywords:["photorealistic","hyperrealistic","professional photography","high resolution","8k","detailed skin texture","natural lighting","sharp focus","masterpiece"],avoidKeywords:["cartoon","anime","illustration","painting","sketch","abstract","stylized"],formatting:{useNaturalLanguage:!0,separator:", ",capitalizeFirst:!0,addPeriod:!1},recommendedNegativeCategories:["anatomy","quality","face","faceAdvanced","skin","flux","aiArtifacts"]},"z-image-turbo":{id:"z-image-turbo",name:"Z-Image Turbo",description:"Fast, efficient model optimized for realism",maxPromptLength:384,supportsNegativePrompt:!0,defaultSteps:6,defaultGuidance:2,recommendedAspectRatios:["1:1","4:5","3:4"],boostKeywords:["realistic photograph","candid","natural","authentic","amateur photo","smartphone quality","genuine moment"],avoidKeywords:["digital art","CGI","render","3D","ultra detailed","maximum quality"],formatting:{useNaturalLanguage:!0,separator:", ",capitalizeFirst:!0,addPeriod:!1},recommendedNegativeCategories:["anatomy","quality","face","skin","flux","aiArtifacts"]},sdxl:{id:"sdxl",name:"Stable Diffusion XL",description:"Versatile model with good prompt adherence",maxPromptLength:256,supportsNegativePrompt:!0,defaultSteps:30,defaultGuidance:7,recommendedAspectRatios:["1:1","4:3","16:9"],boostKeywords:["best quality","masterpiece","highly detailed","sharp focus","professional photograph","cinematic lighting"],avoidKeywords:["worst quality","low quality","bad anatomy"],formatting:{useNaturalLanguage:!1,separator:", ",capitalizeFirst:!1,addPeriod:!1},recommendedNegativeCategories:["anatomy","quality","face","skin"]},default:{id:"default",name:"Default",description:"Generic configuration for unknown models",maxPromptLength:256,supportsNegativePrompt:!0,defaultSteps:25,defaultGuidance:5,recommendedAspectRatios:["1:1"],boostKeywords:["high quality","detailed","professional"],avoidKeywords:[],formatting:{useNaturalLanguage:!0,separator:", ",capitalizeFirst:!0,addPeriod:!1},recommendedNegativeCategories:["anatomy","quality","face"]}}},71018:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.profilePictureSets=t.naturalBeautySet=t.professionalModelSet=t.classicInfluencerSet=void 0,t.getProfilePictureSet=o,t.buildProfilePicturePrompt=function(e,t){let i=new a.PromptBuilder().withCharacter(e.characterDNA).withTemplate(e.basePromptTemplate).withGoldStandard().addDetails(t.angle,t.pose,t.expression,t.activity||"").addDetails(t.framing).forModel("flux-dev");t.lighting&&i.withLighting(t.lighting),t.scene&&i.withScene(t.scene),t.outfit&&i.withOutfit(t.outfit);let r=i.build();return{prompt:r.prompt,negativePrompt:r.negativePrompt}},t.getSetPositions=function(e){let t=o(e);return(null==t?void 0:t.positions)||[]},t.listProfilePictureSets=function(){return t.profilePictureSets};let a=i(6975),r=i(20787);function o(e){return t.profilePictureSets.find(t=>t.id===e)}t.classicInfluencerSet={id:"classic-influencer",name:"Classic Influencer",description:"Lifestyle profile pictures with activities - caf\xe9, beach, park with dog, gym, and more",characterDNA:r.characterDNATemplates.classicInfluencer,style:"Instagram influencer aesthetic",positions:[{id:"beach-full-body",name:"Beach Sunset Walk",angle:"front view, low angle",pose:"walking on beach barefoot, arms relaxed, hair blowing in wind, full body visible",expression:"happy carefree smile",framing:"full-body",aspectRatio:"9:16",poseId:"standing-walking",scene:"beach-sunset",environment:"outdoor",outfit:"casual",lighting:"golden-hour",activity:"walking along shoreline, ocean waves crashing, golden sunset light"},{id:"cafe-cross-legged",name:"Caf\xe9 Moment",angle:"three-quarter view",pose:"sitting cross-legged in cozy chair, holding coffee cup with both hands, leaning slightly forward",expression:"warm genuine smile, eyes to camera",framing:"medium",aspectRatio:"4:5",poseId:"sitting-cross",scene:"cozy-cafe",environment:"indoor",outfit:"casual",lighting:"natural-daylight",activity:"cozy caf\xe9 vibes, warm drinks, relaxed atmosphere"},{id:"gym-stretching",name:"Gym Stretch",angle:"side profile",pose:"standing stretching pose, one arm reaching up, athletic and graceful, full body visible",expression:"focused determined expression",framing:"full-body",aspectRatio:"9:16",poseId:"action-stretching",scene:"gym",environment:"indoor",outfit:"sportswear",lighting:"studio-softbox",activity:"pre-workout stretch, athletic wear, gym equipment visible"},{id:"rooftop-back-view",name:"City Sunset",angle:"back view, looking over shoulder",pose:"standing with back to camera, head turned looking over shoulder, city skyline visible",expression:"peaceful mysterious smile",framing:"full-body",aspectRatio:"9:16",poseId:"standing-casual",scene:"city-rooftop",environment:"outdoor",outfit:"casual",lighting:"sunset-glow",activity:"golden hour on rooftop, urban skyline panorama"},{id:"park-dancing",name:"Park Dance",angle:"front view",pose:"mid-dance twirl, arms gracefully extended, hair in motion, joyful movement",expression:"laughing joyful expression",framing:"full-body",aspectRatio:"9:16",poseId:"action-dancing",scene:"urban-park",environment:"outdoor",outfit:"casual",lighting:"natural-daylight",activity:"spontaneous dancing in park, carefree moment"},{id:"street-leaning",name:"Street Style",angle:"three-quarter view",pose:"casually leaning against wall, one foot up, hands in jacket pockets, relaxed cool pose",expression:"confident subtle smile",framing:"full-body",aspectRatio:"9:16",poseId:"standing-leaning",scene:"paris-street",environment:"urban",outfit:"casual",lighting:"natural-daylight",activity:"urban street style, architecture backdrop, effortlessly cool"},{id:"home-lounging",name:"Cozy Home",angle:"front view, slightly above",pose:"lounging on couch, legs tucked under, holding phone or book, comfortable relaxed pose",expression:"soft natural smile",framing:"medium",aspectRatio:"4:5",poseId:"sitting-lounging",scene:"luxury-bedroom",environment:"indoor",outfit:"casual",lighting:"soft-diffused",activity:"cozy home vibes, relaxing at home, comfortable setting"},{id:"pool-sitting-edge",name:"Pool Day",angle:"front view",pose:"sitting on pool edge, legs in water, leaning back on hands, sun-kissed relaxed pose",expression:"happy relaxed smile",framing:"full-body",aspectRatio:"9:16",poseId:"sitting-edge",scene:"pool-party",environment:"outdoor",outfit:"swimwear",lighting:"natural-daylight",activity:"summer pool day, water splashing, vacation vibes"}],basePromptTemplate:"{{character}}, {{angle}}, {{pose}}, {{expression}}, {{lighting}}, {{activity}}, Instagram aesthetic, high quality, detailed, professional photography, {{framing}}",negativePrompt:"blurry, deformed, ugly, bad anatomy, bad hands, missing fingers, extra fingers, watermark, signature, low quality, pixelated",tags:["influencer","instagram","lifestyle","activities","personality","starter"]},t.professionalModelSet={id:"professional-model",name:"Professional Model",description:"High-fashion editorial profile pictures - studio, gallery, boutique, runway, and more",characterDNA:r.characterDNATemplates.highFashionModel,style:"high fashion editorial",positions:[{id:"runway-walk",name:"Runway Walk",angle:"front view, low angle",pose:"confident runway walk, one foot forward, arms at sides, elongated posture, full body visible",expression:"fierce confident expression",framing:"full-body",aspectRatio:"9:16",poseId:"standing-walking",scene:"dark-studio",environment:"studio",outfit:"elegant",lighting:"studio-softbox",activity:"fashion runway walk, dramatic studio lighting, model strut"},{id:"studio-pose",name:"Studio Editorial",angle:"three-quarter view",pose:"standing with weight on one hip, hand on waist, other arm relaxed, elegant S-curve pose",expression:"sophisticated alluring expression",framing:"full-body",aspectRatio:"9:16",poseId:"standing-confident",scene:"white-studio",environment:"studio",outfit:"elegant",lighting:"studio-softbox",activity:"editorial fashion photography, clean minimalist backdrop"},{id:"gallery-side",name:"Gallery Profile",angle:"side profile",pose:"standing in profile, gazing at artwork, one arm gracefully raised, elegant silhouette",expression:"thoughtful contemplative look",framing:"full-body",aspectRatio:"9:16",poseId:"standing-elegant",scene:"art-gallery",environment:"indoor",outfit:"elegant",lighting:"dramatic-shadows",activity:"art gallery setting, contemporary art, sophisticated ambiance"},{id:"rooftop-dramatic",name:"Urban Editorial",angle:"back view, head turned",pose:"standing on rooftop, back to camera, head turned over shoulder, wind in hair, dramatic pose",expression:"mysterious alluring expression",framing:"full-body",aspectRatio:"9:16",poseId:"standing-casual",scene:"city-rooftop",environment:"outdoor",outfit:"elegant",lighting:"dramatic-shadows",activity:"high-fashion editorial, city skyline, dramatic urban backdrop"},{id:"sitting-elegant",name:"Magazine Cover",angle:"front view, slightly low",pose:"sitting elegantly on chair, legs crossed, leaning slightly forward, hands on knee",expression:"confident sophisticated expression",framing:"full-body",aspectRatio:"9:16",poseId:"sitting-perched",scene:"white-studio",environment:"studio",outfit:"elegant",lighting:"studio-softbox",activity:"magazine cover shoot, editorial styling, professional fashion"},{id:"street-strut",name:"Fashion Week",angle:"front view",pose:"walking confidently on city street, coat flowing, mid-stride, arms swinging naturally",expression:"editorial fierce expression",framing:"full-body",aspectRatio:"9:16",poseId:"standing-walking",scene:"paris-street",environment:"urban",outfit:"elegant",lighting:"natural-daylight",activity:"fashion week street style, paparazzi moment, designer outfit"},{id:"boutique-leaning",name:"Boutique Chic",angle:"three-quarter view",pose:"leaning against boutique mirror, one leg crossed over other, holding designer bag, relaxed elegant",expression:"sophisticated subtle smile",framing:"full-body",aspectRatio:"9:16",poseId:"standing-leaning",scene:"boutique-shop",environment:"indoor",outfit:"elegant",lighting:"soft-diffused",activity:"luxury shopping, designer boutique, high-end fashion"},{id:"studio-dynamic",name:"Dynamic Editorial",angle:"front view, action",pose:"mid-movement pose, fabric flowing, hair in motion, dynamic editorial pose, arms extended",expression:"intense powerful expression",framing:"full-body",aspectRatio:"9:16",poseId:"action-dancing",scene:"dark-studio",environment:"studio",outfit:"elegant",lighting:"dramatic-shadows",activity:"dynamic fashion editorial, movement shot, flowing garments"},{id:"close-up-beauty",name:"Beauty Editorial",angle:"front view, close",pose:"head slightly tilted, hand near face, editorial beauty pose",expression:"sultry captivating expression",framing:"close-up",aspectRatio:"1:1",poseId:"standing-confident",scene:"dark-studio",environment:"studio",outfit:"elegant",lighting:"dramatic-shadows",activity:"high-fashion beauty shot, flawless makeup, editorial styling"}],basePromptTemplate:"{{character}}, {{angle}}, {{pose}}, {{expression}}, {{lighting}}, {{activity}}, editorial fashion photography, high-end magazine quality, sophisticated, elegant, {{framing}}, professional studio lighting",negativePrompt:"casual, amateur, blurry, deformed, bad anatomy, bad hands, missing fingers, extra fingers, watermark, low quality, unprofessional",tags:["fashion","editorial","professional","sophisticated","fashion-scenes","starter"]},t.naturalBeautySet={id:"natural-beauty",name:"Natural Beauty",description:"Natural beauty profile pictures - garden, lake, forest, mountain, and nature scenes",characterDNA:r.characterDNATemplates.asianBeauty,style:"K-beauty aesthetic",positions:[{id:"yoga-pose",name:"Morning Yoga",angle:"side profile",pose:"standing yoga tree pose, one leg raised, arms above head, balanced graceful pose, full body visible",expression:"peaceful centered expression",framing:"full-body",aspectRatio:"9:16",poseId:"action-yoga",scene:"japanese-garden",environment:"outdoor",outfit:"sportswear",lighting:"natural-daylight",activity:"morning yoga in garden, zen atmosphere, mindful practice"},{id:"forest-stretching",name:"Forest Stretch",angle:"front view",pose:"standing with arms stretched wide, head tilted back, embracing nature, full body visible",expression:"joyful liberated expression",framing:"full-body",aspectRatio:"9:16",poseId:"action-stretching",scene:"forest-path",environment:"outdoor",outfit:"casual",lighting:"natural-daylight",activity:"connecting with nature, forest bathing, morning stretch"},{id:"lake-lying",name:"Lakeside Rest",angle:"overhead view",pose:"lying on blanket by lake, propped on elbows, legs extended, relaxed natural pose",expression:"serene peaceful smile",framing:"full-body",aspectRatio:"9:16",poseId:"sitting-lounging",scene:"lake-side",environment:"outdoor",outfit:"casual",lighting:"golden-hour",activity:"picnic by the lake, peaceful afternoon, nature immersion"},{id:"mountain-arms-up",name:"Mountain Peak",angle:"back view",pose:"standing on mountain, arms raised in victory pose, looking at vista, triumphant pose",expression:"joyful accomplished expression",framing:"full-body",aspectRatio:"9:16",poseId:"standing-casual",scene:"mountain-view",environment:"outdoor",outfit:"casual",lighting:"natural-daylight",activity:"reached summit, mountain hiking achievement, breathtaking view"},{id:"beach-walking-water",name:"Beach Wade",angle:"three-quarter view",pose:"walking in shallow water, holding dress hem up, splashing, full body visible",expression:"playful happy expression",framing:"full-body",aspectRatio:"9:16",poseId:"standing-walking",scene:"beach-day",environment:"outdoor",outfit:"casual",lighting:"golden-hour",activity:"wading in ocean, waves around ankles, carefree beach day"},{id:"garden-sitting-floor",name:"Garden Moment",angle:"front view",pose:"sitting cross-legged on grass, surrounded by flowers, hands resting on knees",expression:"natural genuine smile",framing:"medium",aspectRatio:"4:5",poseId:"sitting-cross",scene:"japanese-garden",environment:"outdoor",outfit:"casual",lighting:"natural-daylight",activity:"meditation in garden, cherry blossoms, peaceful moment"},{id:"reading-lying",name:"Cozy Reading",angle:"three-quarter view",pose:"lying on stomach on blanket, propped up on elbows, reading book, legs bent up behind",expression:"relaxed content expression",framing:"full-body",aspectRatio:"9:16",poseId:"sitting-lounging",scene:"urban-park",environment:"outdoor",outfit:"casual",lighting:"natural-daylight",activity:"reading in park, cozy blanket, peaceful afternoon"},{id:"sunrise-stretch",name:"Sunrise Yoga",angle:"side profile",pose:"standing forward bend, touching toes, flexible yoga stretch, full body silhouette",expression:"peaceful focused expression",framing:"full-body",aspectRatio:"9:16",poseId:"action-stretching",scene:"beach-sunset",environment:"outdoor",outfit:"sportswear",lighting:"golden-hour",activity:"sunrise yoga on beach, morning ritual, silhouette against sun"}],basePromptTemplate:"{{character}}, {{angle}}, {{pose}}, {{expression}}, {{lighting}}, {{activity}}, natural beauty, fresh clean look, minimal makeup, porcelain smooth skin, K-beauty aesthetic, {{framing}}, soft natural lighting",negativePrompt:"heavy makeup, airbrushed, plastic skin, blurry, deformed, bad anatomy, bad hands, missing fingers, extra fingers, watermark, low quality",tags:["beauty","natural","k-beauty","fresh","clean","nature-scenes","starter"]},t.profilePictureSets=[t.classicInfluencerSet,t.professionalModelSet,t.naturalBeautySet]},22378:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.scorePrompt=function(e){let t;let s={subjectClarity:0,specificity:0,realismPotential:0,tokenOrdering:0,negativePromptQuality:0,sceneContext:0,coherence:0,noConflicts:0},l=[],d=[],u=/\d{2}[\s-]?year[\s-]?old/i.test(e.prompt),c=/hair/i.test(e.prompt),p=/eyes/i.test(e.prompt),g=/skin/i.test(e.prompt);u&&(s.subjectClarity+=5),c&&(s.subjectClarity+=5),p&&(s.subjectClarity+=5),g&&(s.subjectClarity+=5),s.subjectClarity>=15?d.push("Good character description"):l.push("Add more character details (age, hair, eyes, skin)");let m=e.prompt.split(/\s+/).length,h=(e.prompt.match(/,/g)||[]).length;m>=30?s.specificity+=5:m>=20&&(s.specificity+=3),h>=5?s.specificity+=5:h>=3&&(s.specificity+=3),o(e.prompt,a)>=2?(s.specificity+=5,d.push("Good quality modifiers")):l.push("Add quality modifiers (detailed, high resolution, etc.)");let f=o(e.prompt,i);if(e.hasRealism&&(s.realismPotential+=8,d.push("Realism mode enabled")),f>=3?s.realismPotential+=7:f>=1?s.realismPotential+=4:e.hasRealism||l.push("Enable realism mode or add realistic keywords"),o(e.prompt,r)>0&&(s.realismPotential=Math.max(0,s.realismPotential-3),l.push('Remove "perfect/flawless" terms that create AI look')),n(e.prompt)?(s.tokenOrdering+=10,d.push("Subject-first token ordering")):l.push("Start prompt with character description"),e.hasExpression&&(s.tokenOrdering+=2),e.hasPose&&(s.tokenOrdering+=3),e.negativePrompt){let t=e.negativePrompt.split(/,/).length;t>=15?(s.negativePromptQuality+=10,d.push("Comprehensive negative prompt")):t>=10?s.negativePromptQuality+=7:t>=5?s.negativePromptQuality+=4:l.push("Expand negative prompt with more terms"),/plastic|airbrushed|waxy|uncanny/i.test(e.negativePrompt)&&(s.negativePromptQuality=Math.min(10,s.negativePromptQuality+2))}else l.push("Add a negative prompt");e.hasContextEnhancement&&(s.sceneContext+=8,d.push("Context enhancement enabled")),e.hasScene?s.sceneContext+=2:l.push("Specify a scene/environment");let y=e.coherenceWarnings||0;0===y?(s.coherence=10,d.push("Good element coherence")):1===y?s.coherence=6:2===y?s.coherence=3:l.push("Fix coherence issues between elements"),function(e){let t=e.toLowerCase();for(let[e,i]of[["bright","dark"],["indoor","outdoor"],["day","night"],["smiling","frowning"],["happy","sad"],["relaxed","tense"]])if(t.includes(e)&&t.includes(i))return!0;return!1}(e.prompt)?l.push("Remove conflicting terms in prompt"):s.noConflicts=5;let v=s.subjectClarity+s.specificity+s.realismPotential+s.tokenOrdering+s.negativePromptQuality+s.sceneContext+s.coherence+s.noConflicts;return t=v>=85?"A":v>=70?"B":v>=55?"C":v>=40?"D":"F",{overall:v,grade:t,breakdown:s,suggestions:l.slice(0,5),strengths:d}},t.getQuickRating=function(e){let t=e.split(/\s+/).length,r=o(e,i)>0,s=o(e,a)>0,l=n(e),d=0;return t>=30?d+=25:t>=20&&(d+=15),r&&(d+=25),s&&(d+=25),l&&(d+=25),{rating:d>=75?"excellent":d>=50?"good":d>=25?"fair":"poor",score:d}},t.formatScoreDisplay=function(e){let t=[`Quality Score: ${e.overall}/100 (${e.grade})`,"","Breakdown:",`  Subject Clarity: ${e.breakdown.subjectClarity}/20`,`  Specificity: ${e.breakdown.specificity}/15`,`  Realism: ${e.breakdown.realismPotential}/15`,`  Token Order: ${e.breakdown.tokenOrdering}/15`,`  Negative Prompt: ${e.breakdown.negativePromptQuality}/10`,`  Scene Context: ${e.breakdown.sceneContext}/10`,`  Coherence: ${e.breakdown.coherence}/10`,`  No Conflicts: ${e.breakdown.noConflicts}/5`];return e.strengths.length>0&&(t.push("","Strengths:"),e.strengths.forEach(e=>t.push(`   ${e}`))),e.suggestions.length>0&&(t.push("","Suggestions:"),e.suggestions.forEach(e=>t.push(`   ${e}`))),t.join("\n")};let i=["amateur photo","candid","natural skin","authentic","raw unedited","smartphone","natural imperfections","skin texture","pores","realistic"],a=["detailed","high resolution","8k","professional","masterpiece","best quality"],r=["perfect","flawless","porcelain","smooth skin","airbrushed"];function o(e,t){let i=e.toLowerCase();return t.filter(e=>i.includes(e.toLowerCase())).length}function n(e){let t=e.toLowerCase(),i=/^\d{2}[\s-]?year[\s-]?old/i.test(e.trim()),a=t.startsWith("a ")||t.startsWith("photo of")||t.startsWith("portrait of")||t.startsWith("close-up");return i||a}},18308:function(e,t){function i(e){return t.promptTemplates.filter(t=>t.category===e)}Object.defineProperty(t,"__esModule",{value:!0}),t.promptTemplates=void 0,t.getTemplatesByCategory=i,t.getTemplatesByTag=function(e){return t.promptTemplates.filter(t=>t.tags.includes(e))},t.getTemplatesByRating=function(e){return t.promptTemplates.filter(t=>t.rating===e)},t.getTemplateById=function(e){return t.promptTemplates.find(t=>t.id===e)},t.getRandomTemplate=function(e){let a=e?i(e):t.promptTemplates;return a[Math.floor(Math.random()*a.length)]},t.promptTemplates=[{id:"portrait-selfie-casual",category:"portrait",subcategory:"selfie",name:"Casual Selfie",description:"Instagram-style casual selfie portrait",template:"{{character}}, close-up selfie, {{expression}}, looking at camera, {{lighting}}, Shot on Fujifilm GFX 100S, 80mm lens, f/2.8, shallow depth of field, natural background bokeh, natural skin texture with visible pores, candid moment, Instagram aesthetic",negativePrompt:"blurry, deformed, ugly, bad anatomy, bad hands, missing fingers, extra fingers, watermark, signature, plastic skin, airbrushed, uncanny valley, CGI, illustration, smooth polygons, waxy texture",requiredDNA:["age","hair","eyes","skin"],tags:["selfie","casual","instagram","portrait"],rating:"sfw",recommendedWorkflow:"z-image-danrisi",aspectRatio:"1:1"},{id:"portrait-close-up-beauty",category:"portrait",subcategory:"beauty",name:"Beauty Close-up",description:"High-detail beauty/makeup portrait",template:"{{character}}, close-up beauty portrait, {{expression}}, natural skin texture with visible pores, follicular detail, tear-film reflections, detailed eyes with wet mucosa, subsurface scattering, {{lighting}}, professional beauty photography, authentic complexion, Shot on Fujifilm GFX 100S, sharp focus",negativePrompt:"plastic skin, flat lighting, blurry, deformed, bad makeup, unnatural colors, airbrushed perfection, waxy appearance, uncanny valley, CGI, porcelain doll effect, excessive smoothing",requiredDNA:["age","hair","eyes","skin","facialFeatures"],tags:["beauty","close-up","professional","makeup"],rating:"sfw",recommendedWorkflow:"z-image-danrisi",aspectRatio:"4:5"},{id:"portrait-headshot-professional",category:"portrait",subcategory:"professional",name:"Professional Headshot",description:"LinkedIn/professional headshot style",template:"Professional headshot of {{character}}, business attire, neutral background, confident {{expression}}, corporate photography style, soft studio lighting",negativePrompt:"casual clothes, messy hair, unprofessional, distracting background",requiredDNA:["age","hair","eyes","skin"],tags:["professional","headshot","business","corporate"],rating:"sfw",recommendedWorkflow:"z-image-simple",aspectRatio:"1:1"},{id:"portrait-profile-artistic",category:"portrait",subcategory:"artistic",name:"Artistic Side Profile",description:"Dramatic side profile portrait",template:"{{character}}, side profile view, dramatic {{lighting}}, artistic photography, moody atmosphere, cinematic composition, {{expression}}",negativePrompt:"frontal view, flat lighting, boring composition",requiredDNA:["age","hair","eyes","skin","facialFeatures"],tags:["artistic","profile","dramatic","cinematic"],rating:"sfw",recommendedWorkflow:"z-image-danrisi",aspectRatio:"3:4"},{id:"fullbody-standing-casual",category:"fullbody",subcategory:"standing",name:"Casual Standing Pose",description:"Full body casual standing pose",template:"{{character}}, full-body shot, relaxed casual standing pose, {{outfit}}, {{scene}}, {{lighting}}, amateur photo camera style, natural imperfections, candid moment",negativePrompt:"cropped body, missing limbs, deformed proportions, bad hands, bad feet, plastic skin, airbrushed, CGI, illustration, uncanny valley",requiredDNA:["age","hair","eyes","skin","bodyType"],tags:["fullbody","standing","casual","lifestyle"],rating:"sfw",recommendedWorkflow:"z-image-danrisi",aspectRatio:"9:16"},{id:"fullbody-sitting-relaxed",category:"fullbody",subcategory:"sitting",name:"Relaxed Sitting Pose",description:"Natural sitting position",template:"Full-body shot of {{character}}, {{outfit}}, sitting comfortably in {{scene}}, relaxed natural pose, looking at camera, {{lighting}}",negativePrompt:"awkward pose, unnatural position, cropped, missing limbs, bad proportions",requiredDNA:["age","hair","eyes","skin","bodyType"],tags:["fullbody","sitting","relaxed","natural"],rating:"sfw",recommendedWorkflow:"z-image-danrisi",aspectRatio:"4:5"},{id:"lifestyle-coffee-shop",category:"lifestyle",subcategory:"daily",name:"Coffee Shop Moment",description:"Influencer at a trendy coffee shop",template:"{{character}}, {{expression}}, sitting at trendy coffee shop, holding latte cup, {{outfit}}, cozy warm atmosphere, natural window light, amateur photo camera style, Instagram aesthetic, candid authentic moment",negativePrompt:"empty cafe, bad lighting, blurry background, awkward pose, plastic skin, airbrushed, CGI, illustration, stock photo look",requiredDNA:["age","hair","eyes","skin"],tags:["lifestyle","coffee","cafe","instagram","daily"],rating:"sfw",recommendedWorkflow:"z-image-danrisi",aspectRatio:"4:5"},{id:"lifestyle-beach-sunset",category:"lifestyle",subcategory:"travel",name:"Beach Sunset",description:"Golden hour beach scene",template:"{{character}}, {{outfit}}, walking on sandy beach at sunset, golden hour lighting, ocean waves in background, wind in hair, peaceful expression, travel photography",negativePrompt:"crowded beach, bad weather, flat lighting, stiff pose",requiredDNA:["age","hair","eyes","skin","bodyType"],tags:["lifestyle","beach","sunset","travel","golden_hour"],rating:"sfw",recommendedWorkflow:"z-image-danrisi",aspectRatio:"9:16"},{id:"lifestyle-home-cozy",category:"lifestyle",subcategory:"home",name:"Cozy Home Moment",description:"Relaxing at home aesthetic",template:"{{character}}, comfortable loungewear, relaxing at home on a cozy couch, soft blankets, warm ambient lighting, reading a book, peaceful atmosphere",negativePrompt:"messy room, harsh lighting, stiff pose, unnatural",requiredDNA:["age","hair","eyes","skin"],tags:["lifestyle","home","cozy","relaxing","indoor"],rating:"sfw",recommendedWorkflow:"z-image-simple",aspectRatio:"4:5"},{id:"lifestyle-urban-street",category:"lifestyle",subcategory:"urban",name:"Urban Street Style",description:"City street photography aesthetic",template:"{{character}}, {{outfit}}, walking on busy city street, urban background, street photography style, confident stride, natural daylight",negativePrompt:"empty street, rural setting, awkward walking pose, blurry",requiredDNA:["age","hair","eyes","skin","bodyType"],tags:["lifestyle","urban","street","city","walking"],rating:"sfw",recommendedWorkflow:"z-image-danrisi",aspectRatio:"9:16"},{id:"fashion-ootd-mirror",category:"fashion",subcategory:"ootd",name:"OOTD Mirror Selfie",description:"Outfit of the day mirror selfie",template:"{{character}}, {{outfit}}, mirror selfie in bedroom, full outfit visible, holding phone, natural lighting from window, OOTD aesthetic, Instagram fashion",negativePrompt:"messy room, bad mirror, phone covering face, cropped outfit",requiredDNA:["age","hair","eyes","skin","bodyType"],tags:["fashion","ootd","mirror","selfie","outfit"],rating:"sfw",recommendedWorkflow:"z-image-danrisi",aspectRatio:"9:16"},{id:"fashion-runway-pose",category:"fashion",subcategory:"editorial",name:"Editorial Fashion Pose",description:"High fashion editorial style",template:"{{character}}, high fashion {{outfit}}, editorial photography, dramatic pose, studio lighting with shadows, fashion magazine aesthetic, confident expression",negativePrompt:"casual pose, amateur lighting, everyday clothes, boring background",requiredDNA:["age","hair","eyes","skin","bodyType","facialFeatures"],tags:["fashion","editorial","high-fashion","studio","dramatic"],rating:"sfw",recommendedWorkflow:"z-image-danrisi",aspectRatio:"3:4"},{id:"fashion-summer-dress",category:"fashion",subcategory:"casual",name:"Summer Dress Look",description:"Light summer outfit photography",template:"{{character}}, wearing a flowing summer dress, standing in a garden with flowers, soft natural lighting, gentle breeze, happy relaxed expression, summer vibes",negativePrompt:"winter clothes, indoor setting, harsh lighting, stiff pose",requiredDNA:["age","hair","eyes","skin","bodyType"],tags:["fashion","summer","dress","outdoor","garden"],rating:"sfw",recommendedWorkflow:"z-image-danrisi",aspectRatio:"4:5"},{id:"fashion-swimwear-beach",category:"fashion",subcategory:"swimwear",name:"Beach Swimwear",description:"Tasteful swimwear photography",template:"{{character}}, wearing a stylish {{outfit}}, standing on tropical beach, turquoise water background, golden hour lighting, confident pose, vacation vibes",negativePrompt:"crowded beach, bad weather, unflattering angle, cheap swimsuit",requiredDNA:["age","hair","eyes","skin","bodyType"],tags:["fashion","swimwear","beach","summer","vacation"],rating:"suggestive",recommendedWorkflow:"z-image-danrisi",aspectRatio:"9:16"},{id:"fitness-gym-workout",category:"fitness",subcategory:"gym",name:"Gym Workout",description:"Active gym workout scene",template:"{{character}}, athletic wear, working out in modern gym, using fitness equipment, determined expression, slight sweat, motivational fitness photography",negativePrompt:"lazy pose, bad form, dirty gym, unflattering angle",requiredDNA:["age","hair","eyes","skin","bodyType"],tags:["fitness","gym","workout","athletic","motivation"],rating:"sfw",recommendedWorkflow:"z-image-danrisi",aspectRatio:"4:5"},{id:"fitness-yoga-pose",category:"fitness",subcategory:"yoga",name:"Yoga Session",description:"Peaceful yoga practice",template:"{{character}}, yoga outfit, performing yoga pose on mat, serene outdoor setting, morning sunlight, peaceful expression, wellness aesthetic",negativePrompt:"bad form, indoor gym, harsh lighting, stressed expression",requiredDNA:["age","hair","eyes","skin","bodyType"],tags:["fitness","yoga","wellness","outdoor","peaceful"],rating:"sfw",recommendedWorkflow:"z-image-danrisi",aspectRatio:"1:1"},{id:"fitness-progress-mirror",category:"fitness",subcategory:"progress",name:"Fitness Progress Mirror",description:"Gym mirror selfie showing progress",template:"{{character}}, sports bra and leggings, gym mirror selfie, showing toned physique, good lighting, motivational fitness content, proud expression",negativePrompt:"messy gym, bad lighting, phone covering face, unprofessional",requiredDNA:["age","hair","eyes","skin","bodyType"],tags:["fitness","progress","mirror","motivation","gym"],rating:"suggestive",recommendedWorkflow:"z-image-danrisi",aspectRatio:"9:16"},{id:"social-tiktok-reaction",category:"social_media",subcategory:"tiktok",name:"TikTok Reaction Face",description:"Expressive reaction for TikTok content",template:"{{character}}, casual outfit, exaggerated surprised expression, hand gesture, bright colorful background, TikTok aesthetic, energetic vibe, ring light lighting",negativePrompt:"boring expression, dull background, stiff pose, bad lighting",requiredDNA:["age","hair","eyes","skin"],tags:["social","tiktok","reaction","expressive","fun"],rating:"sfw",recommendedWorkflow:"z-image-simple",aspectRatio:"9:16"},{id:"social-instagram-story",category:"social_media",subcategory:"instagram",name:"Instagram Story Candid",description:"Casual candid for Instagram stories",template:"{{character}}, casual everyday outfit, candid moment, looking slightly away from camera, natural lighting, authentic Instagram story aesthetic, lifestyle moment",negativePrompt:"posed, fake smile, studio lighting, overly edited look",requiredDNA:["age","hair","eyes","skin"],tags:["social","instagram","story","candid","authentic"],rating:"sfw",recommendedWorkflow:"z-image-simple",aspectRatio:"9:16"},{id:"artistic-neon-portrait",category:"artistic",subcategory:"neon",name:"Neon Lit Portrait",description:"Dramatic neon lighting portrait",template:"{{character}}, dramatic neon lighting in pink and blue, urban night setting, cyberpunk aesthetic, moody atmosphere, artistic portrait photography",negativePrompt:"daylight, natural colors, bright happy mood, boring lighting",requiredDNA:["age","hair","eyes","skin","facialFeatures"],tags:["artistic","neon","cyberpunk","night","dramatic"],rating:"sfw",recommendedWorkflow:"z-image-danrisi",aspectRatio:"3:4"},{id:"artistic-golden-hour",category:"artistic",subcategory:"golden_hour",name:"Golden Hour Portrait",description:"Warm golden hour lighting",template:"{{character}}, bathed in golden hour sunlight, outdoor setting, warm color palette, dreamy atmosphere, lens flare, artistic portrait photography",negativePrompt:"harsh midday sun, indoor, cold colors, flat lighting",requiredDNA:["age","hair","eyes","skin"],tags:["artistic","golden_hour","warm","outdoor","dreamy"],rating:"sfw",recommendedWorkflow:"z-image-danrisi",aspectRatio:"4:5"},{id:"artistic-film-noir",category:"artistic",subcategory:"noir",name:"Film Noir Style",description:"Classic film noir aesthetic",template:"{{character}}, black and white photography, film noir lighting with dramatic shadows, mysterious expression, vintage aesthetic, cinematic portrait",negativePrompt:"colorful, bright lighting, happy expression, modern setting",requiredDNA:["age","hair","eyes","skin","facialFeatures"],tags:["artistic","noir","black_white","vintage","cinematic"],rating:"sfw",recommendedWorkflow:"z-image-danrisi",aspectRatio:"3:4"}]},94750:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},46236:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},17561:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.CardService=void 0;let a=i(35914);class r{constructor(e,t){this.db=e,this.paymentRepo=t}saveCard(e){return a.__awaiter(this,void 0,void 0,function*(){let t=yield this.paymentRepo.findCardByHash(e.userId,e.cardHash);if(t)return t;let i=0===(yield this.paymentRepo.getUserCards(e.userId)).length||!0===e.isDefault;if(i){let t=yield this.paymentRepo.getDefaultCard(e.userId);t&&(yield this.paymentRepo.updateCard(t.id,{isDefault:!1}))}let a={userId:e.userId,cardHash:e.cardHash,last4:e.last4,cardType:e.cardType,expiryDate:e.expiryDate,isDefault:i};return yield this.paymentRepo.saveCard(a)})}getUserCards(e){return a.__awaiter(this,void 0,void 0,function*(){return yield this.paymentRepo.getUserCards(e)})}getDefaultCard(e){return a.__awaiter(this,void 0,void 0,function*(){return yield this.paymentRepo.getDefaultCard(e)})}getCardById(e){return a.__awaiter(this,void 0,void 0,function*(){return yield this.paymentRepo.getCardById(e)})}setDefaultCard(e,t){return a.__awaiter(this,void 0,void 0,function*(){yield this.paymentRepo.setDefaultCard(e,t)})}deleteCard(e){return a.__awaiter(this,void 0,void 0,function*(){yield this.paymentRepo.deleteCard(e)})}updateCard(e,t){return a.__awaiter(this,void 0,void 0,function*(){return yield this.paymentRepo.updateCard(e,t)})}}t.CardService=r},61519:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.ComfyUIErrorHandlerService=void 0;let a=i(35914),r=i(688);class o{constructor(e){var t,i,a,r;this.maxRetries=null!==(t=null==e?void 0:e.maxRetries)&&void 0!==t?t:3,this.backoffBase=null!==(i=null==e?void 0:e.backoffBase)&&void 0!==i?i:1e3,this.backoffMax=null!==(a=null==e?void 0:e.backoffMax)&&void 0!==a?a:16e3,this.healthCheckTimeout=null!==(r=null==e?void 0:e.healthCheckTimeout)&&void 0!==r?r:2e3}shouldRetry(e){let t=this.categorizeError(e);return t===r.ErrorCategory.TRANSIENT||t===r.ErrorCategory.RECOVERABLE}getRetryDelay(e){return Math.round(Math.min(this.backoffBase*Math.pow(2,e-1),this.backoffMax))}checkHealth(e){return a.__awaiter(this,void 0,void 0,function*(){try{let t=new AbortController,i=setTimeout(()=>t.abort(),this.healthCheckTimeout),a=yield fetch(`${e}/system_stats`,{method:"GET",signal:t.signal});return clearTimeout(i),a.ok}catch(t){return console.warn(`Health check failed for ${e}: ${t}`),!1}})}categorizeError(e){let t=e.message.toLowerCase(),i=e.name.toLowerCase();return i.includes("network")||i.includes("timeout")||i.includes("econnrefused")||i.includes("etimedout")||t.includes("fetch failed")||t.includes("network error")||t.includes("500")||t.includes("502")||t.includes("503")||t.includes("504")?r.ErrorCategory.TRANSIENT:t.includes("400")||t.includes("401")||t.includes("403")||t.includes("404")||t.includes("422")||t.includes("validation")?r.ErrorCategory.PERMANENT:t.includes("node timeout")||t.includes("execution timeout")?r.ErrorCategory.RECOVERABLE:t.includes("workflow")&&(t.includes("invalid")||t.includes("validation"))?r.ErrorCategory.FATAL:r.ErrorCategory.TRANSIENT}getFallbackStrategy(e){let t=e.message.toLowerCase();return t.includes("websocket")||t.includes("ws")?{method:"websocket_to_rest",reason:"WebSocket connection failed"}:t.includes("model")||t.includes("checkpoint")?{method:"primary_to_secondary",reason:"Primary model unavailable"}:t.includes("workflow")||t.includes("node")?{method:"optimized_to_simple",reason:"Optimized workflow failed"}:null}executeWithRetry(e,t,i){return a.__awaiter(this,void 0,void 0,function*(){let a=null;for(let r=1;r<=this.maxRetries;r++)try{if(r>1&&!(yield this.checkHealth(t)))throw Error("Server health check failed");return yield e()}catch(t){if(a=t instanceof Error?t:Error(String(t)),!this.shouldRetry(a)||r===this.maxRetries)throw a;let e=this.getRetryDelay(r);i&&i(r,a),console.log(`Retry attempt ${r}/${this.maxRetries} after ${e}ms for error: ${a.message}`),yield new Promise(t=>setTimeout(t,e))}throw a||Error("Max retries exceeded")})}}t.ComfyUIErrorHandlerService=o},72257:function(e,t,i){var a=i(72164);Object.defineProperty(t,"__esModule",{value:!0}),t.ComfyUIJobPersistenceService=void 0,t.createComfyUIJobPersistenceService=function(){let e;let t=a.env.REDIS_URL;if(t)try{let i=new URL(t),a=Number(i.port)||6379,r=i.hostname,n="";i.username&&i.password?n=i.password:i.password?n=i.password:i.username&&!i.password&&(n=i.username),e=new o.default(t.startsWith("rediss://")||r.includes("upstash.io")?{port:a,host:r,password:n||void 0,tls:{rejectUnauthorized:!1},lazyConnect:!0}:{port:a,host:r,password:n||void 0,lazyConnect:!0})}catch(t){console.warn("Failed to parse REDIS_URL, using individual variables:",t),e=new o.default({port:Number(a.env.REDIS_PORT)||6379,host:a.env.REDIS_HOST||"localhost",password:a.env.REDIS_PASSWORD||void 0,lazyConnect:!0})}else e=new o.default({port:Number(a.env.REDIS_PORT)||6379,host:a.env.REDIS_HOST||"localhost",password:a.env.REDIS_PASSWORD||void 0,lazyConnect:!0});return new n({redisClient:e})};let r=i(35914),o=r.__importDefault(i(Object(function(){var e=Error("Cannot find module 'ioredis'");throw e.code="MODULE_NOT_FOUND",e}())));class n{constructor(e){this.redisClient=e.redisClient,this.keyPrefix=e.keyPrefix||"comfyui:job:",this.ttl=e.ttl||7200,this.maxRecoveryAge=e.maxRecoveryAge||600}getJobKey(e){return`${this.keyPrefix}${e}`}saveJobState(e){return r.__awaiter(this,void 0,void 0,function*(){let t=this.getJobKey(e.promptId),i=JSON.stringify(e);yield this.redisClient.set(t,i,"EX",this.ttl),console.log(`Saved job state for ${e.promptId} to Redis`)})}updateJobState(e,t){return r.__awaiter(this,void 0,void 0,function*(){let i=yield this.getJobState(e);if(!i){console.warn(`Job state not found for ${e}, cannot update`);return}let a=Object.assign(Object.assign(Object.assign({},i),t),{promptId:e});yield this.saveJobState(a)})}getJobState(e){return r.__awaiter(this,void 0,void 0,function*(){let t=this.getJobKey(e),i=yield this.redisClient.get(t);if(!i)return null;try{return JSON.parse(i)}catch(t){return console.error(`Failed to parse job state for ${e}: ${t}`),null}})}deleteJobState(e){return r.__awaiter(this,void 0,void 0,function*(){let t=this.getJobKey(e);yield this.redisClient.del(t),console.log(`Deleted job state for ${e} from Redis`)})}recoverActiveJobs(){return r.__awaiter(this,void 0,void 0,function*(){let e=`${this.keyPrefix}*`,t=yield this.redisClient.keys(e),i=Date.now(),a=[];for(let e of t)try{let t=yield this.redisClient.get(e);if(!t)continue;let r=JSON.parse(t),o=(i-r.startedAt)/1e3;if(o>this.maxRecoveryAge){console.log(`Skipping job ${r.promptId} (age: ${Math.round(o)}s, max: ${this.maxRecoveryAge}s)`);continue}("processing"===r.status||"queued"===r.status)&&(a.push(r),console.log(`Recovered job ${r.promptId} (age: ${Math.round(o)}s)`))}catch(t){console.error(`Failed to recover job from key ${e}: ${t}`)}return a})}cleanupStaleJobs(){return r.__awaiter(this,void 0,void 0,function*(){let e=`${this.keyPrefix}*`,t=yield this.redisClient.keys(e),i=Date.now(),a=0;for(let e of t)try{let t=yield this.redisClient.get(e);if(!t)continue;let r=JSON.parse(t),o=(i-r.startedAt)/1e3;o>this.ttl&&(yield this.redisClient.del(e),a++,console.log(`Cleaned up stale job ${r.promptId} (age: ${Math.round(o)}s)`))}catch(t){console.error(`Failed to check job from key ${e}: ${t}`)}return a})}isAvailable(){return r.__awaiter(this,void 0,void 0,function*(){try{return yield this.redisClient.ping(),!0}catch(e){return!1}})}}t.ComfyUIJobPersistenceService=n},42058:function(e,t,i){var a=i(72164);Object.defineProperty(t,"__esModule",{value:!0}),t.ComfyUIJobRunner=void 0,t.createComfyUIJobRunner=function(){return r.__awaiter(this,void 0,void 0,function*(){let e;let t=a.env.COMFYUI_POD_URL;if(!t)throw Error("COMFYUI_POD_URL environment variable is required");let n=new o.ComfyUIPodClient({baseUrl:t});try{let{createComfyUIJobPersistenceService:t}=yield Promise.resolve().then(()=>r.__importStar(i(72257)));e=t(),(yield e.isAvailable())||(console.warn("Redis not available, job persistence disabled"),e=void 0)}catch(t){console.warn("Failed to create job persistence service:",t),e=void 0}return new s({comfyui:n,persistenceService:e})})};let r=i(35914),o=i(77565),n=i(91905);class s{constructor(e){this.pendingJobs=new Map,this.availableNodes=[],e instanceof o.ComfyUIPodClient?this.comfyui=e:(this.comfyui=e.comfyui,this.persistenceService=e.persistenceService),this.recoverJobs()}initialize(){return r.__awaiter(this,void 0,void 0,function*(){try{this.availableNodes=yield this.comfyui.getAvailableNodes(),console.log(`ComfyUIJobRunner initialized with ${this.availableNodes.length} available nodes`)}catch(e){console.warn("Failed to fetch available nodes, using default workflow selection"),this.availableNodes=[]}})}submitBaseImages(e){return r.__awaiter(this,void 0,void 0,function*(){let t=e.nsfw?"deformed, blurry, bad anatomy, ugly, low quality":"deformed, blurry, bad anatomy, ugly, low quality, nsfw, nude, naked";return this.submitBaseImageWithWorkflow({prompt:e.prompt,negativePrompt:t,nsfw:e.nsfw,seed:e.seed,width:1024,height:1024})})}submitBaseImageWithWorkflow(e,t){return r.__awaiter(this,void 0,void 0,function*(){var i,a,r,o;let s=e.workflowId||(0,n.getRecommendedWorkflow)(this.availableNodes),l=null!==(i=e.negativePrompt)&&void 0!==i?i:e.nsfw?"deformed, blurry, bad anatomy, ugly, low quality":"deformed, blurry, bad anatomy, ugly, low quality, nsfw, nude, naked",d=(0,n.buildWorkflow)(s,{prompt:e.prompt,negativePrompt:l,width:null!==(a=e.width)&&void 0!==a?a:1024,height:null!==(r=e.height)&&void 0!==r?r:1024,steps:e.steps,cfg:e.cfg,seed:null!==(o=e.seed)&&void 0!==o?o:Math.floor(1e6*Math.random()),filenamePrefix:"ryla_gen"});if(t){let e=(yield this.comfyui.executeWorkflow(d,2e3,t)).promptId;return this.pendingJobs.set(e,{promptId:e,type:"base_image",workflow:s,startedAt:new Date}),console.log(`Job ${e} completed with workflow: ${s}`),e}let u=yield this.comfyui.queueWorkflow(d);if(this.pendingJobs.set(u,{promptId:u,type:"base_image",workflow:s,startedAt:new Date}),this.persistenceService){let e=this.comfyui.getBaseUrl();yield this.persistenceService.saveJobState({promptId:u,type:"image_generation",userId:"",status:"queued",progress:0,startedAt:Date.now(),serverUrl:e})}return console.log(`Job ${u} queued with workflow: ${s}`),u})}submitFromBuiltPrompt(e,t){return r.__awaiter(this,void 0,void 0,function*(){var i;let a=(null==t?void 0:t.workflowId)||e.recommended.workflow||(0,n.getRecommendedWorkflow)(this.availableNodes);return this.submitBaseImageWithWorkflow({prompt:e.prompt,negativePrompt:e.negativePrompt,nsfw:null!==(i=null==t?void 0:t.nsfw)&&void 0!==i&&i,seed:null==t?void 0:t.seed,workflowId:a})})}submitFaceSwap(e){return r.__awaiter(this,void 0,void 0,function*(){return console.warn("Face swap workflow not yet implemented, using base image generation"),this.submitBaseImageWithWorkflow({prompt:e.prompt+", portrait, face close-up",nsfw:e.nsfw,seed:e.seed})})}submitCharacterSheet(e){return r.__awaiter(this,void 0,void 0,function*(){return console.warn("Character sheet workflow not yet implemented, using single portrait generation"),this.submitBaseImageWithWorkflow({prompt:"Character portrait, professional photography, high quality, detailed, studio lighting",nsfw:e.nsfw})})}getJobStatus(e){return r.__awaiter(this,void 0,void 0,function*(){try{let t=yield this.comfyui.getJobStatus(e);return this.mapComfyUIStatus(t)}catch(e){return{status:"FAILED",error:e instanceof Error?e.message:"Unknown error"}}})}mapComfyUIStatus(e){switch(e.status){case"queued":return{status:"IN_QUEUE"};case"processing":default:return{status:"IN_PROGRESS"};case"completed":return{status:"COMPLETED",output:{images:e.images,prompt_id:e.promptId}};case"failed":return{status:"FAILED",error:e.error}}}healthCheck(){return r.__awaiter(this,void 0,void 0,function*(){return this.comfyui.healthCheck()})}getPendingJobCount(){return this.pendingJobs.size}cleanupStaleJobs(){let e=new Date(Date.now()-6e5),t=0;for(let[i,a]of this.pendingJobs.entries())a.startedAt<e&&(this.pendingJobs.delete(i),this.persistenceService&&this.persistenceService.deleteJobState(i).catch(e=>{console.warn(`Failed to delete job state for ${i}: ${e}`)}),t++);return t}recoverJobs(){return r.__awaiter(this,void 0,void 0,function*(){if(this.persistenceService)try{if(!(yield this.persistenceService.isAvailable())){console.warn("Redis not available, skipping job recovery");return}let e=yield this.persistenceService.recoverActiveJobs();for(let t of(console.log(`Recovered ${e.length} active jobs from Redis`),e)){let e="base_image";"face_swap"===t.type?e="face_swap":"character_sheet"===t.type&&(e="character_sheet"),this.pendingJobs.set(t.promptId,{promptId:t.promptId,type:e,workflow:"z-image-simple",startedAt:new Date(t.startedAt)})}}catch(e){console.error(`Failed to recover jobs: ${e}`)}})}updateJobProgress(e,t){return r.__awaiter(this,void 0,void 0,function*(){this.persistenceService&&(yield this.persistenceService.updateJobState(e,{progress:t,status:"processing"}))})}markJobCompleted(e){return r.__awaiter(this,void 0,void 0,function*(){this.persistenceService&&(yield this.persistenceService.updateJobState(e,{status:"completed",progress:100}),setTimeout(()=>{this.persistenceService.deleteJobState(e).catch(t=>{console.warn(`Failed to delete completed job state for ${e}: ${t}`)})},6e4))})}markJobFailed(e,t){return r.__awaiter(this,void 0,void 0,function*(){this.persistenceService&&(yield this.persistenceService.updateJobState(e,{status:"failed"}),setTimeout(()=>{this.persistenceService.deleteJobState(e).catch(t=>{console.warn(`Failed to delete failed job state for ${e}: ${t}`)})},6e4))})}}t.ComfyUIJobRunner=s},77565:function(e,t,i){var a=i(79353).Buffer,r=i(72164);Object.defineProperty(t,"__esModule",{value:!0}),t.ComfyUIPodClient=void 0,t.createComfyUIPodClient=function(){let e=r.env.COMFYUI_POD_URL;if(!e)throw Error("COMFYUI_POD_URL environment variable is required");return new n({baseUrl:e})};let o=i(35914);class n{constructor(e){var t;this.baseUrl=e.baseUrl.replace(/\/$/,""),this.timeout=null!==(t=e.timeout)&&void 0!==t?t:12e4,this.websocketClient=e.websocketClient,this.errorHandler=e.errorHandler}getBaseUrl(){return this.baseUrl}queueWorkflow(e){return o.__awaiter(this,void 0,void 0,function*(){let t=new AbortController,i=setTimeout(()=>t.abort(),this.timeout);try{let i=yield fetch(`${this.baseUrl}/prompt`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:e}),signal:t.signal});if(!i.ok){let e=yield i.text();throw Error(`ComfyUI queue error: ${i.status} - ${e}`)}let a=yield i.json();if(Object.keys(a.node_errors||{}).length>0)throw Error(`ComfyUI node errors: ${JSON.stringify(a.node_errors)}`);return a.prompt_id}finally{clearTimeout(i)}})}getJobStatus(e){return o.__awaiter(this,void 0,void 0,function*(){return this.errorHandler?this.errorHandler.executeWithRetry(()=>o.__awaiter(this,void 0,void 0,function*(){return this.getJobStatusInternal(e)}),this.baseUrl):this.getJobStatusInternal(e)})}getJobStatusInternal(e){return o.__awaiter(this,void 0,void 0,function*(){let t=yield fetch(`${this.baseUrl}/history/${e}`,{signal:AbortSignal.timeout(1e4)});if(!t.ok){if(404===t.status)return{promptId:e,status:"processing"};throw Error(`ComfyUI history error: ${t.status} ${t.statusText}`)}let i=(yield t.json())[e];if(!i)return{promptId:e,status:"queued"};if(!i.status.completed)return{promptId:e,status:"processing"};if("error"===i.status.status_str)return{promptId:e,status:"failed",error:i.status.messages.map(e=>{let[t,i]=e;return`${t}: ${JSON.stringify(i)}`}).join("; ")};let a=[];for(let e of Object.values(i.outputs))if(e.images)for(let t of e.images){let e=yield this.downloadImage(t.filename,t.subfolder,t.type);a.push(e)}return 0===a.length?{promptId:e,status:"failed",error:i.status.messages.map(e=>{let[t,i]=e;return`${t}: ${JSON.stringify(i)}`}).join("; ")||"Workflow completed but produced no images"}:{promptId:e,status:"completed",images:a}})}downloadImage(e,t,i){return o.__awaiter(this,void 0,void 0,function*(){let r=new URLSearchParams({filename:e,subfolder:t,type:i}),o=yield fetch(`${this.baseUrl}/view?${r}`);if(!o.ok)throw Error(`ComfyUI image download error: ${o.statusText}`);let n=yield o.arrayBuffer(),s=a.from(n).toString("base64"),l=e.endsWith(".png")?"image/png":"image/jpeg";return`data:${l};base64,${s}`})}executeWorkflowWithWebSocket(e,t){return o.__awaiter(this,void 0,void 0,function*(){if(!this.websocketClient)return console.warn("WebSocket client not available, falling back to REST polling"),this.executeWorkflowPolling(e,2e3);try{if(!(yield this.healthCheck()))throw Error("ComfyUI pod health check failed");let i=yield this.websocketClient.connect(this.baseUrl),a=yield this.queueWorkflow(e);return t&&this.websocketClient.onProgress(a,t),new Promise((t,r)=>{let n=setTimeout(()=>{var o;null===(o=this.websocketClient)||void 0===o||o.disconnect(i),console.warn(`WebSocket timeout for prompt ${a}, falling back to polling`),this.executeWorkflowPolling(e,2e3).then(t).catch(r)},this.timeout);this.websocketClient.onCompletion(a,e=>o.__awaiter(this,void 0,void 0,function*(){var r,o;clearTimeout(n);try{let e=yield this.getJobStatus(a);null===(r=this.websocketClient)||void 0===r||r.disconnect(i),t(e)}catch(r){console.warn(`Failed to fetch final job status for ${a}: ${r}`),null===(o=this.websocketClient)||void 0===o||o.disconnect(i),t(e)}})),this.websocketClient.onError(a,e=>{var r;clearTimeout(n),null===(r=this.websocketClient)||void 0===r||r.disconnect(i),t({promptId:a,status:"failed",error:e})})})}catch(t){return console.warn(`WebSocket execution failed, falling back to REST polling: ${t}`),this.executeWorkflowPolling(e,2e3)}})}executeWorkflowPolling(e){return o.__awaiter(this,arguments,void 0,function*(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2e3,i=yield this.queueWorkflow(e),a=Date.now();for(;Date.now()-a<this.timeout;){let e=yield this.getJobStatus(i);if("completed"===e.status||"failed"===e.status)return e;yield new Promise(e=>setTimeout(e,t))}return{promptId:i,status:"failed",error:`Timeout after ${this.timeout}ms`}})}executeWorkflow(e){return o.__awaiter(this,arguments,void 0,function*(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2e3,i=arguments.length>2?arguments[2]:void 0;if(this.websocketClient&&i)try{return yield this.executeWorkflowWithWebSocket(e,i)}catch(e){console.warn(`WebSocket execution failed, falling back to polling: ${e}`)}return this.executeWorkflowPolling(e,t)})}healthCheck(){return o.__awaiter(this,void 0,void 0,function*(){try{return(yield fetch(`${this.baseUrl}/system_stats`,{method:"GET",signal:AbortSignal.timeout(5e3)})).ok}catch(e){return!1}})}getAvailableNodes(){return o.__awaiter(this,void 0,void 0,function*(){try{let e=yield fetch(`${this.baseUrl}/object_info`,{signal:AbortSignal.timeout(1e4)});if(!e.ok)return 404===e.status?console.warn(`[ComfyUI] Pod not available at ${this.baseUrl}/object_info (404 Not Found). ComfyUI features will be disabled until pod is started.`):console.warn(`[ComfyUI] Failed to get object_info from ${this.baseUrl}: ${e.status} ${e.statusText}`),[];let t=yield e.json();return Object.keys(t)}catch(t){let e=t instanceof Error?t.message:String(t);return e.includes("timeout")||e.includes("aborted")?console.warn(`[ComfyUI] Timeout connecting to pod at ${this.baseUrl}. ComfyUI features will be disabled until pod is available.`):console.warn(`[ComfyUI] Failed to fetch available nodes from ${this.baseUrl}:`,e),[]}})}uploadImage(e,t){return o.__awaiter(this,void 0,void 0,function*(){let i=new FormData;i.append("image",new Blob([new Uint8Array(e)],{type:"image/png"}),t),i.append("subfolder",""),i.append("type","input");let a=yield fetch(`${this.baseUrl}/upload/image`,{method:"POST",body:i});if(!a.ok){let e=yield a.text();throw Error(`ComfyUI upload error: ${a.status} - ${e}`)}return(yield a.json()).name})}getModels(){return o.__awaiter(this,void 0,void 0,function*(){var e,t,i,a,r,o,n,s,l,d,u,c,p,g,m,h,f,y,v,b;let w=yield fetch(`${this.baseUrl}/object_info/CheckpointLoaderSimple`);if(!w.ok)throw Error(`Failed to get models: ${w.statusText}`);let _=(null===(a=null===(i=null===(t=null===(e=(yield w.json()).CheckpointLoaderSimple)||void 0===e?void 0:e.input)||void 0===t?void 0:t.required)||void 0===i?void 0:i.ckpt_name)||void 0===a?void 0:a[0])||[],I=yield fetch(`${this.baseUrl}/object_info/LoraLoader`),S=(null===(s=null===(n=null===(o=null===(r=(yield I.json()).LoraLoader)||void 0===r?void 0:r.input)||void 0===o?void 0:o.required)||void 0===n?void 0:n.lora_name)||void 0===s?void 0:s[0])||[],k=yield fetch(`${this.baseUrl}/object_info/VAELoader`),P=(null===(c=null===(u=null===(d=null===(l=(yield k.json()).VAELoader)||void 0===l?void 0:l.input)||void 0===d?void 0:d.required)||void 0===u?void 0:u.vae_name)||void 0===c?void 0:c[0])||[],x=yield fetch(`${this.baseUrl}/object_info/UNETLoader`),E=(null===(h=null===(m=null===(g=null===(p=(yield x.json()).UNETLoader)||void 0===p?void 0:p.input)||void 0===g?void 0:g.required)||void 0===m?void 0:m.unet_name)||void 0===h?void 0:h[0])||[],C=yield fetch(`${this.baseUrl}/object_info/CLIPLoader`);return{checkpoints:_,loras:S,vaes:P,diffusion:E,textEncoders:(null===(b=null===(v=null===(y=null===(f=(yield C.json()).CLIPLoader)||void 0===f?void 0:f.input)||void 0===y?void 0:y.required)||void 0===v?void 0:v.clip_name)||void 0===b?void 0:b[0])||[]}})}}t.ComfyUIPodClient=n},5122:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.ComfyUIWebSocketClient=void 0;let a=i(35914),r=a.__importDefault(i(19768)),o=i(17530);class n{constructor(e){var t,i,a;this.connections=new Map,this.progressHandlers=new Map,this.completionHandlers=new Map,this.errorHandlers=new Map,this.progressState=new Map,this.MAX_RECONNECT_ATTEMPTS=null!==(t=null==e?void 0:e.maxReconnectAttempts)&&void 0!==t?t:3,this.RECONNECT_DELAY=null!==(i=null==e?void 0:e.reconnectDelay)&&void 0!==i?i:5e3,this.CONNECTION_TIMEOUT=null!==(a=null==e?void 0:e.connectionTimeout)&&void 0!==a?a:1e4}connect(e,t){return a.__awaiter(this,void 0,void 0,function*(){let i=e.replace(/\/+$/,""),a=t||(0,o.v4)(),n=this.connections.get(a);if(n&&n.isConnected)return console.log(`Already connected to ${i} with client ID: ${a}`),a;let s=i.replace("http://","ws://").replace("https://","wss://"),l=`${s}/ws?clientId=${a}`;return new Promise((e,t)=>{try{let o=new r.default(l),n={ws:o,clientId:a,serverUrl:i,isConnected:!1,reconnectAttempts:0,currentPromptId:null};o.on("open",()=>{console.log(`WebSocket connected to ${i} (Client ID: ${a})`),n.isConnected=!0,n.reconnectAttempts=0,this.connections.set(a,n),e(a)}),o.on("message",e=>{this.handleMessage(a,e)}),o.on("error",e=>{console.error(`WebSocket error for ${i} (Client ID: ${a}): ${e.message}`),n.isConnected=!1}),o.on("close",()=>{console.log(`WebSocket closed for ${i} (Client ID: ${a})`),n.isConnected=!1,this.handleReconnect(a,n)}),setTimeout(()=>{n.isConnected||(o.close(),t(Error("WebSocket connection timeout")))},this.CONNECTION_TIMEOUT)}catch(e){console.error(`Failed to create WebSocket connection: ${e}`),t(e)}})})}onProgress(e,t){this.progressHandlers.set(e,t)}onCompletion(e,t){this.completionHandlers.set(e,t)}onError(e,t){this.errorHandlers.set(e,t)}disconnect(e){let t=this.connections.get(e);t&&(t.ws.close(),this.connections.delete(e),console.log(`Disconnected client: ${e}`))}handleMessage(e,t){try{let i=JSON.parse(t.toString());switch(i.type){case"status":this.handleStatusMessage(e,i.data);break;case"progress_state":this.handleProgressMessage(e,i.data);break;case"executed":this.handleExecutedMessage(e,i.data);break;case"execution_error":this.handleExecutionError(e,i.data);break;default:console.debug(`Received message type: ${i.type} (Client ID: ${e})`)}}catch(e){console.error(`Failed to parse WebSocket message: ${e}`)}}handleStatusMessage(e,t){console.debug(`Status update (Client ID: ${e}): ${JSON.stringify(t)}`)}handleProgressMessage(e,t){let{prompt_id:i,nodes:a}=t,r=this.progressHandlers.get(i);if(!r)return;let o=0,n=0;for(let e of Object.values(a))o+=e.max,n+=e.value;let s=Math.min(100,Math.max(0,o>0?Math.round(n/o*100):0)),l=this.progressState.get(i),d=Date.now(),u=this.progressState.get(`${i}_timestamp`)||0;(s!==l||d-u>=1e3)&&(this.progressState.set(i,s),this.progressState.set(`${i}_timestamp`,d),r(s))}handleExecutedMessage(e,t){return a.__awaiter(this,void 0,void 0,function*(){let{node:i,prompt_id:a,output:r}=t;if(console.log(`Node ${i} executed (Client ID: ${e}, Prompt: ${a})`),r&&(r.images||r.gifs)){let e=this.completionHandlers.get(a);e&&(yield e({promptId:a,status:"completed"}),this.cleanupHandlers(a))}})}handleExecutionError(e,t){return a.__awaiter(this,void 0,void 0,function*(){let{prompt_id:i,exception_type:a,exception_message:r}=t;console.error(`Execution error (Client ID: ${e}, Prompt: ${i}): ${a} - ${r}`);let o=`${a}: ${r}`,n=this.errorHandlers.get(i);if(n){try{yield n(o)}catch(e){console.error(`Error in error handler: ${e}`)}this.cleanupHandlers(i)}else this.cleanupHandlers(i)})}handleReconnect(e,t){return a.__awaiter(this,void 0,void 0,function*(){if(t.reconnectAttempts>=this.MAX_RECONNECT_ATTEMPTS){console.warn(`Max reconnection attempts reached for ${t.serverUrl} (Client ID: ${e})`),this.connections.delete(e);return}t.reconnectAttempts++,console.log(`Attempting to reconnect (${t.reconnectAttempts}/${this.MAX_RECONNECT_ATTEMPTS}) to ${t.serverUrl}...`),yield new Promise(e=>setTimeout(e,this.RECONNECT_DELAY));try{yield this.connect(t.serverUrl,e)}catch(e){console.error(`Reconnection failed: ${e}`)}})}cleanupHandlers(e){this.progressHandlers.delete(e),this.completionHandlers.delete(e),this.errorHandlers.delete(e),this.progressState.delete(e),this.progressState.delete(`${e}_timestamp`)}}t.ComfyUIWebSocketClient=n},93175:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ComfyUIWorkflowBuilder=void 0,t.createBaseImageWorkflow=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"flux1-schnell.safetensors",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1024,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1024,n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:20,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:7,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:-1,d=new i,u=d.addCheckpointLoader(a),c=d.addVAELoader("vae.safetensors"),p=d.addTextEncode(e,!0),g=d.addTextEncode(t,!1),m=d.addEmptyLatentImage(r,o,1),h=d.addKSampler(u,p,g,m,l,n,s),f=d.addVAEDecode(h,c);return d.addSaveImage(f,"base_image"),d.build()},t.createCharacterSheetWorkflow=function(e,t,a,r){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"flux1-schnell.safetensors",n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1024,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1024,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:25,d=arguments.length>8&&void 0!==arguments[8]?arguments[8]:7,u=arguments.length>9&&void 0!==arguments[9]?arguments[9]:-1,c=new i,p=c.addLoadImage(e),g=c.addCheckpointLoader(o),m=c.addVAELoader("vae.safetensors"),h=`${t}, ${r.angle} angle, ${r.pose} pose${r.expression?`, ${r.expression} expression`:""}${r.lighting?`, ${r.lighting} lighting`:""}`,f=c.addTextEncode(h,!0),y=c.addTextEncode(a,!1);c.addPuLID(p,.95),c.addControlNet(p,g,"controlnet-openpose.safetensors",.8);let v=c.addEmptyLatentImage(n,s,1),b=c.addKSampler(g,f,y,v,u,l,d),w=c.addVAEDecode(b,m);return c.addSaveImage(w,`character_sheet_${r.angle}_${r.pose}`),c.build()},t.createFaceSwapWorkflow=function(e,t,a){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"flux1-schnell.safetensors",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1024,n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1024,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:20,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:7,d=arguments.length>8&&void 0!==arguments[8]?arguments[8]:-1,u=new i,c=u.addLoadImage(e),p=u.addCheckpointLoader(r),g=u.addVAELoader("vae.safetensors"),m=u.addIPAdapterFaceID(c,p,.8),h=u.addTextEncode(t,!0),f=u.addTextEncode(a,!1),y=u.addEmptyLatentImage(o,n,1),v=u.addKSampler(m,h,f,y,d,s,l),b=u.addVAEDecode(v,g);return u.addSaveImage(b,"face_swap_output"),u.build()};class i{constructor(){this.nodes={},this.nodeCounter=1}addLoadImage(e){let t=this.getNextNodeId();return this.nodes[t]={inputs:{image:e},class_type:"LoadImage",_meta:{title:"Load Image"}},t}addCheckpointLoader(e){let t=this.getNextNodeId();return this.nodes[t]={inputs:{ckpt_name:e},class_type:"CheckpointLoaderSimple",_meta:{title:"Load Model"}},t}addTextEncode(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=this.getNextNodeId();return this.nodes[i]={inputs:{text:e},class_type:"CLIPTextEncode",_meta:{title:t?"Positive Prompt":"Negative Prompt"}},i}addPuLID(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.95,i=this.getNextNodeId();return this.nodes[i]={inputs:{image:[e,0],strength:t},class_type:"PuLID",_meta:{title:"PuLID Face Consistency"}},i}addIPAdapterFaceID(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.8,a=this.getNextNodeId();return this.nodes[a]={inputs:{image:[e,0],model:[t,0],strength:i},class_type:"IPAdapterFaceID",_meta:{title:"IPAdapter FaceID"}},a}addControlNet(e,t,i){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=this.getNextNodeId();return this.nodes[r]={inputs:{image:[e,0],model:[t,0],control_net_name:i,strength:a},class_type:"ControlNetApply",_meta:{title:"ControlNet"}},r}addEmptyLatentImage(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=this.getNextNodeId();return this.nodes[a]={inputs:{width:e,height:t,batch_size:i},class_type:"EmptyLatentImage",_meta:{title:"Empty Latent Image"}},a}addKSampler(e,t,i,a){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:-1,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:20,n=arguments.length>6&&void 0!==arguments[6]?arguments[6]:7,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"euler",l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:"normal",d=this.getNextNodeId();return this.nodes[d]={inputs:{seed:r,steps:o,cfg:n,sampler_name:s,scheduler:l,denoise:1,model:[e,0],positive:[t,0],negative:[i,0],latent_image:[a,0]},class_type:"KSampler",_meta:{title:"KSampler"}},d}addVAELoader(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"vae.safetensors",t=this.getNextNodeId();return this.nodes[t]={inputs:{vae_name:e},class_type:"VAELoader",_meta:{title:"Load VAE"}},t}addVAEDecode(e,t){let i=this.getNextNodeId();return this.nodes[i]={inputs:{samples:[e,0],vae:[t,0]},class_type:"VAEDecode",_meta:{title:"VAE Decode"}},i}addSaveImage(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"output",i=this.getNextNodeId();return this.nodes[i]={inputs:{filename_prefix:t,images:[e,0]},class_type:"SaveImage",_meta:{title:"Save Image"}},i}addLoRALoader(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=this.getNextNodeId();return this.nodes[a]={inputs:{model:[e,0],lora_name:t,strength_model:i,strength_clip:i},class_type:"LoraLoader",_meta:{title:"Load LoRA"}},a}build(){return this.nodes}export(){return JSON.stringify(this.build(),null,2)}getNextNodeId(){return String(this.nodeCounter++)}}t.ComfyUIWorkflowBuilder=i},79276:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.ImageGenerationService=void 0;let a=i(35914);class r{constructor(e,t,i){this.generationJobsRepo=e,this.runpod=t,this.notificationsRepo=i}startBaseImages(e){return a.__awaiter(this,void 0,void 0,function*(){var t;let i=this.buildPrompt(e.appearance,e.identity),a=this.buildNegativePrompt(),r=yield this.generationJobsRepo.createJob({userId:e.userId,characterId:e.characterId,type:"character_generation",status:"queued",input:{prompt:i,negativePrompt:a,nsfw:e.nsfwEnabled,seed:null===(t=e.seed)||void 0===t?void 0:t.toString(),imageCount:3},imageCount:3,completedCount:0}),o=yield this.runpod.submitBaseImages({prompt:i,nsfw:e.nsfwEnabled,seed:e.seed,useZImage:e.useZImage}),n=yield this.generationJobsRepo.updateById(r.id,{externalJobId:o,startedAt:new Date});return{jobId:n.id,externalJobId:n.externalJobId,prompt:i,negativePrompt:a}})}startFaceSwap(e){return a.__awaiter(this,void 0,void 0,function*(){var t;let i=yield this.generationJobsRepo.createJob({userId:e.userId,characterId:e.characterId,type:"image_generation",status:"queued",input:{prompt:e.prompt,nsfw:e.nsfw,seed:null===(t=e.seed)||void 0===t?void 0:t.toString()},imageCount:1,completedCount:0}),a=yield this.runpod.submitFaceSwap({baseImageUrl:e.baseImageUrl,prompt:e.prompt,nsfw:e.nsfw,seed:e.seed}),r=yield this.generationJobsRepo.updateById(i.id,{externalJobId:a,startedAt:new Date});return{jobId:r.id,externalJobId:r.externalJobId}})}startCharacterSheet(e){return a.__awaiter(this,void 0,void 0,function*(){let t=yield this.generationJobsRepo.createJob({userId:e.userId,characterId:e.characterId,type:"character_generation",status:"queued",input:{nsfw:e.nsfw,imageCount:10},imageCount:10,completedCount:0}),i=yield this.runpod.submitCharacterSheet({baseImageUrl:e.baseImageUrl,nsfw:e.nsfw,angles:e.angles}),a=yield this.generationJobsRepo.updateById(t.id,{externalJobId:i,startedAt:new Date});return{jobId:a.id,externalJobId:a.externalJobId}})}syncJobStatus(e){return a.__awaiter(this,void 0,void 0,function*(){var t;let i=yield this.generationJobsRepo.getById(e);if(!i)return null;if(!i.externalJobId)return i;let a=i.status,r=yield this.runpod.getJobStatus(i.externalJobId),o=this.mapRunPodStatus(r.status),n={status:o};r.error&&(n.error=r.error),r.output&&(n.output=r.output),("completed"===o||"failed"===o||"cancelled"===o)&&(n.completedAt=new Date);let s=yield this.generationJobsRepo.updateById(e,n);if(this.notificationsRepo&&a!==o){if("completed"===o&&"completed"!==a){let e="character_generation"===i.type?"character generation":"image generation";yield this.notificationsRepo.create({userId:i.userId,type:"generation.completed",title:"Generation complete",body:`Your ${e} is ready!`,href:i.characterId?`/studio?influencer=${i.characterId}`:"/activity",metadata:{generationJobId:i.id,characterId:i.characterId,type:i.type}})}else"failed"===o&&"failed"!==a&&(yield this.notificationsRepo.create({userId:i.userId,type:"generation.failed",title:"Generation failed",body:null!==(t=r.error)&&void 0!==t?t:"Your generation failed. Please try again.",href:"/activity",metadata:{generationJobId:i.id,characterId:i.characterId,error:r.error}}))}return s})}mapRunPodStatus(e){switch(e){case"IN_QUEUE":return"queued";case"IN_PROGRESS":default:return"processing";case"COMPLETED":return"completed";case"FAILED":return"failed"}}buildPrompt(e,t){var i;let a="realistic"===e.style?"Photo":"Anime illustration",r="female"===e.gender?"woman":"man",o=`${e.hairColor} ${e.hairStyle} hair`,n=`${e.eyeColor} eyes`,s=`${e.bodyType} body type`,l=`${a} of a ${e.age} year old ${e.ethnicity} ${r}, `;return l+=`${o}, ${n}, ${s}, wearing ${t.defaultOutfit}, professional photography, high quality, detailed, 8k, best quality, masterpiece`,t.archetype&&(l+=`, ${t.archetype} style`),(null===(i=t.personalityTraits)||void 0===i?void 0:i.length)&&(l+=`, ${t.personalityTraits.join(", ")}`),l}buildNegativePrompt(){return"deformed, blurry, bad anatomy, disfigured, poorly drawn face, mutation, mutated, extra limb, ugly, poorly drawn hands, bad fingers, extra fingers, missing fingers, low quality, worst quality, jpeg artifacts, watermark, signature"}}t.ImageGenerationService=r},74071:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});let a=i(35914);a.__exportStar(i(93175),t),a.__exportStar(i(77565),t),a.__exportStar(i(5122),t),a.__exportStar(i(61519),t),a.__exportStar(i(12529),t),a.__exportStar(i(17561),t),a.__exportStar(i(42058),t),a.__exportStar(i(28602),t),a.__exportStar(i(79276),t),a.__exportStar(i(46249),t),a.__exportStar(i(89975),t),a.__exportStar(i(40234),t)},46249:function(e,t,i){var a=i(79353).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.ModalClient=void 0;let r=i(35914);class o{constructor(e){this.endpointUrl=e.endpointUrl.replace(/\/$/,""),this.timeout=e.timeout||18e4}generateFluxDev(e){return r.__awaiter(this,void 0,void 0,function*(){return this.callEndpoint("/flux-dev",e)})}generateFlux(e){return r.__awaiter(this,void 0,void 0,function*(){return this.callEndpoint("/flux",e)})}generateFluxLoRA(e){return r.__awaiter(this,void 0,void 0,function*(){return this.callEndpoint("/flux-lora",e)})}generateWan2(e){return r.__awaiter(this,void 0,void 0,function*(){return this.callEndpoint("/wan2",e)})}generateQwenImage2512(e){return r.__awaiter(this,void 0,void 0,function*(){return this.callEndpoint("/qwen-image-2512",e)})}generateQwenImage2512Fast(e){return r.__awaiter(this,void 0,void 0,function*(){return this.callEndpoint("/qwen-image-2512-fast",e)})}generateQwenImage2512LoRA(e){return r.__awaiter(this,void 0,void 0,function*(){return this.callEndpoint("/qwen-image-2512-lora",e)})}editQwenImage2511(e){return r.__awaiter(this,void 0,void 0,function*(){return this.callEndpoint("/qwen-image-edit-2511",e)})}inpaintQwenImage2511(e){return r.__awaiter(this,void 0,void 0,function*(){return this.callEndpoint("/qwen-image-inpaint-2511",e)})}generateWan26(e){return r.__awaiter(this,void 0,void 0,function*(){return this.callEndpoint("/wan2.6",e)})}generateWan26R2V(e){return r.__awaiter(this,void 0,void 0,function*(){return this.callEndpoint("/wan2.6-r2v",e)})}generateQwenFaceSwap(e){return r.__awaiter(this,void 0,void 0,function*(){return this.callEndpoint("/qwen-faceswap",e)})}generateQwenFaceSwapFast(e){return r.__awaiter(this,void 0,void 0,function*(){return this.callEndpoint("/qwen-faceswap-fast",e)})}generateQwenCharacterScene(e){return r.__awaiter(this,void 0,void 0,function*(){return this.callEndpoint("/qwen-character-scene",e)})}videoFaceSwap(e){return r.__awaiter(this,void 0,void 0,function*(){return this.callEndpoint("/video-faceswap",e)})}generateFluxIPAdapterFaceID(e){return r.__awaiter(this,void 0,void 0,function*(){return this.callEndpoint("/flux-ipadapter-faceid",e)})}generateSDXLInstantID(e){return r.__awaiter(this,void 0,void 0,function*(){return this.callEndpoint("/sdxl-instantid",e)})}generateZImageSimple(e){return r.__awaiter(this,void 0,void 0,function*(){return this.callEndpoint("/z-image-simple",e)})}generateZImageDanrisi(e){return r.__awaiter(this,void 0,void 0,function*(){return this.callEndpoint("/z-image-danrisi",e)})}generateZImageInstantID(e){return r.__awaiter(this,void 0,void 0,function*(){return this.callEndpoint("/z-image-instantid",e)})}generateZImagePuLID(e){return r.__awaiter(this,void 0,void 0,function*(){return this.callEndpoint("/z-image-pulid",e)})}executeWorkflow(e){return r.__awaiter(this,void 0,void 0,function*(){return this.callEndpoint("/workflow",e)})}callEndpoint(e,t){return r.__awaiter(this,void 0,void 0,function*(){let i=`${this.endpointUrl}${e}`,r=new AbortController,o=setTimeout(()=>r.abort(),this.timeout);try{let e=yield fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t),signal:r.signal});if(clearTimeout(o),!e.ok){let t=yield e.text().catch(()=>"Unknown error");throw Error(`Modal.com API error: ${e.status} ${e.statusText} - ${t}`)}let n=a.from((yield e.arrayBuffer())),s=e.headers.get("content-type")||"image/jpeg",l=e.headers.get("x-cost-usd")?parseFloat(e.headers.get("x-cost-usd")):void 0,d=e.headers.get("x-execution-time-sec")?parseFloat(e.headers.get("x-execution-time-sec")):void 0,u=e.headers.get("x-gpu-type")||void 0;return{image:n,contentType:s,costUsd:l,executionTimeSec:d,gpuType:u}}catch(t){if(clearTimeout(o),t instanceof Error&&"AbortError"===t.name)throw Error(`Modal.com request timeout (${e})`);throw t}})}healthCheck(){return r.__awaiter(this,void 0,void 0,function*(){try{return yield fetch(`${this.endpointUrl}/flux-dev`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:"test"}),signal:AbortSignal.timeout(5e3)}),!0}catch(e){return!1}})}}t.ModalClient=o},89975:function(e,t,i){var a=i(79353).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.ModalJobRunner=void 0;let r=i(35914),o=i(46249),n=i(99128);class s{constructor(e){this.jobs=new Map,this.client=new o.ModalClient({endpointUrl:e.endpointUrl,timeout:e.timeout})}submitBaseImages(e){return r.__awaiter(this,void 0,void 0,function*(){let t=`modal_${(0,n.randomUUID)()}`,i={prompt:e.prompt,negative_prompt:e.nsfw?"deformed, blurry, bad anatomy, ugly, low quality":"deformed, blurry, bad anatomy, ugly, low quality, nsfw, nude, naked",width:1024,height:1024,steps:20,cfg:3.5,seed:e.seed};try{let e=yield this.client.generateFluxDev(i);return this.jobs.set(t,{status:"COMPLETED",output:{images:[{buffer:e.image}]},createdAt:new Date}),t}catch(e){throw this.jobs.set(t,{status:"FAILED",error:e instanceof Error?e.message:"Unknown error",createdAt:new Date}),e}})}submitFaceSwap(e){return r.__awaiter(this,void 0,void 0,function*(){let t=`modal_${(0,n.randomUUID)()}`;try{let i;if(e.baseImageUrl.startsWith("data:"))i=e.baseImageUrl;else if(e.baseImageUrl.startsWith("http")){let t=yield fetch(e.baseImageUrl),r=yield t.arrayBuffer(),o=a.from(r).toString("base64"),n=t.headers.get("content-type")||"image/jpeg";i=`data:${n};base64,${o}`}else throw Error("Invalid baseImageUrl format. Expected data URL or HTTP URL.");let r={prompt:e.prompt,reference_image:i,negative_prompt:e.nsfw?"deformed, blurry, bad anatomy, ugly, low quality":"deformed, blurry, bad anatomy, ugly, low quality, nsfw, nude, naked",width:1024,height:1024,steps:20,cfg:1,seed:e.seed,ipadapter_strength:.8,face_provider:"CPU"},o=yield this.client.generateFluxIPAdapterFaceID(r);return this.jobs.set(t,{status:"COMPLETED",output:{images:[{buffer:o.image}]},createdAt:new Date}),t}catch(e){throw this.jobs.set(t,{status:"FAILED",error:e instanceof Error?e.message:"Unknown error",createdAt:new Date}),e}})}submitQwenFaceSwap(e){return r.__awaiter(this,void 0,void 0,function*(){let t=`modal_${(0,n.randomUUID)()}`;try{let i;if(e.referenceImageUrl.startsWith("data:"))i=e.referenceImageUrl;else if(e.referenceImageUrl.startsWith("http")){let t=yield fetch(e.referenceImageUrl),r=yield t.arrayBuffer(),o=a.from(r).toString("base64"),n=t.headers.get("content-type")||"image/jpeg";i=`data:${n};base64,${o}`}else throw Error("Invalid referenceImageUrl format");let r={prompt:e.prompt,reference_image:i,negative_prompt:e.nsfw?"":"nsfw, nude, naked",seed:e.seed,restore_face:!0},o=e.fast?yield this.client.generateQwenFaceSwapFast(r):yield this.client.generateQwenFaceSwap(r);return this.jobs.set(t,{status:"COMPLETED",output:{images:[{buffer:o.image}]},createdAt:new Date}),t}catch(e){throw this.jobs.set(t,{status:"FAILED",error:e instanceof Error?e.message:"Unknown error",createdAt:new Date}),e}})}submitQwenCharacterScene(e){return r.__awaiter(this,void 0,void 0,function*(){var t;let i=`modal_${(0,n.randomUUID)()}`;try{let r;if(e.characterImageUrl.startsWith("data:"))r=e.characterImageUrl;else if(e.characterImageUrl.startsWith("http")){let t=yield fetch(e.characterImageUrl),i=yield t.arrayBuffer(),o=a.from(i).toString("base64"),n=t.headers.get("content-type")||"image/jpeg";r=`data:${n};base64,${o}`}else throw Error("Invalid characterImageUrl format");let o={character_image:r,scene:e.scene,denoise:null!==(t=e.denoise)&&void 0!==t?t:.7,seed:e.seed},n=yield this.client.generateQwenCharacterScene(o);return this.jobs.set(i,{status:"COMPLETED",output:{images:[{buffer:n.image}]},createdAt:new Date}),i}catch(e){throw this.jobs.set(i,{status:"FAILED",error:e instanceof Error?e.message:"Unknown error",createdAt:new Date}),e}})}submitVideoFaceSwap(e){return r.__awaiter(this,void 0,void 0,function*(){var t,i;let r=`modal_${(0,n.randomUUID)()}`;try{let o,n;if(e.sourceVideoUrl.startsWith("data:"))o=e.sourceVideoUrl;else if(e.sourceVideoUrl.startsWith("http")){let t=yield fetch(e.sourceVideoUrl),i=yield t.arrayBuffer(),r=a.from(i).toString("base64"),n=t.headers.get("content-type")||"video/mp4";o=`data:${n};base64,${r}`}else throw Error("Invalid sourceVideoUrl format");if(e.referenceImageUrl.startsWith("data:"))n=e.referenceImageUrl;else if(e.referenceImageUrl.startsWith("http")){let t=yield fetch(e.referenceImageUrl),i=yield t.arrayBuffer(),r=a.from(i).toString("base64"),o=t.headers.get("content-type")||"image/jpeg";n=`data:${o};base64,${r}`}else throw Error("Invalid referenceImageUrl format");let s={source_video:o,reference_image:n,fps:null!==(t=e.fps)&&void 0!==t?t:30,restore_face:null===(i=e.restoreFace)||void 0===i||i},l=yield this.client.videoFaceSwap(s);return this.jobs.set(r,{status:"COMPLETED",output:{video:{buffer:l.image}},createdAt:new Date}),r}catch(e){throw this.jobs.set(r,{status:"FAILED",error:e instanceof Error?e.message:"Unknown error",createdAt:new Date}),e}})}submitCharacterSheet(e){return r.__awaiter(this,void 0,void 0,function*(){let e=`modal_${(0,n.randomUUID)()}`;try{return this.jobs.set(e,{status:"FAILED",error:"Character sheet generation via Modal.com workflow not yet implemented",createdAt:new Date}),e}catch(t){throw this.jobs.set(e,{status:"FAILED",error:t instanceof Error?t.message:"Unknown error",createdAt:new Date}),t}})}getJobStatus(e){return r.__awaiter(this,void 0,void 0,function*(){let t=this.jobs.get(e);if(!t)return{status:"FAILED",error:"Job not found"};let i={status:t.status,output:t.output,error:t.error},a=Date.now()-36e5;for(let[e,t]of this.jobs.entries())t.createdAt.getTime()<a&&this.jobs.delete(e);return i})}generateFlux(e){return r.__awaiter(this,void 0,void 0,function*(){let t=`modal_${(0,n.randomUUID)()}`;try{let i=yield this.client.generateFlux(e);return this.jobs.set(t,{status:"COMPLETED",output:{images:[{buffer:i.image}]},createdAt:new Date}),t}catch(e){throw this.jobs.set(t,{status:"FAILED",error:e instanceof Error?e.message:"Unknown error",createdAt:new Date}),e}})}generateFluxLoRA(e){return r.__awaiter(this,void 0,void 0,function*(){let t=`modal_${(0,n.randomUUID)()}`;try{let i=yield this.client.generateFluxLoRA(e);return this.jobs.set(t,{status:"COMPLETED",output:{images:[{buffer:i.image}]},createdAt:new Date}),t}catch(e){throw this.jobs.set(t,{status:"FAILED",error:e instanceof Error?e.message:"Unknown error",createdAt:new Date}),e}})}generateZImageSimple(e){return r.__awaiter(this,void 0,void 0,function*(){let t=`modal_${(0,n.randomUUID)()}`;try{let i=yield this.client.generateZImageSimple(e);return this.jobs.set(t,{status:"COMPLETED",output:{images:[{buffer:i.image}]},createdAt:new Date}),t}catch(e){throw this.jobs.set(t,{status:"FAILED",error:e instanceof Error?e.message:"Unknown error",createdAt:new Date}),e}})}generateZImageDanrisi(e){return r.__awaiter(this,void 0,void 0,function*(){let t=`modal_${(0,n.randomUUID)()}`;try{let i=yield this.client.generateZImageDanrisi(e);return this.jobs.set(t,{status:"COMPLETED",output:{images:[{buffer:i.image}]},createdAt:new Date}),t}catch(e){throw this.jobs.set(t,{status:"FAILED",error:e instanceof Error?e.message:"Unknown error",createdAt:new Date}),e}})}generateZImageInstantID(e){return r.__awaiter(this,void 0,void 0,function*(){let t=`modal_${(0,n.randomUUID)()}`;try{let i=yield this.client.generateZImageInstantID(e);return this.jobs.set(t,{status:"COMPLETED",output:{images:[{buffer:i.image}]},createdAt:new Date}),t}catch(e){throw this.jobs.set(t,{status:"FAILED",error:e instanceof Error?e.message:"Unknown error",createdAt:new Date}),e}})}generateZImagePuLID(e){return r.__awaiter(this,void 0,void 0,function*(){let t=`modal_${(0,n.randomUUID)()}`;try{let i=yield this.client.generateZImagePuLID(e);return this.jobs.set(t,{status:"COMPLETED",output:{images:[{buffer:i.image}]},createdAt:new Date}),t}catch(e){throw this.jobs.set(t,{status:"FAILED",error:e instanceof Error?e.message:"Unknown error",createdAt:new Date}),e}})}generateFluxIPAdapterFaceID(e){return r.__awaiter(this,void 0,void 0,function*(){let t=`modal_${(0,n.randomUUID)()}`;try{let i=yield this.client.generateFluxIPAdapterFaceID(e);return this.jobs.set(t,{status:"COMPLETED",output:{images:[{buffer:i.image}]},createdAt:new Date}),t}catch(e){throw this.jobs.set(t,{status:"FAILED",error:e instanceof Error?e.message:"Unknown error",createdAt:new Date}),e}})}generateQwenImage2512(e){return r.__awaiter(this,void 0,void 0,function*(){let t=`modal_${(0,n.randomUUID)()}`;try{let i=yield this.client.generateQwenImage2512(e);return this.jobs.set(t,{status:"COMPLETED",output:{images:[{buffer:i.image}]},createdAt:new Date}),t}catch(e){throw this.jobs.set(t,{status:"FAILED",error:e instanceof Error?e.message:"Unknown error",createdAt:new Date}),e}})}generateQwenImage2512Fast(e){return r.__awaiter(this,void 0,void 0,function*(){let t=`modal_${(0,n.randomUUID)()}`;try{let i=yield this.client.generateQwenImage2512Fast(e);return this.jobs.set(t,{status:"COMPLETED",output:{images:[{buffer:i.image}]},createdAt:new Date}),t}catch(e){throw this.jobs.set(t,{status:"FAILED",error:e instanceof Error?e.message:"Unknown error",createdAt:new Date}),e}})}generateQwenImage2512LoRA(e){return r.__awaiter(this,void 0,void 0,function*(){let t=`modal_${(0,n.randomUUID)()}`;try{let i=yield this.client.generateQwenImage2512LoRA(e);return this.jobs.set(t,{status:"COMPLETED",output:{images:[{buffer:i.image}]},createdAt:new Date}),t}catch(e){throw this.jobs.set(t,{status:"FAILED",error:e instanceof Error?e.message:"Unknown error",createdAt:new Date}),e}})}editQwenImage2511(e){return r.__awaiter(this,void 0,void 0,function*(){let t=`modal_${(0,n.randomUUID)()}`;try{let i=yield this.client.editQwenImage2511(e);return this.jobs.set(t,{status:"COMPLETED",output:{images:[{buffer:i.image}]},createdAt:new Date}),t}catch(e){throw this.jobs.set(t,{status:"FAILED",error:e instanceof Error?e.message:"Unknown error",createdAt:new Date}),e}})}inpaintQwenImage2511(e){return r.__awaiter(this,void 0,void 0,function*(){let t=`modal_${(0,n.randomUUID)()}`;try{let i=yield this.client.inpaintQwenImage2511(e);return this.jobs.set(t,{status:"COMPLETED",output:{images:[{buffer:i.image}]},createdAt:new Date}),t}catch(e){throw this.jobs.set(t,{status:"FAILED",error:e instanceof Error?e.message:"Unknown error",createdAt:new Date}),e}})}healthCheck(){return r.__awaiter(this,void 0,void 0,function*(){return this.client.healthCheck()})}}t.ModalJobRunner=s},40234:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.detectWorkflowType=function(e){var t,i,a,r,o,n,s,l,d,u,c,p,g,m;let h=Object.values(e).map(e=>e.class_type).join(" ").toLowerCase(),f=Object.values(e).flatMap(e=>Object.entries(e.inputs||{})),y={};for(let[h,f]of Object.entries(e)){if("CLIPTextEncode"===f.class_type){let e=null===(t=f.inputs)||void 0===t?void 0:t.text;!e||e.includes("negative")||e.includes("deformed")?e&&(e.includes("negative")||e.includes("deformed"))&&(y.negativePrompt=e):y.prompt=e}if(("EmptySD3LatentImage"===f.class_type||"EmptyLatentImage"===f.class_type)&&(y.width=null===(i=f.inputs)||void 0===i?void 0:i.width,y.height=null===(a=f.inputs)||void 0===a?void 0:a.height),("KSampler"===f.class_type||"ClownsharKSampler_Beta"===f.class_type)&&(y.steps=null===(r=f.inputs)||void 0===r?void 0:r.steps,y.cfg=null===(o=f.inputs)||void 0===o?void 0:o.cfg,y.seed=null===(n=f.inputs)||void 0===n?void 0:n.seed),"LoadImage"===f.class_type){let e=null===(s=f.inputs)||void 0===s?void 0:s.image;e&&(y.referenceImage=e)}"ApplyInstantID"===f.class_type&&(y.instantidStrength=null===(l=f.inputs)||void 0===l?void 0:l.weight,y.controlnetStrength=null===(d=f.inputs)||void 0===d?void 0:d.controlnet_conditioning_scale),"ApplyPuLID"===f.class_type&&(y.pulidStrength=null===(u=f.inputs)||void 0===u?void 0:u.strength,y.pulidStart=null===(c=f.inputs)||void 0===c?void 0:c.start_percent,y.pulidEnd=null===(p=f.inputs)||void 0===p?void 0:p.end_percent),"ApplyFluxIPAdapter"===f.class_type&&(y.ipadapterStrength=null===(g=f.inputs)||void 0===g?void 0:g.ip_scale),("InsightFaceLoader"===f.class_type||"InstantIDFaceAnalysis"===f.class_type)&&(y.faceProvider=(null===(m=f.inputs)||void 0===m?void 0:m.provider)||"CPU")}let v=(h+" "+f.map(e=>{let[t,i]=e;return"string"==typeof i&&(t.includes("unet")||t.includes("checkpoint")||t.includes("model"))?i.toLowerCase():""}).filter(Boolean).join(" ")).toLowerCase();return v.includes("qwen_image")||v.includes("qwen-image")||v.includes("qwen_2512")||v.includes("qwen_2511")?v.includes("edit")||v.includes("instruction")?v.includes("mask")||v.includes("inpaint")?{type:"qwen-image-inpaint-2511",parameters:y}:{type:"qwen-image-edit-2511",parameters:y}:v.includes("lightning")||v.includes("fast")||4===y.steps?{type:"qwen-image-2512-fast",parameters:y}:{type:"qwen-image-2512",parameters:y}:v.includes("wan2.6")||v.includes("wan26")||v.includes("wan_2.6")?v.includes("r2v")||v.includes("reference")||y.referenceVideo?{type:"wan2.6-r2v",parameters:y}:{type:"wan2.6",parameters:y}:v.includes("z_image_turbo")||v.includes("z-image-turbo")||v.includes("z_image_turbo_bf16")?v.includes("instantid")||v.includes("applyinstantid")?{type:"z-image-instantid",parameters:y}:v.includes("pulid")||v.includes("applypulid")?{type:"z-image-pulid",parameters:y}:v.includes("clownsharksampler")||v.includes("betasamplingscheduler")||v.includes("sigmas rescale")?{type:"z-image-danrisi",parameters:y}:{type:"z-image-simple",parameters:y}:h.includes("flux1-dev")||h.includes("flux_dev")?h.includes("loadfluxipadapter")||h.includes("applyfluxipadapter")?{type:"flux-ipadapter-faceid",parameters:y}:{type:"flux-dev",parameters:y}:h.includes("sdxl")&&(h.includes("instantid")||h.includes("applyinstantid"))?{type:"sdxl-instantid",parameters:y}:{type:"unknown",parameters:y}}},28602:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.RunPodClient=void 0;let a=i(35914);class r{constructor(e){this.apiKey=e.apiKey,this.baseUrl=e.baseUrl||"https://api.runpod.io/graphql"}request(e,t){return a.__awaiter(this,void 0,void 0,function*(){let i=yield fetch(this.baseUrl,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.apiKey}`},body:JSON.stringify({query:e,variables:t})});if(!i.ok)throw Error(`RunPod API error: ${i.statusText}`);let a=yield i.json();if(a.errors)throw Error(`RunPod API error: ${JSON.stringify(a.errors)}`);return a.data})}listPods(){return a.__awaiter(this,void 0,void 0,function*(){let e=`
      query {
        myself {
          pods {
            id
            name
            desiredStatus
            runtime {
              uptimeInSeconds
              ports {
                ip
                isIpPublic
                privatePort
                publicPort
                type
              }
            }
            machine {
              podHostId
              gpuCount
            }
          }
        }
      }
    `;return(yield this.request(e)).myself.pods})}getPod(e){return a.__awaiter(this,void 0,void 0,function*(){let t=`
      query GetPod($input: Pod!) {
        pod(input: $input) {
          id
          name
          desiredStatus
          runtime {
            uptimeInSeconds
            ports {
              ip
              isIpPublic
              privatePort
              publicPort
              type
            }
          }
          machine {
            podHostId
            gpuCount
          }
        }
      }
    `;return(yield this.request(t,{input:{id:e}})).pod})}createPod(e){return a.__awaiter(this,void 0,void 0,function*(){let t=`
      mutation CreatePod($input: PodCreateInput!) {
        podCreate(input: $input) {
          id
          name
          desiredStatus
        }
      }
    `;return(yield this.request(t,{input:e})).podCreate})}listEndpoints(){return a.__awaiter(this,void 0,void 0,function*(){let e=`
      query {
        myself {
          endpoints {
            id
            name
            templateId
            gpuIds
            workersMin
            workersMax
          }
        }
      }
    `;return(yield this.request(e)).myself.endpoints})}runJob(e,t){return a.__awaiter(this,void 0,void 0,function*(){let i=`
      mutation RunJob($input: EndpointRunInput!) {
        endpointRun(input: $input) {
          id
          status
        }
      }
    `;return(yield this.request(i,{input:{endpointId:e,input:JSON.stringify(t)}})).endpointRun})}getJobStatus(e){return a.__awaiter(this,void 0,void 0,function*(){let t=`
      query GetJob($input: EndpointJobStatusInput!) {
        endpointJobStatus(input: $input) {
          id
          status
          output
          error
        }
      }
    `;return(yield this.request(t,{input:{jobId:e}})).endpointJobStatus})}}t.RunPodClient=r},12529:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.SubscriptionService=void 0;let a=i(35914);class r{constructor(e,t){this.db=e,this.paymentRepo=t}createSubscription(e){return a.__awaiter(this,void 0,void 0,function*(){let t={userId:e.userId,finbySubscriptionId:e.finbySubscriptionId,tier:e.tier,status:"active",currentPeriodStart:e.currentPeriodStart,currentPeriodEnd:e.currentPeriodEnd,cancelAtPeriodEnd:!1};return yield this.paymentRepo.createSubscription(t)})}updateSubscription(e,t){return a.__awaiter(this,void 0,void 0,function*(){return yield this.paymentRepo.updateSubscription(e,Object.assign(Object.assign({},t),{updatedAt:new Date}))})}cancelSubscription(e){return a.__awaiter(this,arguments,void 0,function*(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=yield this.paymentRepo.getSubscriptionById(e);if(!i)throw Error(`Subscription not found: ${e}`);return t?yield this.paymentRepo.updateSubscription(e,{status:"cancelled",cancelledAt:new Date,expiredAt:new Date,cancelAtPeriodEnd:!1,updatedAt:new Date}):yield this.paymentRepo.updateSubscription(e,{cancelAtPeriodEnd:!0,cancelledAt:new Date,expiredAt:i.currentPeriodEnd||new Date,updatedAt:new Date})})}getCurrentSubscription(e){return a.__awaiter(this,void 0,void 0,function*(){return yield this.paymentRepo.getCurrentSubscription(e)})}getSubscriptionById(e){return a.__awaiter(this,void 0,void 0,function*(){return yield this.paymentRepo.getSubscriptionById(e)})}getUserSubscriptions(e){return a.__awaiter(this,void 0,void 0,function*(){return yield this.paymentRepo.getUserSubscriptions(e)})}renewSubscription(e,t){return a.__awaiter(this,void 0,void 0,function*(){let i=yield this.paymentRepo.getSubscriptionById(e);if(!i)throw Error(`Subscription not found: ${e}`);let a=i.currentPeriodEnd||new Date;return yield this.paymentRepo.updateSubscription(e,{currentPeriodStart:a,currentPeriodEnd:t,status:"active",updatedAt:new Date})})}}t.SubscriptionService=r},21543:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.useCanProceed=t.clearWizardStorage=t.useWizardProgress=t.useCurrentStep=t.useCharacterWizardStore=void 0;let a=i(68113),r=i(17418),o=i(81331),n=[{id:1,title:"Style",description:"Choose gender and style"},{id:2,title:"Ethnicity",description:"Select ethnicity"},{id:3,title:"Age Range",description:"Select age range"},{id:4,title:"Skin Color",description:"Select skin color"},{id:5,title:"Eye Color",description:"Select eye color"},{id:6,title:"Face Shape",description:"Select face shape"},{id:7,title:"Hair Style",description:"Select hair style"},{id:8,title:"Hair Color",description:"Select hair color"},{id:9,title:"Body Type",description:"Select body type"},{id:10,title:"Ass Size",description:"Select ass size"},{id:11,title:"Breast Size",description:"Select breast size"},{id:12,title:"Breast Type",description:"Select breast type"},{id:13,title:"Freckles",description:"Select freckles"},{id:14,title:"Scars",description:"Select scars"},{id:15,title:"Beauty Marks",description:"Select beauty marks"},{id:16,title:"Piercings",description:"Select piercings"},{id:17,title:"Tattoos",description:"Select tattoos"},{id:18,title:"Outfit",description:"Choose default outfit"},{id:19,title:"Archetype",description:"Choose persona type"},{id:20,title:"Personality",description:"Add name and personality"},{id:21,title:"Base Image",description:"Select your character face"},{id:22,title:"Finalize",description:"Review and create"}],s=[{id:1,title:"Prompt Input",description:"Describe your character"},{id:2,title:"Identity",description:"Name and personality"},{id:3,title:"Base Image",description:"Select your character face"},{id:4,title:"Finalize",description:"Review and create"}],l=[{id:1,title:"Request Influencer",description:"Submit request with consent and details"}];function d(e,t){let{form:i}=e,{creationMethod:a}=i;"prompt-based"===a?(t<=1&&(i.promptInput=void 0,i.name="",i.outfit=null,i.archetype=null,i.personalityTraits=[],i.bio="",e.baseImages=[],e.selectedBaseImageId=null,e.baseImageFineTunePrompt="",e.baseImageJobId=null,e.baseImageAllJobIds=null,e.baseImageGenerationStartedAt=null),t<=2&&(i.name="",i.outfit=null,i.archetype=null,i.personalityTraits=[],i.bio="",e.baseImages=[],e.selectedBaseImageId=null,e.baseImageFineTunePrompt="",e.baseImageJobId=null,e.baseImageAllJobIds=null,e.baseImageGenerationStartedAt=null),t<=3&&(e.baseImages=[],e.selectedBaseImageId=null,e.baseImageFineTunePrompt="",e.baseImageJobId=null,e.baseImageAllJobIds=null,e.baseImageGenerationStartedAt=null)):"presets"===a&&(t<=1&&(i.gender=null,i.style=null),t<=2&&(i.ethnicity=null),t<=3&&(i.ageRange=null,i.age=25),t<=4&&(i.skinColor=null),t<=5&&(i.eyeColor=null),t<=6&&(i.faceShape=null),t<=7&&(i.hairStyle=null),t<=8&&(i.hairColor=null),t<=9&&(i.bodyType=null),t<=10&&(i.assSize=null),t<=11&&(i.breastSize=null),t<=12&&(i.breastType=null),t<=13&&(i.freckles=null),t<=14&&(i.scars=null),t<=15&&(i.beautyMarks=null),t<=16&&(i.piercings=null),t<=17&&(i.tattoos=null),t<=18&&(i.name="",i.outfit=null,i.archetype=null,i.personalityTraits=[],i.bio=""),t<=19&&(e.baseImages=[],e.selectedBaseImageId=null,e.baseImageFineTunePrompt=""))}let u={creationMethod:null,promptInput:void 0,promptEnhance:!0,voiceMemoUrl:void 0,customAppearancePrompt:void 0,customIdentityPrompt:void 0,customImagePrompt:void 0,gender:"female",style:"realistic",ethnicity:null,ageRange:null,age:25,skinColor:null,eyeColor:null,faceShape:null,hairStyle:null,hairColor:null,bodyType:null,assSize:null,breastSize:null,breastType:null,freckles:null,scars:null,beautyMarks:null,piercings:null,tattoos:null,voice:null,videoContentOptions:[],name:"",outfit:null,archetype:null,personalityTraits:[],bio:"",nsfwEnabled:!1,aspectRatio:"9:16",loraTrainingEnabled:!0,selectedProfilePictureSetId:null,influencerRequestConsent:void 0,influencerRequestInstagram:void 0,influencerRequestTikTok:void 0,influencerRequestDescription:void 0};t.useCharacterWizardStore=(0,a.create)()((0,r.persist)((0,o.immer)((e,t)=>({step:0,steps:[],status:"idle",form:Object.assign({},u),characterId:null,baseImages:[],selectedBaseImageId:null,baseImageFineTunePrompt:"",baseImageJobId:null,baseImageAllJobIds:null,baseImageGenerationStartedAt:null,profilePictureSet:{jobId:null,images:[],generating:!1},setStep:t=>e(e=>{t<e.step&&d(e,t),e.step=t}),nextStep:()=>e(e=>{if(e.step<e.steps.length){let t=e.step+1,{form:i}=e;if("male"===i.gender)for(;11===t||12===t;)t+=1;t<=e.steps.length&&(e.step=t)}}),prevStep:()=>e(e=>{if(e.step>0){let t=e.step-1,{form:i}=e;if("male"===i.gender)for(;11===t||12===t;)t-=1;t>=1&&(d(e,t),e.step=t)}}),setStatus:t=>e(e=>{e.status=t}),setCharacterId:t=>e(e=>{e.characterId=t}),updateSteps:t=>e(e=>{"prompt-based"===t?e.steps=s:"ai"===t||"custom"===t?e.steps=s:"existing-person"===t?e.steps=l:e.steps=n,e.step=1}),setBaseImages:t=>e(e=>{e.baseImages=t}),selectBaseImage:t=>e(e=>{e.selectedBaseImageId=t}),setBaseImageFineTunePrompt:t=>e(e=>{e.baseImageFineTunePrompt=t}),replaceBaseImage:(t,i)=>e(e=>{let a=e.baseImages.findIndex(e=>e.id===t);-1!==a&&(e.baseImages[a]=i),e.selectedBaseImageId===t&&(e.selectedBaseImageId=i.id)}),setBaseImageJobIds:(t,i)=>e(e=>{e.baseImageJobId=t,e.baseImageAllJobIds=i,e.baseImageGenerationStartedAt=Date.now()}),clearBaseImageJobIds:()=>e(e=>{e.baseImageJobId=null,e.baseImageAllJobIds=null,e.baseImageGenerationStartedAt=null}),setProfilePictureSetGenerating:t=>e(e=>{e.profilePictureSet.generating=t}),setProfilePictureSetJobId:t=>e(e=>{e.profilePictureSet.jobId=t}),setProfilePictureSetImages:t=>e(e=>{e.profilePictureSet.images=t}),addProfilePicture:t=>e(e=>{e.profilePictureSet.images.push(t)}),removeProfilePicture:t=>e(e=>{e.profilePictureSet.images=e.profilePictureSet.images.filter(e=>e.id!==t)}),updateProfilePicture:(t,i)=>e(e=>{let a=e.profilePictureSet.images.findIndex(e=>e.id===t);-1!==a&&Object.assign(e.profilePictureSet.images[a],i)}),setField:(t,i)=>e(e=>{e.form[t]=i,"gender"===t&&(e.form.breastSize=null,e.form.breastType=null,e.form.bodyType=null,e.form.hairStyle=null)}),setFormData:t=>e(e=>{Object.assign(e.form,t)}),resetForm:()=>e(e=>{e.step=0,e.steps=[],e.status="idle",e.form=Object.assign({},u),e.characterId=null,e.baseImages=[],e.selectedBaseImageId=null,e.baseImageFineTunePrompt="",e.profilePictureSet={jobId:null,images:[],generating:!1}}),isStepValid:e=>{var i,a;let{form:r,steps:o}=t();if(!o.find(t=>t.id===e))return!1;if(0===e||!r.creationMethod)return!!r.creationMethod;if("prompt-based"===r.creationMethod)switch(e){case 1:return!!(null===(i=r.promptInput)||void 0===i?void 0:i.trim());case 2:return!!t().selectedBaseImageId;case 3:return!0;default:return!1}else if("ai"===r.creationMethod||"custom"===r.creationMethod)switch(e){case 1:case 3:return!0;case 2:return!!t().selectedBaseImageId;default:return!1}else switch(e){case 1:return!!r.gender&&!!r.style;case 2:return!!r.ethnicity;case 3:return!!r.ageRange;case 4:return!!r.skinColor;case 5:return!!r.eyeColor;case 6:return!!r.faceShape;case 7:return!!r.hairStyle;case 8:return!!r.hairColor;case 9:return!!r.bodyType;case 10:return!!r.assSize;case 11:return"male"===r.gender||!!r.breastSize;case 12:return"male"===r.gender||!!r.breastType;case 13:return!!r.freckles;case 14:return!!r.scars;case 15:return!!r.beautyMarks;case 16:return!!r.piercings;case 17:return!!r.tattoos;case 18:return!!r.outfit;case 19:return!!r.archetype;case 20:return!!(null===(a=r.name)||void 0===a?void 0:a.trim())&&r.personalityTraits.length>0;case 21:return!!t().selectedBaseImageId;case 22:return!0;default:return!1}},canProceed:()=>{let{step:e,isStepValid:i}=t();return i(e)},getNextStepNumber:()=>{let{step:e,steps:i,form:a}=t();if(e>=i.length)return null;let r=e+1;if("male"===a.gender)for(;11===r||12===r;)r+=1;return r<=i.length?r:null},getPrevStepNumber:()=>{let{step:e,form:i}=t();if(e<=1)return null;let a=e-1;if("male"===i.gender)for(;11===a||12===a;)a-=1;return a>=1?a:null},getEffectiveStepCount:()=>{let{steps:e,form:i}=t();return"male"===i.gender?e.length-2:e.length}})),{name:"ryla-character-wizard",storage:(0,r.createJSONStorage)(()=>{let e=localStorage;return{getItem:t=>{try{return e.getItem(t)}catch(e){return console.warn("Failed to read from localStorage:",e),null}},setItem:(t,i)=>{try{e.setItem(t,i)}catch(a){if(a instanceof DOMException&&"QuotaExceededError"===a.name){console.error("localStorage quota exceeded. Clearing old wizard data...");try{e.removeItem("ryla-character-wizard"),e.setItem(t,i)}catch(e){throw console.error("Failed to save after clearing storage:",e),Error("Storage quota exceeded. Please complete the wizard in one session or clear browser storage.")}}else throw a}},removeItem:t=>{try{e.removeItem(t)}catch(e){console.warn("Failed to remove from localStorage:",e)}}}}),partialize:e=>{let t=e.baseImages.map(e=>({id:e.id,url:e.thumbnailUrl||e.url,s3Key:e.s3Key})),i=e.profilePictureSet.images.map(e=>({id:e.id,positionId:e.positionId,positionName:e.positionName,url:e.thumbnailUrl||e.url,s3Key:e.s3Key}));return{step:e.step,status:e.status,form:e.form,characterId:e.characterId,baseImages:t,selectedBaseImageId:e.selectedBaseImageId,baseImageFineTunePrompt:e.baseImageFineTunePrompt,baseImageJobId:e.baseImageJobId,baseImageAllJobIds:e.baseImageAllJobIds,baseImageGenerationStartedAt:e.baseImageGenerationStartedAt,profilePictureSet:Object.assign(Object.assign({},e.profilePictureSet),{images:i})}},onRehydrateStorage:()=>e=>{e&&e.form.creationMethod&&0===e.steps.length&&("prompt-based"===e.form.creationMethod?e.steps=s:"presets"===e.form.creationMethod&&(e.steps=n))}})),t.useCurrentStep=()=>{let e=(0,t.useCharacterWizardStore)(e=>e.step),i=(0,t.useCharacterWizardStore)(e=>e.steps);return 0===i.length?null:i.find(t=>t.id===e)||i[0]||null},t.useWizardProgress=()=>{let e=(0,t.useCharacterWizardStore)(e=>e.step),i=(0,t.useCharacterWizardStore)(e=>e.getEffectiveStepCount);return 0===(0,t.useCharacterWizardStore)(e=>e.steps).length?0:Math.round(e/i()*100)},t.clearWizardStorage=()=>{try{localStorage.removeItem("ryla-character-wizard"),console.log("Wizard storage cleared")}catch(e){console.error("Failed to clear wizard storage:",e)}},t.useCanProceed=()=>{var e,i,a,r;let o=(0,t.useCharacterWizardStore)(e=>e.step),n=(0,t.useCharacterWizardStore)(e=>e.form),s=(0,t.useCharacterWizardStore)(e=>e.steps),l=(0,t.useCharacterWizardStore)(e=>e.selectedBaseImageId);if(!s.find(e=>e.id===o))return 0===o&&!!n.creationMethod;if(0===o||!n.creationMethod)return!!n.creationMethod;if("prompt-based"===n.creationMethod)switch(o){case 1:return!!(null===(e=n.promptInput)||void 0===e?void 0:e.trim());case 2:return!!(null===(i=n.name)||void 0===i?void 0:i.trim());case 3:return!!l;case 4:return!0;default:return!1}else if("ai"===n.creationMethod||"custom"===n.creationMethod)switch(o){case 1:case 4:return!0;case 2:return!!(null===(a=n.name)||void 0===a?void 0:a.trim());case 3:return!!l;default:return!1}else switch(o){case 1:return!!n.gender&&!!n.style;case 2:return!!n.ethnicity;case 3:return!!n.ageRange;case 4:return!!n.skinColor;case 5:return!!n.eyeColor;case 6:return!!n.faceShape;case 7:return!!n.hairStyle;case 8:return!!n.hairColor;case 9:return!!n.bodyType;case 10:return!!n.assSize;case 11:return"male"===n.gender||!!n.breastSize;case 12:return"male"===n.gender||!!n.breastType;case 13:return!!n.freckles;case 14:return!!n.scars;case 15:return!!n.beautyMarks;case 16:return!!n.piercings;case 17:return!!n.tattoos;case 18:return!!n.outfit;case 19:return!!n.archetype;case 20:return!!(null===(r=n.name)||void 0===r?void 0:r.trim())&&n.personalityTraits.length>0;case 21:return!!l;case 22:return!0;default:return!1}}},21138:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});let a=i(35914);a.__exportStar(i(21543),t),a.__exportStar(i(87545),t),a.__exportStar(i(91766),t),a.__exportStar(i(14603),t)},87545:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.useAllInfluencers=t.useInfluencerImages=t.useLikedPosts=t.useInfluencerPosts=t.useInfluencer=t.useInfluencerStore=void 0;let a=i(68113),r=i(17418),o=i(81331),n=i(92001);t.useInfluencerStore=(0,a.create)()((0,r.persist)((0,o.immer)((e,t)=>({influencers:[],posts:[],addInfluencer:t=>{e(e=>{e.influencers.push(t)})},updateInfluencer:(t,i)=>{e(e=>{let a=e.influencers.findIndex(e=>e.id===t);-1!==a&&(e.influencers[a]=Object.assign(Object.assign(Object.assign({},e.influencers[a]),i),{updatedAt:new Date().toISOString()}))})},deleteInfluencer:t=>{e(e=>{e.influencers=e.influencers.filter(e=>e.id!==t),e.posts=e.posts.filter(e=>e.influencerId!==t)})},addPost:t=>{e(e=>{e.posts.unshift(t);let i=e.influencers.find(e=>e.id===t.influencerId);i&&(i.postCount+=1,i.imageCount+=1,i.updatedAt=new Date().toISOString())})},toggleLike:t=>{e(e=>{let i=e.posts.find(e=>e.id===t);if(i){let t=i.isLiked;i.isLiked=!t;let a=e.influencers.find(e=>e.id===i.influencerId);a&&(a.likedCount+=t?-1:1)}})},deletePost:t=>{e(e=>{let i=e.posts.find(e=>e.id===t);if(i){let a=e.influencers.find(e=>e.id===i.influencerId);a&&(a.postCount-=1,a.imageCount-=1,i.isLiked&&(a.likedCount-=1)),e.posts=e.posts.filter(e=>e.id!==t)}})},getInfluencer:e=>t().influencers.find(t=>t.id===e),getInfluencerPosts:e=>t().posts.filter(t=>t.influencerId===e).sort((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime()),getLikedPosts:e=>t().posts.filter(t=>t.influencerId===e&&t.isLiked).sort((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime())})),{name:"ryla-influencer-store",storage:(0,r.createJSONStorage)(()=>localStorage)})),t.useInfluencer=e=>(0,t.useInfluencerStore)(t=>t.influencers.find(t=>t.id===e)),t.useInfluencerPosts=e=>(0,t.useInfluencerStore)((0,n.useShallow)(t=>t.posts.filter(t=>t.influencerId===e).sort((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime()))),t.useLikedPosts=e=>(0,t.useInfluencerStore)((0,n.useShallow)(t=>t.posts.filter(t=>t.influencerId===e&&t.isLiked).sort((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime()))),t.useInfluencerImages=e=>(0,t.useInfluencerStore)((0,n.useShallow)(t=>t.posts.filter(t=>t.influencerId===e).sort((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime()))),t.useAllInfluencers=()=>(0,t.useInfluencerStore)((0,n.useShallow)(e=>e.influencers))},91766:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.useProfilePictureJobs=t.useProfilePictures=t.useProfilePicturesStore=void 0;let a=i(68113),r=i(17418),o=i(81331),n=i(92001),s={"classic-influencer":"Classic Influencer","professional-model":"Professional Model","natural-beauty":"Natural Beauty"};t.useProfilePicturesStore=(0,a.create)()((0,r.persist)((0,o.immer)((e,t)=>({byInfluencerId:{},ensure:function(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"classic-influencer";e(e=>{e.byInfluencerId[t]||(e.byInfluencerId[t]={jobs:[],activeSetId:i,allImages:[]})})},startJob:(t,i)=>{e(e=>{e.byInfluencerId[t]||(e.byInfluencerId[t]={jobs:[],activeSetId:i.setId,allImages:[]});let a={id:i.jobId,setId:i.setId,setName:i.setName||s[i.setId],status:"generating",jobIds:i.jobIds,images:[],completedCount:0,totalCount:i.totalCount,nsfwEnabled:i.nsfwEnabled,startedAt:new Date().toISOString(),retryCount:0};e.byInfluencerId[t].jobs.push(a),e.byInfluencerId[t].activeSetId=i.setId})},updateJobProgress:(t,i,a)=>{e(e=>{let r=e.byInfluencerId[t];if(!r)return;let o=r.jobs.find(e=>e.id===i);o&&(o.completedCount=a)})},upsertJobImage:(t,i,a)=>{e(e=>{let r=e.byInfluencerId[t];if(!r)return;let o=r.jobs.find(e=>e.id===i);if(!o)return;let n=o.images.findIndex(e=>e.positionId===a.positionId&&e.isNSFW===a.isNSFW);-1===n?(o.images.push(a),o.completedCount=o.images.length):o.images[n]=Object.assign(Object.assign({},o.images[n]),a);let s=r.allImages.findIndex(e=>e.positionId===a.positionId&&e.isNSFW===a.isNSFW);-1===s?r.allImages.push(a):r.allImages[s]=Object.assign(Object.assign({},r.allImages[s]),a)})},completeJob:(t,i)=>{e(e=>{let a=e.byInfluencerId[t];if(!a)return;let r=a.jobs.find(e=>e.id===i);r&&(r.status="completed",r.completedAt=new Date().toISOString(),r.lastError=void 0)})},failJob:(t,i,a)=>{e(e=>{let r=e.byInfluencerId[t];if(!r)return;let o=r.jobs.find(e=>e.id===i);o&&(o.status="failed",o.lastError=a)})},retryJob:(t,i)=>{e(e=>{let a=e.byInfluencerId[t];if(!a)return;let r=a.jobs.find(e=>e.id===i);r&&"failed"===r.status&&(r.status="generating",r.lastError=void 0,r.retryCount=(r.retryCount||0)+1)})},cancelJob:(t,i)=>{e(e=>{let a=e.byInfluencerId[t];a&&(a.jobs=a.jobs.filter(e=>e.id!==i))})},clearCompletedJobs:t=>{e(e=>{let i=e.byInfluencerId[t];i&&(i.jobs=i.jobs.filter(e=>"generating"===e.status))})},start:(e,i)=>{var a;let r=`legacy-${Date.now()}`;t().startJob(e,{jobId:r,setId:i.setId,setName:s[i.setId],jobIds:i.jobIds,totalCount:null!==(a=i.totalCount)&&void 0!==a?a:i.jobIds.length,nsfwEnabled:!1})},updateProgress:(t,i)=>{e(e=>{let a=e.byInfluencerId[t];if(!a||0===a.jobs.length)return;let r=a.jobs.find(e=>"generating"===e.status);r&&(r.completedCount=i)})},upsertImage:(t,i)=>{e(e=>{let a=e.byInfluencerId[t];a||(e.byInfluencerId[t]={jobs:[],activeSetId:"classic-influencer",allImages:[]},a=e.byInfluencerId[t]);let r=a.jobs.find(e=>"generating"===e.status);if(r){let e=r.images.findIndex(e=>e.positionId===i.positionId&&e.isNSFW===i.isNSFW);-1===e?(r.images.push(i),r.completedCount=r.images.length):r.images[e]=Object.assign(Object.assign({},r.images[e]),i)}let o=a.allImages.findIndex(e=>e.positionId===i.positionId&&e.isNSFW===i.isNSFW);-1===o?a.allImages.push(i):a.allImages[o]=Object.assign(Object.assign({},a.allImages[o]),i)})},complete:t=>{e(e=>{let i=e.byInfluencerId[t];if(!i)return;let a=i.jobs.find(e=>"generating"===e.status);a&&(a.status="completed",a.completedAt=new Date().toISOString(),a.lastError=void 0)})},fail:(t,i)=>{e(e=>{let a=e.byInfluencerId[t];if(!a)return;let r=a.jobs.find(e=>"generating"===e.status);r&&(r.status="failed",r.lastError=i)})},reset:t=>{e(e=>{delete e.byInfluencerId[t]})}})),{name:"ryla-profile-pictures-store",storage:(0,r.createJSONStorage)(()=>localStorage)})),t.useProfilePictures=e=>{var i;let a=(0,t.useProfilePicturesStore)((0,n.useShallow)(t=>t.byInfluencerId[e]));if(!a)return;let r=Array.isArray(a.jobs)?a.jobs:[],o=Array.isArray(a.allImages)?a.allImages:[];if(a.status&&!Array.isArray(a.jobs))return{status:a.status,setId:a.setId||"classic-influencer",images:a.images||[],jobs:[],generatingJobs:[],failedJobs:[],completedJobs:[],completedCount:a.completedCount||0,totalCount:a.totalCount||0,lastError:a.lastError,isGenerating:"generating"===a.status,hasFailed:"failed"===a.status,hasCompleted:"completed"===a.status};let s=r.filter(e=>"generating"===e.status),l=r.filter(e=>"failed"===e.status),d=r.filter(e=>"completed"===e.status),u=s.length>0,c=l.length>0,p=d.length>0,g="idle";u?g="generating":c&&!p?g="failed":p&&(g="completed");let m=s.reduce((e,t)=>e+t.totalCount,0),h=s.reduce((e,t)=>e+t.completedCount,0);return{status:g,setId:a.activeSetId||"classic-influencer",images:o,jobs:r,generatingJobs:s,failedJobs:l,completedJobs:d,completedCount:h,totalCount:m,lastError:null===(i=l[0])||void 0===i?void 0:i.lastError,isGenerating:u,hasFailed:c,hasCompleted:p}},t.useProfilePictureJobs=e=>(0,t.useProfilePicturesStore)((0,n.useShallow)(t=>{let i=t.byInfluencerId[e];return Array.isArray(null==i?void 0:i.jobs)?i.jobs:[]}))},14603:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},91831:function(e,t){function i(e){return e&&t.WIZARD_FLOWS[e]?t.WIZARD_FLOWS[e]:null}function a(e,t){let a=i(e);if(a)return a.find(e=>e.id===t)}function r(e,t,i,r){let o=a(e,t);if(!o)return!1;for(let e of o.requiredToEnter)if("selectedBaseImageId"===e){if(!r.selectedBaseImageId)return!1}else if("baseImages"===e){if(!r.baseImages||0===r.baseImages.length)return!1}else{let t=i[e];if(null==t||""===t)return!1}return!0}function o(e,t,i,r){let o=a(e,t);if(!o)return!1;for(let e of o.requiredToProceed)if("selectedBaseImageId"===e){if(!r.selectedBaseImageId)return!1}else if("baseImages"===e){if(!r.baseImages||0===r.baseImages.length)return!1}else{let t=i[e];if(null==t||""===t||Array.isArray(t)&&0===t.length)return!1}return!0}Object.defineProperty(t,"__esModule",{value:!0}),t.WIZARD_FLOWS=t.EXISTING_PERSON_FLOW=t.PROMPT_BASED_FLOW=t.PRESETS_FLOW=void 0,t.getFlow=i,t.getStepConfig=a,t.getStepByRoute=function(e,t){let a=i(e);if(a)return a.find(e=>e.route===t)},t.getRouteByStepId=function(e,t){let i=a(e,t);return(null==i?void 0:i.route)||null},t.getNextRoute=function(e,t){let a=i(e);if(!a)return null;let r=a.findIndex(e=>e.id===t);return -1===r||r>=a.length-1?null:a[r+1].route},t.getPrevRoute=function(e,t){let a=i(e);if(!a)return"/wizard/step-0";let r=a.findIndex(e=>e.id===t);return r<=0?"/wizard/step-0":a[r-1].route},t.isValidStep=function(e,t){return void 0!==a(e,t)},t.getTotalSteps=function(e){let t=i(e);return(null==t?void 0:t.length)||0},t.getLastStepId=function(e){let t=i(e);return t&&0!==t.length?t[t.length-1].id:0},t.canEnterStep=r,t.canProceedFromStep=o,t.getFieldsToReset=function(e,t){let a=i(e);if(!a)return[];let r=[];for(let e of a)e.id>=t&&r.push(...e.resetOnBack);return[...new Set(r)]},t.getFirstIncompleteStep=function(e,t,a){let n=i(e);if(!n)return null;for(let i of n){if(!r(e,i.id,t,a)){let e=n.findIndex(e=>e.id===i.id)-1;return e>=0?n[e]:n[0]}if(!o(e,i.id,t,a))return i}return n[n.length-1]},t.getComponentName=function(e,t){let i=a(e,t);return(null==i?void 0:i.component)||null},t.PRESETS_FLOW=[{id:1,route:"/wizard/step-1",title:"Style",description:"Choose gender and style",component:"StepStyle",requiredToEnter:[],requiredToProceed:["gender","style"],resetOnBack:["gender","style"]},{id:2,route:"/wizard/step-2",title:"Basic Appearance",description:"Ethnicity, age, and skin color",component:"StepGeneral",requiredToEnter:["gender","style"],requiredToProceed:["ethnicity"],resetOnBack:["ethnicity","ageRange","age","skinColor"]},{id:3,route:"/wizard/step-3",title:"Facial Features",description:"Eye color and face shape",component:"StepFace",requiredToEnter:["ethnicity"],requiredToProceed:["eyeColor"],resetOnBack:["eyeColor","faceShape"]},{id:4,route:"/wizard/step-4",title:"Hair",description:"Hair style and color",component:"StepHair",requiredToEnter:["eyeColor"],requiredToProceed:["hairStyle","hairColor"],resetOnBack:["hairStyle","hairColor"]},{id:5,route:"/wizard/step-5",title:"Body",description:"Body type and proportions",component:"StepBody",requiredToEnter:["hairStyle"],requiredToProceed:["bodyType"],resetOnBack:["bodyType","assSize","breastSize","breastType"]},{id:6,route:"/wizard/step-6",title:"Skin Features",description:"Freckles, scars, and beauty marks",component:"StepSkinFeatures",requiredToEnter:["bodyType"],requiredToProceed:[],resetOnBack:["freckles","scars","beautyMarks"]},{id:7,route:"/wizard/step-7",title:"Body Modifications",description:"Piercings and tattoos",component:"StepBodyModifications",requiredToEnter:[],requiredToProceed:[],resetOnBack:["piercings","tattoos"]},{id:8,route:"/wizard/step-8",title:"Identity",description:"Name, outfit, and personality",component:"StepIdentity",requiredToEnter:[],requiredToProceed:["name","outfit","archetype"],resetOnBack:["name","outfit","archetype","personalityTraits","bio"]},{id:9,route:"/wizard/step-9",title:"Base Image",description:"Generate and select your character face",component:"StepBaseImageSelection",requiredToEnter:["name"],requiredToProceed:["selectedBaseImageId"],resetOnBack:["baseImages","selectedBaseImageId","baseImageFineTunePrompt"]},{id:10,route:"/wizard/step-10",title:"Finalize",description:"Review and create your character",component:"StepFinalize",requiredToEnter:["selectedBaseImageId"],requiredToProceed:[],resetOnBack:[]}],t.PROMPT_BASED_FLOW=[{id:1,route:"/wizard/step-1",title:"Prompt Input",description:"Describe your character",component:"StepPromptInput",requiredToEnter:[],requiredToProceed:["promptInput"],resetOnBack:["promptInput","promptEnhance"]},{id:2,route:"/wizard/step-2",title:"Identity",description:"Name and personality",component:"StepIdentity",requiredToEnter:["promptInput"],requiredToProceed:["name"],resetOnBack:["name","outfit","archetype","personalityTraits","bio"]},{id:3,route:"/wizard/step-3",title:"Base Image",description:"Select your character face",component:"StepBaseImageSelection",requiredToEnter:["name"],requiredToProceed:["selectedBaseImageId"],resetOnBack:["baseImages","selectedBaseImageId","baseImageFineTunePrompt","baseImageJobId","baseImageAllJobIds"]},{id:4,route:"/wizard/step-4",title:"Finalize",description:"Review and create your character",component:"StepFinalize",requiredToEnter:["selectedBaseImageId"],requiredToProceed:[],resetOnBack:[]}],t.EXISTING_PERSON_FLOW=[{id:1,route:"/wizard/step-1",title:"Request Influencer",description:"Submit request with consent and details",component:"StepInfluencerRequest",requiredToEnter:[],requiredToProceed:["influencerRequestConsent"],resetOnBack:["influencerRequestConsent","influencerRequestInstagram","influencerRequestTikTok","influencerRequestDescription"]}],t.WIZARD_FLOWS={presets:t.PRESETS_FLOW,"prompt-based":t.PROMPT_BASED_FLOW,"existing-person":t.EXISTING_PERSON_FLOW}},64367:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),i(35914).__exportStar(i(91831),t)},13825:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.buildFluxInpaintWorkflow=function(e){let{prompt:t,negativePrompt:i="",imageFilename:a,seed:r=Math.floor(4294967296*Math.random()),steps:o=20,cfg:n=1,guidance:s=30,filenamePrefix:l="ryla_inpaint"}=e;return{1:{class_type:"UNETLoader",inputs:{unet_name:"flux1-fill-dev.safetensors",weight_dtype:"default"},_meta:{title:"Load Flux Fill UNet"}},2:{class_type:"DualCLIPLoader",inputs:{clip_name1:"clip_l.safetensors",clip_name2:"t5xxl_fp16.safetensors",type:"flux",device:"default"},_meta:{title:"Load Flux Text Encoders"}},3:{class_type:"VAELoader",inputs:{vae_name:"ae.safetensors"},_meta:{title:"Load VAE"}},4:{class_type:"CLIPTextEncode",inputs:{text:t,clip:["2",0]},_meta:{title:"Positive Prompt"}},5:{class_type:"CLIPTextEncode",inputs:{text:i,clip:["2",0]},_meta:{title:"Negative Prompt"}},6:{class_type:"FluxGuidance",inputs:{conditioning:["4",0],guidance:s},_meta:{title:"Flux Guidance"}},7:{class_type:"LoadImage",inputs:{image:a},_meta:{title:"Load Image + Mask"}},8:{class_type:"InpaintModelConditioning",inputs:{positive:["6",0],negative:["5",0],vae:["3",0],pixels:["7",0],mask:["7",1]},_meta:{title:"Inpaint Conditioning"}},9:{class_type:"DifferentialDiffusion",inputs:{model:["1",0]},_meta:{title:"Differential Diffusion"}},10:{class_type:"KSampler",inputs:{model:["9",0],positive:["8",0],negative:["8",1],latent_image:["8",2],seed:r,steps:o,cfg:n,sampler_name:"euler",scheduler:"normal",denoise:1},_meta:{title:"KSampler"}},11:{class_type:"VAEDecode",inputs:{samples:["10",0],vae:["3",0]},_meta:{title:"VAE Decode"}},12:{class_type:"SaveImage",inputs:{filename_prefix:l,images:["11",0]},_meta:{title:"Save Image"}}}}},73910:function(e,t){function i(e){let{prompt:t,negativePrompt:i="",width:a=1024,height:r=1024,steps:o=20,cfg:n=1,seed:s=Math.floor(4294967296*Math.random()),lora:l,filenamePrefix:d="ryla_flux_pulid",referenceImage:u,pulidStrength:c=.8,pulidStart:p=0,pulidEnd:g=1,fluxModel:m="dev",guidance:h=3.5}=e;if(!u)throw Error("PuLID workflow requires a reference image");let f={1:{class_type:"UNETLoader",inputs:{unet_name:"schnell"===m?"flux1-schnell.safetensors":"flux1-dev.safetensors",weight_dtype:"default"},_meta:{title:"Load FLUX Diffusion Model"}},2:{class_type:"DualCLIPLoader",inputs:{clip_name1:"clip_l.safetensors",clip_name2:"t5xxl_fp16.safetensors",type:"flux",device:"default"},_meta:{title:"Load FLUX Text Encoders"}},3:{class_type:"VAELoader",inputs:{vae_name:"ae.safetensors"},_meta:{title:"Load FLUX VAE"}},20:{class_type:"PulidFluxModelLoader",inputs:{pulid_file:"pulid_flux_v0.9.1.safetensors"},_meta:{title:"Load PuLID Model"}},21:{class_type:"PulidFluxInsightFaceLoader",inputs:{provider:"CPU"},_meta:{title:"Load InsightFace"}},22:{class_type:"PulidFluxEvaClipLoader",inputs:{},_meta:{title:"Load EVA CLIP"}},23:{class_type:"LoadImage",inputs:{image:u},_meta:{title:"Load Reference Image"}},24:{class_type:"ApplyPulidFlux",inputs:{model:["1",0],pulid_flux:["20",0],eva_clip:["22",0],face_analysis:["21",0],image:["23",0],weight:c,start_at:p,end_at:g},_meta:{title:"Apply PuLID"}},28:{class_type:"FixPulidFluxPatch",inputs:{model:["24",0]},_meta:{title:"Fix PuLID Flux Patch"}},4:{class_type:"CLIPTextEncode",inputs:{text:t,clip:["2",0]},_meta:{title:"Positive Prompt"}},5:{class_type:"CLIPTextEncode",inputs:{text:i,clip:["2",0]},_meta:{title:"Negative Prompt"}},6:{class_type:"FluxGuidance",inputs:{conditioning:["4",0],guidance:h},_meta:{title:"FLUX Guidance"}},7:{class_type:"EmptyLatentImage",inputs:{width:a,height:r,batch_size:1},_meta:{title:"Empty Latent"}},8:{class_type:"KSampler",inputs:{seed:s,steps:o,cfg:n,sampler_name:"euler",scheduler:"normal",denoise:1,model:["28",0],positive:["6",0],negative:["5",0],latent_image:["7",0]},_meta:{title:"KSampler (FLUX PuLID)"}},9:{class_type:"VAEDecode",inputs:{samples:["8",0],vae:["3",0]},_meta:{title:"VAE Decode"}},10:{class_type:"SaveImage",inputs:{filename_prefix:d,images:["9",0]},_meta:{title:"Save Image"}}};return l&&(f["30"]={class_type:"LoraLoader",inputs:{model:["28",0],clip:["2",0],lora_name:l.name,strength_model:l.strength,strength_clip:l.strength},_meta:{title:`LoRA: ${l.name}`}},f["4"].inputs.clip=["30",1],f["5"].inputs.clip=["30",1],f["8"].inputs.model=["30",0]),f}Object.defineProperty(t,"__esModule",{value:!0}),t.fluxPuLIDDefinition=void 0,t.buildFluxPuLIDWorkflow=i,t.fluxPuLIDDefinition={id:"flux-pulid",name:"FLUX with PuLID (Face Consistency)",description:"FLUX model with PuLID for maintaining face/identity consistency from a reference image. This is the correct implementation - PuLID was designed for FLUX models.",requiredModels:{diffusion:"flux1-dev.safetensors",textEncoder:"clip_l.safetensors, t5xxl_fp16.safetensors",vae:"ae.safetensors"},requiredNodes:["PulidFluxModelLoader","PulidFluxInsightFaceLoader","PulidFluxEvaClipLoader","ApplyPulidFlux","FixPulidFluxPatch","LoadImage","DualCLIPLoader","FluxGuidance","KSampler"],defaults:{width:1024,height:1024,steps:20,cfg:1},workflow:i({prompt:"{{prompt}}",referenceImage:"{{referenceImage}}",width:1024,height:1024})}},91905:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});let a=i(35914);a.__exportStar(i(66367),t),a.__exportStar(i(39394),t),a.__exportStar(i(99729),t),a.__exportStar(i(10902),t),a.__exportStar(i(66630),t),a.__exportStar(i(61076),t),a.__exportStar(i(13825),t),a.__exportStar(i(73910),t),a.__exportStar(i(37450),t)},37450:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.PULID_REQUIRED_MODELS=t.workflowBuilders=t.workflowDefinitions=t.REFERENCE_IMAGE_WORKFLOWS=void 0,t.getWorkflowDefinition=n,t.buildWorkflow=function(e,i){let a=t.workflowBuilders[e];if(!a)throw Error(`Unknown workflow: ${e}`);return a(i)},t.listWorkflows=function(){return Object.values(t.workflowDefinitions)},t.checkWorkflowCompatibility=s,t.getRecommendedWorkflow=function(e){let{compatible:t}=s("z-image-danrisi",e);return t?"z-image-danrisi":"z-image-simple"};let a=i(39394),r=i(99729),o=i(10902);function n(e){let i=t.workflowDefinitions[e];if(!i)throw Error(`Unknown workflow: ${e}`);return i}function s(e,t){let i=n(e),a=[];for(let e of Array.from(new Set(Object.values(i.workflow).map(e=>e.class_type))))t.includes(e)||a.push(e);return{compatible:0===a.length,missingNodes:a}}Object.defineProperty(t,"PULID_REQUIRED_MODELS",{enumerable:!0,get:function(){return o.PULID_REQUIRED_MODELS}}),t.REFERENCE_IMAGE_WORKFLOWS=["z-image-pulid"],t.workflowDefinitions={"z-image-danrisi":a.zImageDanrisiDefinition,"z-image-simple":r.zImageSimpleDefinition,"z-image-pulid":o.zImagePuLIDDefinition},t.workflowBuilders={"z-image-danrisi":a.buildZImageDanrisiWorkflow,"z-image-simple":r.buildZImageSimpleWorkflow,"z-image-pulid":o.buildZImagePuLIDWorkflow}},66367:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},39394:function(e,t){function i(e){let{prompt:t,negativePrompt:i="",width:a=1024,height:r=1024,steps:o=20,cfg:n=1,seed:s=Math.floor(4294967296*Math.random()),lora:l,filenamePrefix:d="ryla_output"}=e,u={1:{class_type:"UNETLoader",inputs:{unet_name:"z_image_turbo_bf16.safetensors",weight_dtype:"default"},_meta:{title:"Load Diffusion Model"}},2:{class_type:"CLIPLoader",inputs:{clip_name:"qwen_3_4b.safetensors",type:"lumina2",device:"default"},_meta:{title:"Load CLIP"}},3:{class_type:"VAELoader",inputs:{vae_name:"z-image-turbo-vae.safetensors"},_meta:{title:"Load VAE"}},4:{class_type:"CLIPTextEncode",inputs:{text:t,clip:["2",0]},_meta:{title:"Positive Prompt"}},5:{class_type:"CLIPTextEncode",inputs:{text:i,clip:["2",0]},_meta:{title:"Negative Prompt"}},6:{class_type:"ConditioningZeroOut",inputs:{conditioning:["5",0]},_meta:{title:"Zero Out Negative"}},7:{class_type:"EmptySD3LatentImage",inputs:{width:a,height:r,batch_size:1},_meta:{title:"Empty Latent"}},8:{class_type:"BetaSamplingScheduler",inputs:{model:["1",0],steps:o,alpha:.4,beta:.4},_meta:{title:"Beta Scheduler"}},9:{class_type:"Sigmas Rescale",inputs:{sigmas:["8",0],start:.996,end:0},_meta:{title:"Sigmas Rescale"}},10:{class_type:"ClownsharKSampler_Beta",inputs:{eta:.5,sampler_name:"linear/ralston_2s",scheduler:"beta",steps:o,steps_to_run:-1,denoise:1,cfg:n,seed:s,sampler_mode:"standard",bongmath:!0,model:["1",0],positive:["4",0],negative:["6",0],latent_image:["7",0],sigmas:["9",0]},_meta:{title:"ClownsharK Sampler"}},11:{class_type:"VAEDecode",inputs:{samples:["10",0],vae:["3",0]},_meta:{title:"VAE Decode"}},12:{class_type:"SaveImage",inputs:{filename_prefix:d,images:["11",0]},_meta:{title:"Save Image"}}};return l&&(u["20"]={class_type:"LoraLoader",inputs:{model:["1",0],clip:["2",0],lora_name:l.name,strength_model:l.strength,strength_clip:l.strength},_meta:{title:`LoRA: ${l.name}`}},u["4"].inputs.clip=["20",1],u["5"].inputs.clip=["20",1],u["8"].inputs.model=["20",0],u["10"].inputs.model=["20",0]),u}Object.defineProperty(t,"__esModule",{value:!0}),t.zImageDanrisiDefinition=void 0,t.buildZImageDanrisiWorkflow=i,t.zImageDanrisiDefinition={id:"z-image-danrisi",name:"Z-Image Danrisi Modified Loaders",description:"Optimized Z-Image-Turbo workflow with ClownsharKSampler_Beta, BetaSamplingScheduler, and Sigmas Rescale. Requires res4lyf custom nodes.",requiredModels:{diffusion:"z_image_turbo_bf16.safetensors",textEncoder:"qwen_3_4b.safetensors",vae:"z-image-turbo-vae.safetensors"},requiredNodes:["ClownsharKSampler_Beta","Sigmas Rescale","BetaSamplingScheduler"],defaults:{width:1024,height:1024,steps:20,cfg:1},workflow:i({prompt:"{{prompt}}",width:1024,height:1024})}},61076:function(e,t){function i(e){let{prompt:t,negativePrompt:i="",width:a=1024,height:r=1024,steps:o=20,cfg:n=1,seed:s=Math.floor(4294967296*Math.random()),lora:l,filenamePrefix:d="ryla_instantid",referenceImage:u,instantidStrength:c=.8,controlnetStrength:p=.8,faceProvider:g="CPU"}=e;if(!u)throw Error("InstantID workflow requires a reference image");let m={1:{class_type:"UNETLoader",inputs:{unet_name:"z_image_turbo_bf16.safetensors",weight_dtype:"default"},_meta:{title:"Load Z-Image Diffusion Model"}},2:{class_type:"CLIPLoader",inputs:{clip_name:"qwen_3_4b.safetensors",type:"lumina2",device:"default"},_meta:{title:"Load CLIP"}},3:{class_type:"VAELoader",inputs:{vae_name:"z-image-turbo-vae.safetensors"},_meta:{title:"Load VAE"}},20:{class_type:"InsightFaceLoader",inputs:{provider:g},_meta:{title:"Load InsightFace"}},21:{class_type:"InstantIDModelLoader",inputs:{instantid_file:"ip-adapter.bin"},_meta:{title:"Load InstantID IP-Adapter"}},22:{class_type:"InstantIDControlNetLoader",inputs:{controlnet_name:"diffusion_pytorch_model.safetensors"},_meta:{title:"Load InstantID ControlNet"}},23:{class_type:"LoadImage",inputs:{image:u},_meta:{title:"Load Reference Image"}},24:{class_type:"ApplyInstantID",inputs:{insightface:["20",0],instantid:["21",0],controlnet:["22",0],image:["23",0],weight:c,controlnet_conditioning_scale:p},_meta:{title:"Apply InstantID"}},4:{class_type:"CLIPTextEncode",inputs:{text:t,clip:["2",0]},_meta:{title:"Positive Prompt"}},5:{class_type:"CLIPTextEncode",inputs:{text:i,clip:["2",0]},_meta:{title:"Negative Prompt"}},6:{class_type:"ConditioningZeroOut",inputs:{conditioning:["5",0]},_meta:{title:"Zero Out Negative"}},25:{class_type:"ConditioningCombine",inputs:{conditioning_1:["4",0],conditioning_2:["24",0]},_meta:{title:"Combine Prompt + InstantID"}},26:{class_type:"ControlNetApplyAdvanced",inputs:{positive:["25",0],negative:["6",0],control_net:["22",0],image:["24",1],strength:p,start_percent:0,end_percent:1},_meta:{title:"Apply InstantID ControlNet"}},7:{class_type:"EmptySD3LatentImage",inputs:{width:a,height:r,batch_size:1},_meta:{title:"Empty Latent"}},8:{class_type:"KSampler",inputs:{seed:s,steps:o,cfg:n,sampler_name:"euler",scheduler:"normal",denoise:1,model:["1",0],positive:["26",0],negative:["26",1],latent_image:["7",0]},_meta:{title:"KSampler"}},9:{class_type:"VAEDecode",inputs:{samples:["8",0],vae:["3",0]},_meta:{title:"VAE Decode"}},10:{class_type:"SaveImage",inputs:{filename_prefix:d,images:["9",0]},_meta:{title:"Save Image"}}};return l&&(m["30"]={class_type:"LoraLoader",inputs:{model:["1",0],clip:["2",0],lora_name:l.name,strength_model:l.strength,strength_clip:l.strength},_meta:{title:`LoRA: ${l.name}`}},m["4"].inputs.clip=["30",1],m["5"].inputs.clip=["30",1],m["8"].inputs.model=["30",0]),m}Object.defineProperty(t,"__esModule",{value:!0}),t.zImageInstantIDDefinition=void 0,t.buildZImageInstantIDWorkflow=i,t.zImageInstantIDDefinition={id:"z-image-instantid",name:"Z-Image with InstantID (Face Consistency)",description:"Z-Image-Turbo with InstantID for maintaining face/identity consistency. Better than PuLID for single-image workflows and extreme angles.",requiredModels:{diffusion:"z_image_turbo_bf16.safetensors",textEncoder:"qwen_3_4b.safetensors",vae:"z-image-turbo-vae.safetensors"},requiredNodes:["InsightFaceLoader","InstantIDModelLoader","InstantIDControlNetLoader","ApplyInstantID","LoadImage","KSampler","ConditioningCombine","ControlNetApplyAdvanced"],defaults:{width:1024,height:1024,steps:20,cfg:1},workflow:i({prompt:"{{prompt}}",referenceImage:"{{referenceImage}}",width:1024,height:1024})}},66630:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.buildZImagePuLIDWorkflowWithKSampler=function(e){let{prompt:t,negativePrompt:i="",width:a=1024,height:r=1024,steps:o=20,cfg:n=1,seed:s=Math.floor(4294967296*Math.random()),lora:l,filenamePrefix:d="ryla_pulid",referenceImage:u,pulidStrength:c=.8,pulidStart:p=0,pulidEnd:g=.8}=e;if(!u)throw Error("PuLID workflow requires a reference image");let m={1:{class_type:"UNETLoader",inputs:{unet_name:"z_image_turbo_bf16.safetensors",weight_dtype:"default"},_meta:{title:"Load Diffusion Model"}},2:{class_type:"CLIPLoader",inputs:{clip_name:"qwen_3_4b.safetensors",type:"lumina2",device:"default"},_meta:{title:"Load CLIP"}},3:{class_type:"VAELoader",inputs:{vae_name:"z-image-turbo-vae.safetensors"},_meta:{title:"Load VAE"}},20:{class_type:"PulidFluxModelLoader",inputs:{pulid_file:"pulid_flux_v0.9.1.safetensors"},_meta:{title:"Load PuLID Model"}},21:{class_type:"PulidFluxInsightFaceLoader",inputs:{provider:"CPU"},_meta:{title:"Load InsightFace"}},22:{class_type:"PulidFluxEvaClipLoader",inputs:{},_meta:{title:"Load EVA CLIP"}},23:{class_type:"LoadImage",inputs:{image:u},_meta:{title:"Load Reference Image"}},24:{class_type:"ApplyPulidFlux",inputs:{model:["1",0],pulid_flux:["20",0],eva_clip:["22",0],face_analysis:["21",0],image:["23",0],weight:c,start_at:p,end_at:g},_meta:{title:"Apply PuLID"}},28:{class_type:"FixPulidFluxPatch",inputs:{model:["24",0]},_meta:{title:"Fix PuLID Flux Patch"}},4:{class_type:"CLIPTextEncode",inputs:{text:t,clip:["2",0]},_meta:{title:"Positive Prompt"}},5:{class_type:"CLIPTextEncode",inputs:{text:i,clip:["2",0]},_meta:{title:"Negative Prompt"}},6:{class_type:"ConditioningZeroOut",inputs:{conditioning:["5",0]},_meta:{title:"Zero Out Negative"}},7:{class_type:"EmptySD3LatentImage",inputs:{width:a,height:r,batch_size:1},_meta:{title:"Empty Latent"}},8:{class_type:"KSampler",inputs:{seed:s,steps:o,cfg:n,sampler_name:"euler",scheduler:"normal",denoise:1,model:["24",0],positive:["4",0],negative:["6",0],latent_image:["7",0]},_meta:{title:"KSampler (PuLID compatible)"}},9:{class_type:"VAEDecode",inputs:{samples:["8",0],vae:["3",0]},_meta:{title:"VAE Decode"}},10:{class_type:"SaveImage",inputs:{filename_prefix:d,images:["9",0]},_meta:{title:"Save Image"}}};return l&&(m["30"]={class_type:"LoraLoader",inputs:{model:["28",0],clip:["2",0],lora_name:l.name,strength_model:l.strength,strength_clip:l.strength},_meta:{title:`LoRA: ${l.name}`}},m["4"].inputs.clip=["30",1],m["5"].inputs.clip=["30",1],m["8"].inputs.model=["30",0]),m}},10902:function(e,t){function i(e){let{prompt:t,negativePrompt:i="",width:a=1024,height:r=1024,steps:o=20,cfg:n=1,seed:s=Math.floor(4294967296*Math.random()),lora:l,filenamePrefix:d="ryla_pulid",referenceImage:u,pulidStrength:c=.8,pulidStart:p=0,pulidEnd:g=1}=e;if(!u)throw Error("PuLID workflow requires a reference image");let m={1:{class_type:"UNETLoader",inputs:{unet_name:"z_image_turbo_bf16.safetensors",weight_dtype:"default"},_meta:{title:"Load Diffusion Model"}},2:{class_type:"CLIPLoader",inputs:{clip_name:"qwen_3_4b.safetensors",type:"lumina2",device:"default"},_meta:{title:"Load CLIP"}},3:{class_type:"VAELoader",inputs:{vae_name:"z-image-turbo-vae.safetensors"},_meta:{title:"Load VAE"}},20:{class_type:"PulidFluxModelLoader",inputs:{pulid_file:"pulid_flux_v0.9.1.safetensors"},_meta:{title:"Load PuLID Model"}},21:{class_type:"PulidFluxInsightFaceLoader",inputs:{provider:"CPU"},_meta:{title:"Load InsightFace"}},22:{class_type:"PulidFluxEvaClipLoader",inputs:{},_meta:{title:"Load EVA CLIP"}},23:{class_type:"LoadImage",inputs:{image:u},_meta:{title:"Load Reference Image"}},24:{class_type:"ApplyPulidFlux",inputs:{model:["1",0],pulid_flux:["20",0],eva_clip:["22",0],face_analysis:["21",0],image:["23",0],weight:c,start_at:p,end_at:g},_meta:{title:"Apply PuLID"}},28:{class_type:"FixPulidFluxPatch",inputs:{model:["24",0]},_meta:{title:"Fix PuLID Flux Patch"}},4:{class_type:"CLIPTextEncode",inputs:{text:t,clip:["2",0]},_meta:{title:"Positive Prompt"}},5:{class_type:"CLIPTextEncode",inputs:{text:i,clip:["2",0]},_meta:{title:"Negative Prompt"}},6:{class_type:"ConditioningZeroOut",inputs:{conditioning:["5",0]},_meta:{title:"Zero Out Negative"}},7:{class_type:"EmptySD3LatentImage",inputs:{width:a,height:r,batch_size:1},_meta:{title:"Empty Latent"}},8:{class_type:"BetaSamplingScheduler",inputs:{model:["28",0],steps:o,alpha:.4,beta:.4},_meta:{title:"Beta Scheduler"}},9:{class_type:"Sigmas Rescale",inputs:{sigmas:["8",0],start:.996,end:0},_meta:{title:"Sigmas Rescale"}},10:{class_type:"ClownsharKSampler_Beta",inputs:{eta:.5,sampler_name:"linear/ralston_2s",scheduler:"beta",steps:o,steps_to_run:-1,denoise:1,cfg:n,seed:s,sampler_mode:"standard",bongmath:!0,model:["28",0],positive:["4",0],negative:["6",0],latent_image:["7",0],sigmas:["9",0]},_meta:{title:"ClownsharK Sampler"}},11:{class_type:"VAEDecode",inputs:{samples:["10",0],vae:["3",0]},_meta:{title:"VAE Decode"}},12:{class_type:"SaveImage",inputs:{filename_prefix:d,images:["11",0]},_meta:{title:"Save Image"}}};return l&&(m["30"]={class_type:"LoraLoader",inputs:{model:["28",0],clip:["2",0],lora_name:l.name,strength_model:l.strength,strength_clip:l.strength},_meta:{title:`LoRA: ${l.name}`}},m["4"].inputs.clip=["30",1],m["5"].inputs.clip=["30",1],m["8"].inputs.model=["30",0],m["10"].inputs.model=["30",0]),m}Object.defineProperty(t,"__esModule",{value:!0}),t.PULID_REQUIRED_MODELS=t.zImagePuLIDDefinition=void 0,t.buildZImagePuLIDWorkflow=i,t.zImagePuLIDDefinition={id:"z-image-pulid",name:"Z-Image with PuLID (Face Consistency)",description:"Z-Image-Turbo with PuLID for maintaining face/identity consistency from a reference image. Requires ComfyUI-PuLID custom nodes.",requiredModels:{diffusion:"z_image_turbo_bf16.safetensors",textEncoder:"qwen_3_4b.safetensors",vae:"z-image-turbo-vae.safetensors"},requiredNodes:["PulidFluxModelLoader","PulidFluxInsightFaceLoader","PulidFluxEvaClipLoader","ApplyPulidFlux","FixPulidFluxPatch","LoadImage","ClownsharKSampler_Beta","Sigmas Rescale","BetaSamplingScheduler"],defaults:{width:1024,height:1024,steps:20,cfg:1},workflow:i({prompt:"{{prompt}}",referenceImage:"{{referenceImage}}",width:1024,height:1024})},t.PULID_REQUIRED_MODELS={pulid:{name:"pulid_flux_v0.9.1.safetensors",url:"https://huggingface.co/huchenlei/PuLID/resolve/main/pulid_flux_v0.9.1.safetensors",size:"1.2GB",path:"models/pulid/"},evaClip:{name:"eva02_clip_l_14_plus.safetensors",url:"https://huggingface.co/QuanSun/EVA-CLIP/resolve/main/EVA02_CLIP_L_336_psz14_s6B.pt",size:"700MB",path:"models/clip/"},insightface:{name:"antelopev2",url:"https://huggingface.co/MonsterMMORPG/tools/tree/main/antelopev2",size:"360MB",path:"models/insightface/models/"}}},99729:function(e,t){function i(e){let{prompt:t,negativePrompt:i="",width:a=1024,height:r=1024,steps:o=9,cfg:n=1,seed:s=Math.floor(4294967296*Math.random()),lora:l,filenamePrefix:d="ryla_output"}=e,u={1:{class_type:"UNETLoader",inputs:{unet_name:"z_image_turbo_bf16.safetensors",weight_dtype:"default"},_meta:{title:"Load Diffusion Model"}},2:{class_type:"CLIPLoader",inputs:{clip_name:"qwen_3_4b.safetensors",type:"sd3",device:"default"},_meta:{title:"Load CLIP"}},3:{class_type:"VAELoader",inputs:{vae_name:"z-image-turbo-vae.safetensors"},_meta:{title:"Load VAE"}},4:{class_type:"CLIPTextEncode",inputs:{text:t,clip:["2",0]},_meta:{title:"Positive Prompt"}},5:{class_type:"CLIPTextEncode",inputs:{text:i,clip:["2",0]},_meta:{title:"Negative Prompt"}},6:{class_type:"EmptySD3LatentImage",inputs:{width:a,height:r,batch_size:1},_meta:{title:"Empty Latent"}},7:{class_type:"KSampler",inputs:{model:["1",0],positive:["4",0],negative:["5",0],latent_image:["6",0],seed:s,steps:o,cfg:n,sampler_name:"euler",scheduler:"simple",denoise:1},_meta:{title:"KSampler"}},8:{class_type:"VAEDecode",inputs:{samples:["7",0],vae:["3",0]},_meta:{title:"VAE Decode"}},9:{class_type:"SaveImage",inputs:{filename_prefix:d,images:["8",0]},_meta:{title:"Save Image"}}};return l&&(u["20"]={class_type:"LoraLoader",inputs:{model:["1",0],clip:["2",0],lora_name:l.name,strength_model:l.strength,strength_clip:l.strength},_meta:{title:`LoRA: ${l.name}`}},u["4"].inputs.clip=["20",1],u["5"].inputs.clip=["20",1],u["7"].inputs.model=["20",0]),u}Object.defineProperty(t,"__esModule",{value:!0}),t.zImageSimpleDefinition=void 0,t.buildZImageSimpleWorkflow=i,t.zImageSimpleDefinition={id:"z-image-simple",name:"Z-Image Simple (No Custom Nodes)",description:"Basic Z-Image-Turbo workflow using only built-in ComfyUI nodes. Use when res4lyf nodes are unavailable.",requiredModels:{diffusion:"z_image_turbo_bf16.safetensors",textEncoder:"qwen_3_4b.safetensors",vae:"z-image-turbo-vae.safetensors"},requiredNodes:[],defaults:{width:1024,height:1024,steps:9,cfg:1},workflow:i({prompt:"{{prompt}}",width:1024,height:1024})}}}]);