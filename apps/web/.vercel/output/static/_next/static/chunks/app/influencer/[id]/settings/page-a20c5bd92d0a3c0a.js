(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3928],{11930:function(e,t,s){Promise.resolve().then(s.bind(s,43347))},43347:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return J}});var r=s(43264),a=s(27905),n=s(9060),i=s(97720),l=s(40865),c=s(54055),d=s(31531),o=s(63609);function m(e){return e&&0!==e.trim().length?e.trim().length>100?"Name must be 100 characters or less":null:"Name is required"}function x(e){return e.length>500?"Bio must be 500 characters or less":null}function u(e){if(!e||0===e.trim().length)return"Handle is required";let t=e.replace(/^@/,"").trim();return t.length<3?"Handle must be at least 3 characters":t.length>30?"Handle must be 30 characters or less":/^[a-zA-Z0-9_-]+$/.test(t)?null:"Handle can only contain letters, numbers, hyphens, and underscores"}var h=s(83950);function f(e){let{onBack:t}=e;return(0,r.jsx)("div",{className:"sticky top-0 z-40 bg-[var(--bg-base)]/95 backdrop-blur-sm border-b border-[var(--border-default)]",children:(0,r.jsxs)("div",{className:"mx-auto flex h-14 max-w-4xl items-center justify-between px-4 lg:px-6",children:[(0,r.jsxs)("button",{onClick:t,className:"flex items-center gap-2 text-sm text-[var(--text-secondary)] transition-colors hover:text-[var(--text-primary)] group",children:[(0,r.jsx)("div",{className:"w-8 h-8 rounded-lg bg-[var(--bg-subtle)] flex items-center justify-center group-hover:bg-[var(--bg-surface)] transition-colors",children:(0,r.jsx)(h.Z,{className:"h-4 w-4"})}),(0,r.jsx)("span",{className:"hidden sm:inline",children:"Back to Profile"})]}),(0,r.jsx)("h1",{className:"text-lg font-semibold text-[var(--text-primary)]",children:"Settings"}),(0,r.jsx)("div",{className:"w-8"})," "]})})}var g=s(237);function p(e){let{nsfwEnabled:t,isSaving:s,onToggle:a}=e,{isPro:n}=(0,g.m)();return n?(0,r.jsxs)("section",{className:"space-y-4",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-[var(--text-primary)]",children:"Content Settings"}),(0,r.jsx)("div",{className:"bg-[var(--bg-subtle)] border border-[var(--border-default)] rounded-xl p-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)(c.__,{htmlFor:"nsfw-toggle",className:"text-base font-medium text-[var(--text-primary)] cursor-pointer block mb-2",children:"Enable 18+ Content"}),(0,r.jsx)("p",{className:"text-sm text-[var(--text-muted)]",children:"18+ only. When enabled, this allows generation of NSFW content and enables access to NSFW models for this AI Influencer."})]}),(0,r.jsxs)("div",{className:"flex items-center gap-3 flex-shrink-0",children:[s&&(0,r.jsx)("span",{className:"text-xs text-[var(--text-muted)] whitespace-nowrap",children:"Saving..."}),(0,r.jsx)("button",{type:"button",role:"switch","aria-checked":t,onClick:()=>!s&&a(!t),disabled:s,className:(0,c.cn)("relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-[var(--purple-500)] focus:ring-offset-2 focus:ring-offset-transparent disabled:opacity-50 disabled:cursor-not-allowed",t?"bg-[var(--purple-500)]":"bg-white/20 border border-white/30"),children:(0,r.jsx)("span",{className:(0,c.cn)("inline-block h-4 w-4 transform rounded-full bg-white transition-transform",t?"translate-x-6":"translate-x-1")})})]})]})})]}):null}function b(e){let{value:t,error:s,hasChanged:a,isSaving:n,onChange:i,onSave:l}=e;return(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(c.__,{htmlFor:"name-input",children:"Name"}),(0,r.jsx)("p",{className:"text-sm text-[var(--text-muted)]",children:"Your AI Influencer's display name. Must be 1-100 characters."}),(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)(c.II,{id:"name-input",type:"text",value:t,onChange:i,placeholder:"Influencer name",className:s?"border-red-500/50":""}),s&&(0,r.jsx)("p",{className:"text-sm text-red-400 mt-1",children:s})]}),(0,r.jsx)(c.br,{onClick:l,disabled:!a||!!s||n,variant:"gradient",size:"sm",children:n?"Saving...":"Save"})]})]})}function j(e){let{value:t,error:s,hasChanged:a,isSaving:n,onChange:i,onSave:l}=e;return(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(c.__,{htmlFor:"bio-input",children:"Bio"}),(0,r.jsx)("p",{className:"text-sm text-[var(--text-muted)]",children:"A short description of your AI Influencer. Optional, max 500 characters."}),(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)(c.gx,{id:"bio-input",value:t,onChange:i,placeholder:"Write a bio for your AI Influencer...",rows:3,className:s?"border-red-500/50":""}),(0,r.jsxs)("div",{className:"flex items-center justify-between mt-1",children:[s&&(0,r.jsx)("p",{className:"text-sm text-red-400",children:s}),(0,r.jsxs)("p",{className:"text-xs text-[var(--text-muted)] ml-auto",children:[t.length,"/500"]})]})]}),(0,r.jsx)(c.br,{onClick:l,disabled:!a||!!s||n,variant:"gradient",size:"sm",className:"self-start",children:n?"Saving...":"Save"})]})]})}function w(e){let{value:t,error:s,hasChanged:a,isSaving:n,onChange:i,onSave:l}=e;return(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(c.__,{htmlFor:"handle-input",children:"Handle / Slug"}),(0,r.jsx)("p",{className:"text-sm text-[var(--text-muted)]",children:"Your AI Influencer's unique identifier. Must be unique, 3-30 characters, letters, numbers, hyphens, and underscores only."}),(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)(c.II,{id:"handle-input",type:"text",value:t,onChange:i,placeholder:"@username",className:s?"border-red-500/50":""}),s&&(0,r.jsx)("p",{className:"text-sm text-red-400 mt-1",children:s})]}),(0,r.jsx)(c.br,{onClick:l,disabled:!a||!!s||n,variant:"gradient",size:"sm",children:n?"Saving...":"Save"})]})]})}var N=s(53882),v=s(99210),y=s(79278),k=s(1054);function C(){return(0,r.jsxs)("section",{className:"space-y-4",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-[var(--text-primary)]",children:"Social Media Connections"}),(0,r.jsxs)("div",{className:"bg-[var(--bg-subtle)] border border-[var(--border-default)] rounded-xl p-6 space-y-4 opacity-60",children:[(0,r.jsx)("p",{className:"text-sm text-[var(--text-muted)] mb-4",children:"Connect your social media accounts to automatically post content. Coming soon!"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 p-4 bg-[var(--bg-surface)] border border-[var(--border-default)] rounded-lg",children:[(0,r.jsx)("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-purple-600 to-pink-600 flex items-center justify-center",children:(0,r.jsx)(N.Z,{className:"h-5 w-5 text-white"})}),(0,r.jsx)("div",{className:"flex-1",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"text-sm font-medium text-[var(--text-primary)]",children:"Instagram"}),(0,r.jsx)("span",{className:"text-xs px-2 py-0.5 bg-[var(--bg-subtle)] text-[var(--text-muted)] rounded-full",children:"Coming Soon"})]})}),(0,r.jsx)(v.Z,{className:"h-4 w-4 text-[var(--text-muted)]"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-3 p-4 bg-[var(--bg-surface)] border border-[var(--border-default)] rounded-lg",children:[(0,r.jsx)("div",{className:"w-10 h-10 rounded-lg bg-black flex items-center justify-center",children:(0,r.jsx)(y.Z,{className:"h-5 w-5 text-white"})}),(0,r.jsx)("div",{className:"flex-1",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"text-sm font-medium text-[var(--text-primary)]",children:"Twitter / X"}),(0,r.jsx)("span",{className:"text-xs px-2 py-0.5 bg-[var(--bg-subtle)] text-[var(--text-muted)] rounded-full",children:"Coming Soon"})]})}),(0,r.jsx)(v.Z,{className:"h-4 w-4 text-[var(--text-muted)]"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-3 p-4 bg-[var(--bg-surface)] border border-[var(--border-default)] rounded-lg",children:[(0,r.jsx)("div",{className:"w-10 h-10 rounded-lg bg-black flex items-center justify-center",children:(0,r.jsx)(k.Z,{className:"h-5 w-5 text-white"})}),(0,r.jsx)("div",{className:"flex-1",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"text-sm font-medium text-[var(--text-primary)]",children:"TikTok"}),(0,r.jsx)("span",{className:"text-xs px-2 py-0.5 bg-[var(--bg-subtle)] text-[var(--text-muted)] rounded-full",children:"Coming Soon"})]})}),(0,r.jsx)(v.Z,{className:"h-4 w-4 text-[var(--text-muted)]"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-3 p-4 bg-[var(--bg-surface)] border border-[var(--border-default)] rounded-lg",children:[(0,r.jsx)("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-blue-600 to-purple-600 flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-white text-xs font-bold",children:"OF"})}),(0,r.jsx)("div",{className:"flex-1",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"text-sm font-medium text-[var(--text-primary)]",children:"OnlyFans"}),(0,r.jsx)("span",{className:"text-xs px-2 py-0.5 bg-[var(--bg-subtle)] text-[var(--text-muted)] rounded-full",children:"Coming Soon"})]})}),(0,r.jsx)(v.Z,{className:"h-4 w-4 text-[var(--text-muted)]"})]})]})]})]})}var S=s(5456),Z=s(26325),I=s(61610),A=s(9926),L=s(81778),E=s(58339),_=s(15421),T=s(64323),M=s(76131),F=s(36731),R=s(46369),q=s(35071);s(81436);var z=s(66047),P=s(67005),$=s(37948),H=s(11942),U=s(44498),O=s(66843),Q=s(15689);function B(e){let{isOpen:t,onClose:s,onConfirm:n,characterId:i,characterName:l,isSubmitting:d=!1,creditBalance:o=0}=e,{data:m,isLoading:x,error:u}=(0,R.YA)(t?i:null),[h,f]=a.useState(new Set);a.useEffect(()=>{if(m?.images&&0===h.size){let e=m.images.filter(e=>e.liked);e.length>=5?f(new Set(e.slice(0,10).map(e=>e.id))):f(new Set(m.images.slice(0,10).map(e=>e.id)))}},[m?.images,h.size]),a.useEffect(()=>{t||f(new Set)},[t]);let g=e=>{f(t=>{let s=new Set(t);return s.has(e)?s.delete(e):s.size<10&&s.add(e),s})},p=h.size,b=p>=5,j=(0,q.calculateLoraTrainingCost)("flux",p),w=o>=j;return t?(0,r.jsx)(z.M,{children:t&&(0,r.jsx)(P.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/80 backdrop-blur-md",onClick:s,children:(0,r.jsxs)(P.E.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.2},className:"relative w-full max-w-2xl max-h-[85vh] bg-[var(--bg-elevated)] border border-white/10 rounded-2xl shadow-2xl overflow-hidden flex flex-col",onClick:e=>e.stopPropagation(),children:[(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-white/10",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-white",children:"Select Training Images"}),(0,r.jsxs)("p",{className:"text-sm text-white/60 mt-0.5",children:["Choose images for LoRA training • ",l]})]}),(0,r.jsx)("button",{onClick:s,className:"p-2 rounded-lg hover:bg-white/10 transition-colors",children:(0,r.jsx)($.Z,{className:"h-5 w-5 text-white/60"})})]}),(0,r.jsx)("div",{className:"flex-1 overflow-y-auto p-4",children:x?(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center py-12",children:[(0,r.jsx)(S.Z,{className:"h-8 w-8 animate-spin text-white/40"}),(0,r.jsx)("p",{className:"mt-3 text-sm text-white/60",children:"Loading images..."})]}):u?(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center py-12",children:[(0,r.jsx)(H.Z,{className:"h-8 w-8 text-red-400"}),(0,r.jsx)("p",{className:"mt-3 text-sm text-red-300",children:"Failed to load images"})]}):m?.images.length?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"mb-4 p-3 rounded-lg bg-white/5 border border-white/10",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("span",{className:(0,c.cn)("text-sm font-medium",b?"text-green-300":"text-amber-300"),children:[p," / ",5," minimum"]}),p>0&&p<5&&(0,r.jsxs)("span",{className:"text-xs text-white/50",children:["(select ",5-p," more)"]})]}),(0,r.jsxs)("span",{className:"text-xs text-white/50",children:["Max ",10," images"]})]})}),(0,r.jsx)("div",{className:"grid grid-cols-3 sm:grid-cols-4 gap-3",children:m.images.map(e=>(0,r.jsx)(D,{image:e,isSelected:h.has(e.id),isDisabled:!h.has(e.id)&&p>=10,onClick:()=>g(e.id)},e.id))})]}):(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center py-12",children:[(0,r.jsx)(U.Z,{className:"h-8 w-8 text-white/40"}),(0,r.jsx)("p",{className:"mt-3 text-sm text-white/60",children:"No images available for training"}),(0,r.jsx)("p",{className:"mt-1 text-xs text-white/40",children:"Generate some images first in the Studio"})]})}),(0,r.jsx)("div",{className:"p-4 border-t border-white/10 bg-[var(--bg-subtle)]",children:(0,r.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(L.Z,{className:"h-4 w-4 text-amber-400"}),(0,r.jsxs)("span",{className:"text-sm text-white/80",children:[j.toLocaleString()," credits"]})]}),!w&&p>=5&&(0,r.jsx)("p",{className:"text-xs text-red-300 mt-1",children:"Insufficient credits"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("button",{onClick:s,className:"px-4 py-2 text-sm font-medium text-white/70 hover:text-white hover:bg-white/10 rounded-lg transition-colors",children:"Cancel"}),(0,r.jsx)("button",{onClick:()=>{m?.images&&b&&n(m.images.filter(e=>h.has(e.id)).map(e=>e.url))},disabled:!b||!w||d,className:(0,c.cn)("px-4 py-2 text-sm font-medium rounded-lg transition-all flex items-center gap-2",b&&w&&!d?"bg-gradient-to-r from-amber-500 to-orange-500 text-white hover:brightness-110":"bg-white/10 text-white/40 cursor-not-allowed"),children:d?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(S.Z,{className:"h-4 w-4 animate-spin"}),"Starting..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(L.Z,{className:"h-4 w-4"}),"Start Training"]})})]})]})})]})})}):null}function D(e){let{image:t,isSelected:s,isDisabled:a,onClick:n}=e;return(0,r.jsxs)("button",{onClick:n,disabled:a,className:(0,c.cn)("relative aspect-square rounded-xl overflow-hidden transition-all duration-200 group",s?"ring-2 ring-purple-400 ring-offset-2 ring-offset-[var(--bg-elevated)]":"hover:ring-1 hover:ring-white/20",a&&"opacity-40 cursor-not-allowed"),children:[(0,r.jsx)("img",{src:t.thumbnailUrl||t.url,alt:"Training image",className:"w-full h-full object-cover"}),(0,r.jsx)("div",{className:(0,c.cn)("absolute inset-0 transition-opacity",s?"bg-purple-500/20":"bg-black/0 group-hover:bg-black/20")}),t.liked&&(0,r.jsx)("div",{className:"absolute top-2 left-2 w-6 h-6 rounded-full bg-pink-500/80 flex items-center justify-center",children:(0,r.jsx)(O.Z,{className:"h-3.5 w-3.5 text-white fill-white"})}),s&&(0,r.jsx)("div",{className:"absolute top-2 right-2 w-7 h-7 rounded-full bg-purple-500 flex items-center justify-center ring-2 ring-purple-500/30 shadow-lg",children:(0,r.jsx)(Q.Z,{className:"h-4 w-4 text-white",strokeWidth:3})}),!s&&!a&&(0,r.jsx)("div",{className:"absolute top-2 right-2 w-7 h-7 rounded-full border-2 border-white/30 bg-black/30 opacity-0 group-hover:opacity-100 transition-opacity"})]})}var W=s(30093),K=s(45898);function X(e){let{characterId:t}=e,{data:s,isLoading:n}=(0,R.id)(t),[i,l]=a.useState(!1);return!s||s.totalCount<=1?null:(0,r.jsxs)("section",{className:"space-y-3",children:[(0,r.jsxs)("button",{onClick:()=>l(!i),className:"flex items-center justify-between w-full text-left group",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(W.Z,{className:"h-4 w-4 text-white/40"}),(0,r.jsx)("span",{className:"text-sm font-medium text-white/70 group-hover:text-white transition-colors",children:"Training History"}),(0,r.jsxs)("span",{className:"text-xs text-white/40",children:["(",s.totalCount,")"]})]}),i?(0,r.jsx)(K.Z,{className:"h-4 w-4 text-white/40"}):(0,r.jsx)(F.Z,{className:"h-4 w-4 text-white/40"})]}),i&&(0,r.jsx)("div",{className:"space-y-2 animate-in slide-in-from-top-2 duration-200",children:n?(0,r.jsxs)("div",{className:"flex items-center gap-2 py-4",children:[(0,r.jsx)(S.Z,{className:"h-4 w-4 animate-spin text-white/40"}),(0,r.jsx)("span",{className:"text-sm text-white/60",children:"Loading history..."})]}):s.history.map((e,t)=>(0,r.jsx)(G,{item:e,isLatest:0===t},e.id))})]})}function G(e){let{item:t,isLatest:s}=e,a=function(e){switch(e){case"ready":return{label:"Completed",icon:Z.Z,iconColor:"text-green-400",bgColor:"bg-green-500/20",textColor:"text-green-300"};case"training":return{label:"Training",icon:S.Z,iconColor:"text-amber-400 animate-spin",bgColor:"bg-amber-500/20",textColor:"text-amber-300"};case"pending":return{label:"Queued",icon:I.Z,iconColor:"text-amber-400",bgColor:"bg-amber-500/20",textColor:"text-amber-300"};case"failed":return{label:"Failed",icon:A.Z,iconColor:"text-red-400",bgColor:"bg-red-500/20",textColor:"text-red-300"};case"expired":return{label:"Expired",icon:I.Z,iconColor:"text-white/40",bgColor:"bg-white/10",textColor:"text-white/50"};default:return{label:"Unknown",icon:L.Z,iconColor:"text-white/40",bgColor:"bg-white/10",textColor:"text-white/50"}}}(t.status),n=new Date(t.createdAt).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"}),i=t.trainingDurationMs?function(e){let t=Math.floor(e/6e4),s=Math.floor(e%6e4/1e3);return 0===t?`${s}s`:`${t}m ${s}s`}(t.trainingDurationMs):null;return(0,r.jsx)("div",{className:(0,c.cn)("p-3 rounded-lg border transition-colors",s?"bg-white/5 border-white/15":"bg-white/[0.02] border-white/10"),children:(0,r.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)("div",{className:(0,c.cn)("mt-0.5 w-6 h-6 rounded-full flex items-center justify-center shrink-0",a.bgColor),children:(0,r.jsx)(a.icon,{className:(0,c.cn)("h-3.5 w-3.5",a.iconColor)})}),(0,r.jsxs)("div",{className:"min-w-0",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:(0,c.cn)("text-sm font-medium",a.textColor),children:a.label}),s&&(0,r.jsx)("span",{className:"px-1.5 py-0.5 text-[10px] font-medium rounded bg-purple-500/20 text-purple-300",children:"Current"})]}),(0,r.jsx)("p",{className:"text-xs text-white/50 mt-0.5",children:n}),t.errorMessage&&(0,r.jsx)("p",{className:"text-xs text-red-300/80 mt-1 line-clamp-2",children:t.errorMessage})]})]}),(0,r.jsxs)("div",{className:"text-right shrink-0",children:[t.imageCount>0&&(0,r.jsxs)("p",{className:"text-xs text-white/40",children:[t.imageCount," images"]}),i&&(0,r.jsx)("p",{className:"text-xs text-white/40",children:i}),null!=t.creditsCharged&&t.creditsCharged>0&&(0,r.jsxs)("p",{className:"text-xs text-white/40",children:[t.creditsCharged.toLocaleString()," credits",null!=t.creditsRefunded&&t.creditsRefunded>0&&(0,r.jsx)("span",{className:"text-green-300",children:" (refunded)"})]})]})]})})}function V(e){let{influencerId:t,influencerName:s,baseImageUrl:n}=e,{data:i,isLoading:l,refetch:d}=(0,R._B)(t),m=(0,R.Qs)(),x=(0,R.hG)(),{data:u}=o.SX.credits.getBalance.useQuery(),{data:h}=(0,R.G5)(),{data:f}=(0,R.QV)(t),[g,p]=a.useState(!1),[b,j]=a.useState(null),[w,N]=a.useState(!1),[v,y]=a.useState("flux"),[k,C]=a.useState(!1),z=i?.lora,P=!!z,$=z?.status==="training"||z?.status==="pending",H=z?.status==="ready",U=z?.status==="failed",O=i?.loraEnabled??!0,Q=h?.modelTypes??[],D=Q.find(e=>e.id===v),W="wan"===v||"wan-14b"===v,K=(0,q.calculateLoraTrainingCost)(v,W?5:8),G=u?.balance??0,V=()=>{j(null),N(!0)},Y=async e=>{try{await x.mutateAsync({characterId:t,enabled:e}),await d()}catch(e){j(e instanceof Error?e.message:"Failed to toggle LoRA setting")}},J=async e=>{p(!0),j(null);try{await m.mutateAsync({characterId:t,triggerWord:s.toLowerCase().replace(/\s+/g,""),modelType:v,mediaUrls:e,imageUrls:e}),await d(),N(!1),C(!1)}catch(e){j(e instanceof Error?e.message:"Failed to start training")}finally{p(!1)}};return l?(0,r.jsxs)("section",{className:"space-y-4",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-[var(--text-primary)]",children:"AI Consistency (LoRA)"}),(0,r.jsx)("div",{className:"bg-[var(--bg-subtle)] border border-[var(--border-default)] rounded-xl p-6",children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(S.Z,{className:"h-5 w-5 animate-spin text-white/50"}),(0,r.jsx)("span",{className:"text-white/60",children:"Loading LoRA status..."})]})})]}):(0,r.jsxs)("section",{className:"space-y-4",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-[var(--text-primary)]",children:"AI Consistency (LoRA)"}),(0,r.jsxs)("div",{className:"bg-[var(--bg-subtle)] border border-[var(--border-default)] rounded-xl p-6 space-y-4",children:[H&&(0,r.jsxs)("div",{className:"flex items-center gap-3 p-4 rounded-lg bg-green-500/10 border border-green-500/20",children:[(0,r.jsx)("div",{className:"shrink-0 w-10 h-10 rounded-full bg-green-500/20 flex items-center justify-center",children:(0,r.jsx)(Z.Z,{className:"h-5 w-5 text-green-400"})}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-white",children:"LoRA Model Active"}),(0,r.jsxs)("p",{className:"text-xs text-white/60 mt-0.5",children:["Trigger word:"," ",(0,r.jsx)("code",{className:"px-1 py-0.5 rounded bg-white/10",children:z.triggerWord}),z.trainingSteps&&` • ${z.trainingSteps} training steps`]})]})]}),H&&(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 rounded-lg bg-white/5 border border-white/10",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-white",children:"Use LoRA for Generation"}),(0,r.jsx)("p",{className:"text-xs text-white/60 mt-0.5",children:O?"LoRA will be applied to all image generations":"LoRA is disabled, using base model only"})]}),(0,r.jsx)(c.rs,{checked:O,onCheckedChange:Y,disabled:x.isPending,className:"data-[state=checked]:bg-purple-500"})]}),$&&(0,r.jsxs)("div",{className:"flex items-center gap-3 p-4 rounded-lg bg-amber-500/10 border border-amber-500/20",children:[(0,r.jsx)("div",{className:"shrink-0 w-10 h-10 rounded-full bg-amber-500/20 flex items-center justify-center",children:z?.status==="pending"?(0,r.jsx)(I.Z,{className:"h-5 w-5 text-amber-400"}):(0,r.jsx)(S.Z,{className:"h-5 w-5 animate-spin text-amber-400"})}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-white",children:z?.status==="pending"?"Training Queued":"Training in Progress"}),(0,r.jsx)("p",{className:"text-xs text-white/60 mt-0.5",children:"Estimated time: 5-10 minutes"})]})]}),U&&(0,r.jsxs)("div",{className:"flex items-center gap-3 p-4 rounded-lg bg-red-500/10 border border-red-500/20",children:[(0,r.jsx)("div",{className:"shrink-0 w-10 h-10 rounded-full bg-red-500/20 flex items-center justify-center",children:(0,r.jsx)(A.Z,{className:"h-5 w-5 text-red-400"})}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-white",children:"Training Failed"}),(0,r.jsxs)("p",{className:"text-xs text-white/60 mt-0.5",children:[z.errorMessage||"An error occurred during training.",z.creditsRefunded&&z.creditsRefunded>0&&(0,r.jsxs)("span",{className:"text-green-300 ml-1",children:["(",z.creditsRefunded.toLocaleString()," credits refunded)"]})]})]})]}),!P&&(0,r.jsxs)("div",{className:"flex items-center gap-3 p-4 rounded-lg bg-white/5 border border-white/10",children:[(0,r.jsx)("div",{className:"shrink-0 w-10 h-10 rounded-full bg-white/10 flex items-center justify-center",children:(0,r.jsx)(L.Z,{className:"h-5 w-5 text-white/40"})}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-white",children:"No LoRA Model"}),(0,r.jsx)("p",{className:"text-xs text-white/60 mt-0.5",children:"Train a custom AI model for 95%+ face consistency in all generated images."})]})]}),f?.hasNewLikedImages&&H&&(0,r.jsxs)("div",{className:"flex items-center gap-3 p-4 rounded-lg bg-blue-500/10 border border-blue-500/20",children:[(0,r.jsx)("div",{className:"shrink-0 w-10 h-10 rounded-full bg-blue-500/20 flex items-center justify-center",children:(0,r.jsx)(E.Z,{className:"h-5 w-5 text-blue-400"})}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("p",{className:"text-sm font-medium text-white",children:[f.newLikedImageCount," New Liked Image",f.newLikedImageCount>1?"s":""," Available"]}),(0,r.jsx)("p",{className:"text-xs text-white/60 mt-0.5",children:"Retrain your LoRA with new images for improved face consistency."})]})]}),f?.freeRetry&&U&&(0,r.jsxs)("div",{className:"flex items-center gap-3 p-4 rounded-lg bg-green-500/10 border border-green-500/20",children:[(0,r.jsx)("div",{className:"shrink-0 w-10 h-10 rounded-full bg-green-500/20 flex items-center justify-center",children:(0,r.jsx)(_.Z,{className:"h-5 w-5 text-green-400"})}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-white",children:"Free Retry Available"}),(0,r.jsx)("p",{className:"text-xs text-white/60 mt-0.5",children:"Your previous training failed. Retry for free with your current images."})]})]}),(0,r.jsx)("div",{className:"p-4 rounded-lg bg-white/5 border border-white/10",children:(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)(T.Z,{className:"h-4 w-4 text-amber-400 mt-0.5 shrink-0"}),(0,r.jsxs)("div",{className:"text-xs text-white/60",children:[(0,r.jsx)("p",{className:"font-medium text-white/80 mb-1",children:"What is LoRA?"}),(0,r.jsx)("p",{children:"LoRA (Low-Rank Adaptation) trains a custom AI model specifically on your character's face. This ensures near-perfect consistency across all generated images and videos, maintaining identity even in different poses and lighting."})]})]})}),(!P||U||H)&&Q.length>0&&(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("button",{onClick:()=>C(!k),className:"flex items-center justify-between w-full p-3 rounded-lg bg-white/5 border border-white/10 hover:bg-white/10 transition-colors",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[W?(0,r.jsx)(M.Z,{className:"h-4 w-4 text-purple-400"}):(0,r.jsx)(E.Z,{className:"h-4 w-4 text-blue-400"}),(0,r.jsx)("span",{className:"text-sm font-medium text-white",children:D?.name||"Flux"}),(0,r.jsxs)("span",{className:"text-xs text-white/50",children:["(",D?.mediaType||"images",")"]})]}),(0,r.jsx)(F.Z,{className:(0,c.cn)("h-4 w-4 text-white/50 transition-transform",k&&"rotate-180")})]}),k&&(0,r.jsx)("div",{className:"grid gap-2 p-2 rounded-lg bg-white/5 border border-white/10",children:Q.map(e=>(0,r.jsxs)("button",{onClick:()=>{y(e.id),C(!1)},className:(0,c.cn)("flex items-start gap-3 p-3 rounded-lg text-left transition-colors",v===e.id?"bg-purple-500/20 border border-purple-500/30":"bg-white/5 border border-transparent hover:bg-white/10"),children:[(0,r.jsx)("div",{className:"shrink-0 mt-0.5",children:"videos"===e.mediaType?(0,r.jsx)(M.Z,{className:"h-4 w-4 text-purple-400"}):(0,r.jsx)(E.Z,{className:"h-4 w-4 text-blue-400"})}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-white",children:e.name}),(0,r.jsx)("p",{className:"text-xs text-white/60 mt-0.5",children:e.description}),(0,r.jsxs)("p",{className:"text-xs text-white/40 mt-1",children:[e.minMedia,"-",e.maxMedia," ",e.mediaType," • ~",e.estimatedMinutes," ","min"]})]}),v===e.id&&(0,r.jsx)(Z.Z,{className:"h-4 w-4 text-purple-400 shrink-0"})]},e.id))})]}),(!P||U)&&(0,r.jsxs)("div",{className:"pt-2",children:[(0,r.jsx)("button",{onClick:V,disabled:g,className:(0,c.cn)("w-full p-4 rounded-xl border-2 transition-all duration-200 text-left relative overflow-hidden",g?"opacity-50 cursor-not-allowed border-white/10 bg-white/5":W?"border-purple-400/50 bg-gradient-to-br from-purple-500/20 to-pink-500/20 hover:shadow-lg hover:shadow-purple-500/20":"border-amber-400/50 bg-gradient-to-br from-amber-500/20 to-orange-500/20 hover:shadow-lg hover:shadow-amber-500/20"),children:(0,r.jsx)("div",{className:"flex items-center justify-between gap-4",children:(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[g?(0,r.jsx)(S.Z,{className:(0,c.cn)("h-4 w-4 animate-spin",W?"text-purple-400":"text-amber-400")}):U?(0,r.jsx)(_.Z,{className:(0,c.cn)("h-4 w-4",W?"text-purple-400":"text-amber-400")}):W?(0,r.jsx)(M.Z,{className:"h-4 w-4 text-purple-400"}):(0,r.jsx)(E.Z,{className:"h-4 w-4 text-amber-400"}),(0,r.jsx)("p",{className:"text-base font-semibold text-white",children:g?"Starting Training...":U?"Retry Training":W?"Select Videos & Train":"Select Images & Train"}),(0,r.jsxs)("span",{className:(0,c.cn)("inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium",W?"bg-purple-500/30 text-purple-300":"bg-amber-500/30 text-amber-300"),children:["~",K.toLocaleString()," credits"]})]}),(0,r.jsx)("p",{className:"text-sm text-white/60",children:D?`Choose ${D.minMedia}-${D.maxMedia} ${D.mediaType} • ~${D.estimatedMinutes} min`:"Choose 5-10 images • Training takes 5-10 minutes"})]})})}),b&&(0,r.jsx)("p",{className:"mt-2 text-xs text-red-300/80",children:b})]}),H&&(0,r.jsx)("div",{className:"pt-2",children:(0,r.jsx)("button",{onClick:V,disabled:g,className:(0,c.cn)("w-full p-3 rounded-lg border transition-all duration-200 text-center",g?"opacity-50 cursor-not-allowed border-white/10 bg-white/5 text-white/40":"border-white/20 bg-white/5 hover:bg-white/10 text-white/70 hover:text-white"),children:(0,r.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[g?(0,r.jsx)(S.Z,{className:"h-4 w-4 animate-spin"}):(0,r.jsx)(_.Z,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"text-sm",children:g?"Starting...":"Retrain with New Images"})]})})}),(0,r.jsx)(X,{characterId:t})]}),(0,r.jsx)(B,{isOpen:w,onClose:()=>N(!1),onConfirm:J,characterId:t,characterName:s,isSubmitting:g,creditBalance:G})]})}function Y(e){let{influencer:t,onBack:s}=e,{name:n,bio:l,handle:h,nsfwEnabled:g,nameError:N,bioError:v,handleError:y,isSavingName:k,isSavingBio:S,isSavingHandle:Z,isSavingNsfw:I,nameChanged:A,bioChanged:L,handleChanged:E,handleNameChange:_,handleBioChange:T,handleHandleChange:M,handleSaveName:F,handleSaveBio:R,handleSaveHandle:q,handleNsfwToggle:z}=function(e){let{influencer:t}=e,s=(0,i.useInfluencerStore)(e=>e.updateInfluencer),r=o.SX.useUtils(),[n,l]=a.useState(t.name||""),[c,h]=a.useState(t.bio||""),[f,g]=a.useState(t.handle||""),[p,b]=a.useState(t.nsfwEnabled||!1),[j,w]=a.useState(null),[N,v]=a.useState(null),[y,k]=a.useState(null),[C,S]=a.useState(!1),[Z,I]=a.useState(!1),[A,L]=a.useState(!1),[E,_]=a.useState(!1),T=n!==t.name,M=c!==t.bio,F=f!==t.handle,R=o.SX.character.update.useMutation({onSuccess:e=>{if(e){let a=e.config;s(t.id,{name:e.name||t.name,handle:e.handle||t.handle,bio:a?.bio??t.bio,nsfwEnabled:a?.nsfwEnabled??p}),e.name&&l(e.name),a?.bio!==void 0&&h(a.bio),a?.nsfwEnabled!==void 0&&b(a.nsfwEnabled),r.character.getById.invalidate({id:t.id})}S(!1),I(!1),L(!1),_(!1),w(null),v(null),k(null)},onError:e=>{S(!1),I(!1),L(!1),_(!1),e.message.includes("handle")||e.message.includes("unique")?k("This handle is already taken. Please choose another."):e.message.includes("name")?w(e.message||"Failed to save name."):e.message.includes("bio")?v(e.message||"Failed to save bio."):k(e.message||"Failed to save. Please try again.")}}),q=a.useCallback(e=>{let t=e.target.value;l(t),w(m(t))},[]),z=a.useCallback(e=>{let t=e.target.value;h(t),v(x(t))},[]),P=a.useCallback(e=>{let s=e.target.value;g(s),k(u(s)),F||s===t.handle||(0,d.IE)("handle_edit_started",{influencer_id:t.id})},[F,t.handle,t.id]),$=a.useCallback(async()=>{let e=m(n);if(e){w(e);return}S(!0);try{await R.mutateAsync({id:t.id,name:n.trim()}),(0,d.IE)("name_edit_completed",{influencer_id:t.id,name:n.trim(),success:!0})}catch(e){(0,d.IE)("name_edit_failed",{influencer_id:t.id,error:e instanceof Error?e.message:"Unknown error"})}},[n,t.id,R]),H=a.useCallback(async()=>{let e=x(c);if(e){v(e);return}I(!0);try{await R.mutateAsync({id:t.id,config:{bio:c.trim()}}),(0,d.IE)("bio_edit_completed",{influencer_id:t.id,success:!0})}catch(e){(0,d.IE)("bio_edit_failed",{influencer_id:t.id,error:e instanceof Error?e.message:"Unknown error"})}},[c,t.id,R]),U=a.useCallback(async()=>{let e=u(f);if(e){k(e);return}L(!0);let s=f.replace(/^@/,"").trim();try{await R.mutateAsync({id:t.id,handle:s}),(0,d.IE)("handle_edit_completed",{influencer_id:t.id,handle:s,success:!0})}catch(e){(0,d.IE)("handle_edit_failed",{influencer_id:t.id,error:e instanceof Error?e.message:"Unknown error",reason:"server_error"})}},[f,t.id,R]),O=a.useCallback(async e=>{b(e),_(!0);try{await R.mutateAsync({id:t.id,config:{nsfwEnabled:e}})&&s(t.id,{nsfwEnabled:e}),(0,d.IE)("nsfw_toggle_changed",{influencer_id:t.id,nsfw_enabled:e}),_(!1)}catch(e){b(p),_(!1),console.error("Failed to update NSFW setting:",e)}},[p,t.id,R,s]);return{name:n,bio:c,handle:f,nsfwEnabled:p,nameError:j,bioError:N,handleError:y,isSavingName:C,isSavingBio:Z,isSavingHandle:A,isSavingNsfw:E,nameChanged:T,bioChanged:M,handleChanged:F,handleNameChange:q,handleBioChange:z,handleHandleChange:P,handleSaveName:$,handleSaveBio:H,handleSaveHandle:U,handleNsfwToggle:O}}({influencer:t});return a.useEffect(()=>{(0,d.IE)("settings_page_viewed",{influencer_id:t.id})},[t.id]),(0,r.jsxs)("div",{className:"min-h-screen",children:[(0,r.jsx)(f,{onBack:s}),(0,r.jsx)(c._z,{className:"py-8",children:(0,r.jsxs)("div",{className:"max-w-2xl mx-auto space-y-8",children:[(0,r.jsx)(V,{influencerId:t.id,influencerName:t.name,baseImageUrl:t.avatar}),(0,r.jsx)(p,{nsfwEnabled:g,isSaving:I,onToggle:z}),(0,r.jsxs)("section",{className:"space-y-4",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-[var(--text-primary)]",children:"Identity Settings"}),(0,r.jsxs)("div",{className:"bg-[var(--bg-subtle)] border border-[var(--border-default)] rounded-xl p-6 space-y-6",children:[(0,r.jsx)(b,{value:n,error:N,hasChanged:A,isSaving:k,onChange:_,onSave:F}),(0,r.jsx)(j,{value:l,error:v,hasChanged:L,isSaving:S,onChange:T,onSave:R}),(0,r.jsx)(w,{value:h,error:y,hasChanged:E,isSaving:Z,onChange:M,onSave:q})]})]}),(0,r.jsx)(C,{})]})})]})}function J(){return(0,r.jsx)(l.i,{children:(0,r.jsx)(ee,{})})}function ee(){let e=(0,n.useParams)(),t=(0,n.useRouter)(),s=e.id,l=(0,i.useInfluencer)(s),c=(0,i.useInfluencerStore)(e=>e.addInfluencer),{data:d,isLoading:m}=o.SX.character.getById.useQuery({id:s},{enabled:!l});return(a.useEffect(()=>{!l&&d&&c({id:d.id,name:d.name,handle:d.handle||`@${d.name.toLowerCase().replace(/\s+/g,".")}`,bio:d.config?.bio||"New AI influencer ✨",avatar:d.baseImageUrl||null,gender:d.config?.gender||"female",style:d.config?.style||"realistic",ethnicity:d.config?.ethnicity||"caucasian",age:d.config?.age||25,hairStyle:d.config?.hairStyle||"long-straight",hairColor:d.config?.hairColor||"brown",eyeColor:d.config?.eyeColor||"brown",bodyType:d.config?.bodyType||"slim",breastSize:d.config?.breastSize,archetype:d.config?.archetype||"girl-next-door",personalityTraits:d.config?.personalityTraits||[],outfit:d.config?.defaultOutfit||"casual",nsfwEnabled:d.config?.nsfwEnabled||!1,profilePictureSetId:d.config?.profilePictureSetId||void 0,postCount:parseInt(d.postCount||"0",10),imageCount:0,likedCount:parseInt(d.likedCount||"0",10),createdAt:d.createdAt?.toISOString()||new Date().toISOString(),updatedAt:d.updatedAt?.toISOString()||new Date().toISOString()})},[c,d,l]),!l&&m)?null:(l||d||(0,n.notFound)(),(0,r.jsx)("div",{className:"min-h-screen bg-[var(--bg-base)]",children:l&&(0,r.jsx)(Y,{influencer:l,onBack:()=>t.push(`/influencer/${s}`)})}))}},81436:function(e,t,s){"use strict";s.d(t,{r:function(){return x}});var r=s(43264);s(27905);var a=s(54055),n=s(26325),i=s(64323),l=s(61610),c=s(5456),d=s(81778),o=s(9926),m=s(46369);function x(e){let{characterId:t,characterName:s,className:x}=e,{data:u,isLoading:h}=(0,m._B)(t);if(h||!u?.lora)return null;let f=u.lora;if("ready"===f.status)return(0,r.jsx)("div",{className:(0,a.cn)("bg-gradient-to-r from-green-500/10 to-emerald-500/10 border border-green-500/20 rounded-xl p-4",x),children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-green-500/20 flex items-center justify-center",children:(0,r.jsx)(n.Z,{className:"h-5 w-5 text-green-400"})}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-white",children:"LoRA Model Ready"}),(0,r.jsxs)("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-500/20 text-green-300",children:[(0,r.jsx)(i.Z,{className:"w-3 h-3 mr-1"}),"Active"]})]}),(0,r.jsxs)("p",{className:"text-xs text-white/60 mt-0.5",children:[f.triggerWord&&(0,r.jsxs)("span",{children:["Trigger:"," ",(0,r.jsx)("code",{className:"text-green-300",children:f.triggerWord})]}),f.trainingSteps&&(0,r.jsxs)("span",{className:"ml-2",children:["• ",f.trainingSteps," steps"]}),f.trainingDurationMs&&(0,r.jsxs)("span",{className:"ml-2",children:["• Trained in ",Math.round(f.trainingDurationMs/1e3/60)," ","min"]})]})]})]})});if("pending"===f.status||"training"===f.status){let e="pending"===f.status;return(0,r.jsx)("div",{className:(0,a.cn)("bg-gradient-to-r from-amber-500/10 to-orange-500/10 border border-amber-500/20 rounded-xl p-4",x),children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-amber-500/20 flex items-center justify-center",children:e?(0,r.jsx)(l.Z,{className:"h-5 w-5 text-amber-400"}):(0,r.jsx)(c.Z,{className:"h-5 w-5 text-amber-400 animate-spin"})}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-white",children:e?"LoRA Training Queued":"Training LoRA Model"}),(0,r.jsxs)("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-amber-500/20 text-amber-300",children:[(0,r.jsx)(d.Z,{className:"w-3 h-3 mr-1"}),e?"Pending":"In Progress"]})]}),(0,r.jsx)("p",{className:"text-xs text-white/60 mt-0.5",children:e?"Training will start shortly...":`Training ${s||"character"}'s face model • ~5-10 minutes remaining`}),!e&&(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsx)("div",{className:"h-1.5 bg-white/10 rounded-full overflow-hidden",children:(0,r.jsx)("div",{className:"h-full bg-gradient-to-r from-amber-500 to-orange-500 rounded-full animate-pulse",style:{width:"60%"}})})})]})]})})}if("failed"===f.status){let e=null!=f.creditsRefunded&&f.creditsRefunded>0;return(0,r.jsx)("div",{className:(0,a.cn)("bg-gradient-to-r from-red-500/10 to-rose-500/10 border border-red-500/20 rounded-xl p-4",x),children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-red-500/20 flex items-center justify-center",children:(0,r.jsx)(o.Z,{className:"h-5 w-5 text-red-400"})}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-white",children:"LoRA Training Failed"}),(0,r.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-red-500/20 text-red-300",children:"Error"}),e&&(0,r.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-500/20 text-green-300",children:"Refunded"})]}),(0,r.jsxs)("p",{className:"text-xs text-white/60 mt-0.5",children:[f.errorMessage||"Training failed.",e&&(0,r.jsxs)("span",{className:"text-green-300 ml-1",children:["(",f.creditsRefunded?.toLocaleString()," credits refunded)"]})]})]})]})})}return null}},46369:function(e,t,s){"use strict";s.d(t,{G5:function(){return f},QV:function(){return N},Qs:function(){return x},YA:function(){return u},_B:function(){return m},hG:function(){return p},id:function(){return j}});var r=s(24728),a=s(25640),n=s(42141),i=s(42063);let l=s(72164).env.NEXT_PUBLIC_API_URL||"http://localhost:3001";async function c(e){let t=await (0,i.SH)(`${l}/characters/${e}/lora`);if(!t.ok){if(404===t.status)return{lora:null,loraEnabled:!1};throw Error("Failed to fetch LoRA status")}return t.json()}async function d(e){let t=await (0,i.SH)(`${l}/characters/train-lora`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error((await t.json().catch(()=>({}))).message||"Failed to start LoRA training");return t.json()}async function o(e){let t=await (0,i.SH)(`${l}/characters/${e}/lora/available-images`);if(!t.ok)throw Error("Failed to fetch available images");return t.json()}function m(e){return(0,r.a)({queryKey:["characterLora",e],queryFn:()=>c(e),enabled:!!e,refetchInterval:e=>{let t=e.state.data;return(t?.lora?.status==="training"||t?.lora?.status==="pending")&&1e4}})}function x(){let e=(0,a.NL)();return(0,n.D)({mutationFn:d,onSuccess:(t,s)=>{e.invalidateQueries({queryKey:["characterLora",s.characterId]}),e.invalidateQueries({queryKey:["myLoras"]})}})}function u(e){return(0,r.a)({queryKey:["availableTrainingImages",e],queryFn:()=>o(e),enabled:!!e})}async function h(){let e=await (0,i.SH)(`${l}/characters/lora-model-types`);if(!e.ok)throw Error("Failed to fetch model types");return e.json()}function f(){return(0,r.a)({queryKey:["loraModelTypes"],queryFn:h,staleTime:36e5})}async function g(e){let t=await (0,i.SH)(`${l}/characters/${e.characterId}/lora/toggle`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({enabled:e.enabled})});if(!t.ok)throw Error("Failed to toggle LoRA setting");return t.json()}function p(){let e=(0,a.NL)();return(0,n.D)({mutationFn:g,onSuccess:(t,s)=>{e.invalidateQueries({queryKey:["characterLora",s.characterId]}),e.invalidateQueries({queryKey:["character",s.characterId]})}})}async function b(e){let t=await (0,i.SH)(`${l}/characters/${e}/lora/history`);if(!t.ok)throw Error("Failed to fetch training history");return t.json()}function j(e){return(0,r.a)({queryKey:["trainingHistory",e],queryFn:()=>b(e),enabled:!!e})}async function w(e){let t=await (0,i.SH)(`${l}/characters/${e}/lora/new-images-check`);if(!t.ok)throw Error("Failed to check new liked images");return t.json()}function N(e){return(0,r.a)({queryKey:["newLikedImagesCheck",e],queryFn:()=>w(e),enabled:!!e,staleTime:3e5})}},237:function(e,t,s){"use strict";s.d(t,{m:function(){return a}});var r=s(63609);function a(){let{data:e,isLoading:t,error:s,refetch:a}=r.SX.subscription.getCurrent.useQuery(void 0,{refetchInterval:6e4,placeholderData:e=>e}),n=e?.tier??"free";return{tier:n,status:e?.status??"active",currentPeriodStart:e?.currentPeriodStart,currentPeriodEnd:e?.currentPeriodEnd,cancelAtPeriodEnd:e?.cancelAtPeriodEnd??!1,isPro:"pro"===n||"unlimited"===n,isStarter:"starter"===n,isFree:"free"===n,isPaid:"free"!==n,isLoading:t,error:s,refetch:a}}},83950:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(82790).Z)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},15689:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(82790).Z)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},36731:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(82790).Z)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},45898:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(82790).Z)("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]])},11942:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(82790).Z)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},26325:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(82790).Z)("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])},9926:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(82790).Z)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},61610:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(82790).Z)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},66843:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(82790).Z)("heart",[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]])},30093:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(82790).Z)("history",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]])},44498:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(82790).Z)("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]])},58339:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(82790).Z)("images",[["path",{d:"m22 11-1.296-1.296a2.4 2.4 0 0 0-3.408 0L11 16",key:"9kzy35"}],["path",{d:"M4 8a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2",key:"1t0f0t"}],["circle",{cx:"13",cy:"7",r:"1",fill:"currentColor",key:"1obus6"}],["rect",{x:"8",y:"2",width:"14",height:"14",rx:"2",key:"1gvhby"}]])},53882:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(82790).Z)("instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]])},5456:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(82790).Z)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},99210:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(82790).Z)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])},1054:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(82790).Z)("music",[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]])},15421:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(82790).Z)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},79278:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(82790).Z)("twitter",[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]])},76131:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(82790).Z)("video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]])},64323:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(82790).Z)("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]])}},function(e){e.O(0,[8979,1370,2370,7067,1776,6318,6250,5635,8339,7861,9877,5894,5071,4055,7720,1960,9682,865,9985,6560,1744],function(){return e(e.s=11930)}),_N_E=e.O()}]);